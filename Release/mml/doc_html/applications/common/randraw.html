<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of randraw</title>
  <meta name="keywords" content="randraw">
  <meta name="description" content="RANDRAW - EFFICIENT RANDOM VARIATES GENERATOR">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">applications</a> &gt; <a href="index.html">common</a> &gt; randraw.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for applications\common&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>randraw
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>RANDRAW - EFFICIENT RANDOM VARIATES GENERATOR</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function varargout = randraw(distribName, distribParams, varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">RANDRAW - EFFICIENT RANDOM VARIATES GENERATOR
 
 See alphabetical list of the supported distributions below (over 50 distributions)
 
 1)  randraw 
           presents general help.
 2)  randraw( distribName ) 
           presents help for the specific distribution defined 
           by usage string distribName (see table below).
 3)  Y = randraw( distribName, distribParams, sampleSize );
           returns array Y of size = sampleSize of random variates from distribName  
           distribution with parameters distribParams

               ALPHABETICAL LIST OF THE SUPPORTED DISTRIBUTIONS:
  ____________________________________________________________________
 |      DISTRIBUTION NAME                    |   USAGE STRING         |
 |___________________________________________|________________________|
 |        Alpha                              |    'alpha'             |
 |        Anglit                             |    'anglit'            |
 |        Antilognormal                      |    'lognorm'           |
 |        Arcsin                             |    'arcsin'            |
 |        Bernoulli                          |    'bern'              |
 |        Bessel                             |    'bessel'            |
 |        Beta                               |    'beta'              |
 |        Binomial                           |    'binom'             |
 |        Bradford                           |    'bradford'          |
 |        Burr                               |    'burr'              |
 |        Cauchy                             |    'cauchy'            |
 |        Chi                                |    'chi'               |
 |        Chi-Square (Non-Central)           |    'chisqnc'           |
 |        Chi-Square (Central)               |    'chisq'             |
 |        Cobb-Douglas                       |    'lognorm'           |
 |        Cosine                             |    'cosine'            |
 |        Double-Exponential                 |    'laplace'           |
 |        Erlang                             |    'erlang'            |
 |        Exponential                        |    'exp'               |
 |        Extreme-Value                      |    'extrval'           |
 |        F (Central)                        |    'f'                 |
 |        F (Non-Central)                    |    'fnc'               |
 |        Fisher-Tippett                     |    'extrval'           |
 |        Fisk                               |    'fisk'              |
 |        Frechet                            |    'frechet'           |
 |        Furry                              |    'furry'             |
 |        Gamma                              |    'gamma'             |
 |        Generalized Inverse Gaussian       |    'gig'               |
 |        Generalized Hyperbolic             |    'gh'                |
 |        Geometric                          |    'geom'              |
 |        Gompertz                           |    'gompertz'          |
 |        Gumbel                             |    'gumbel'            |
 |        Half-Cosine                        |    'hcos'              |
 |        Hyperbolic Secant                  |    'hsec'              |
 |        Hypergeometric                     |    'hypergeom'         |
 |        Inverse Gaussian                   |    'ig'                |
 |        Laplace                            |    'laplace'           |
 |        Logistic                           |    'logistic'          |
 |        Lognormal                          |    'lognorm'           |
 |        Lomax                              |    'lomax'             |
 |        Lorentz                            |    'lorentz'           |
 |        Maxwell                            |    'maxwell'           |
 |        Negative Binomial                  |    'negbinom'          |
 |        Normal                             |    'norm'              |
 |        Normal-Inverse-Gaussian (NIG)      |    'nig'               |
 |        Pareto                             |    'pareto'            |
 |        Pareto2                            |    'pareto2'           |
 |        Pascal                             |    'pascal'            |
 |        Planck                             |    'planck'            |
 |        Poisson                            |    'po'                |
 |        Quadratic                          |    'quadr'             |
 |        Rademacher                         |    'rademacher'        |
 |        Rayleigh                           |    'rayl'              |
 |        Semicircle                         |    'semicirc'          |
 |        Skellam                            |    'skellam'           |
 |        Student's-t                        |    't'                 |
 |        Triangular                         |    'tri'               |
 |        Truncated Normal                   |    'normaltrunc'       |
 |        Tukey-Lambda                       |    'tukeylambda'       |
 |        U-shape                            |    'u'                 |
 |        Uniform (continuous)               |    'uniform'           |
 |        Von Mises                          |    'vonmises'          |
 |        Wald                               |    'wald'              |
 |        Weibull                            |    'weibull'           |
 |        Wigner Semicircle                  |    'wigner'            |
 |        Yule                               |    'yule'              |
 |        Zeta                               |    'zeta'              |
 |        Zipf                               |    'zipf'              |
 |___________________________________________|________________________|</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="randraw.html" class="code" title="function varargout = randraw(distribName, distribParams, varargin)">randraw</a>	RANDRAW - EFFICIENT RANDOM VARIATES GENERATOR</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="randraw.html" class="code" title="function varargout = randraw(distribName, distribParams, varargin)">randraw</a>	RANDRAW - EFFICIENT RANDOM VARIATES GENERATOR</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)</a></li><li><a href="#_sub2" class="code">function validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)</a></li><li><a href="#_sub3" class="code">function cdf = normcdf(y)</a></li><li><a href="#_sub4" class="code">function pdf = normpdf(y)</a></li><li><a href="#_sub5" class="code">function cdfinv = norminv(y)</a></li><li><a href="#_sub6" class="code">function out = randFrom5Tbls( P, offset, sampleSize)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = randraw(distribName, distribParams, varargin)</a>
0002 <span class="comment">%RANDRAW - EFFICIENT RANDOM VARIATES GENERATOR</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% See alphabetical list of the supported distributions below (over 50 distributions)</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% 1)  randraw</span>
0007 <span class="comment">%           presents general help.</span>
0008 <span class="comment">% 2)  randraw( distribName )</span>
0009 <span class="comment">%           presents help for the specific distribution defined</span>
0010 <span class="comment">%           by usage string distribName (see table below).</span>
0011 <span class="comment">% 3)  Y = randraw( distribName, distribParams, sampleSize );</span>
0012 <span class="comment">%           returns array Y of size = sampleSize of random variates from distribName</span>
0013 <span class="comment">%           distribution with parameters distribParams</span>
0014 <span class="comment">%</span>
0015 <span class="comment">%               ALPHABETICAL LIST OF THE SUPPORTED DISTRIBUTIONS:</span>
0016 <span class="comment">%  ____________________________________________________________________</span>
0017 <span class="comment">% |      DISTRIBUTION NAME                    |   USAGE STRING         |</span>
0018 <span class="comment">% |___________________________________________|________________________|</span>
0019 <span class="comment">% |        Alpha                              |    'alpha'             |</span>
0020 <span class="comment">% |        Anglit                             |    'anglit'            |</span>
0021 <span class="comment">% |        Antilognormal                      |    'lognorm'           |</span>
0022 <span class="comment">% |        Arcsin                             |    'arcsin'            |</span>
0023 <span class="comment">% |        Bernoulli                          |    'bern'              |</span>
0024 <span class="comment">% |        Bessel                             |    'bessel'            |</span>
0025 <span class="comment">% |        Beta                               |    'beta'              |</span>
0026 <span class="comment">% |        Binomial                           |    'binom'             |</span>
0027 <span class="comment">% |        Bradford                           |    'bradford'          |</span>
0028 <span class="comment">% |        Burr                               |    'burr'              |</span>
0029 <span class="comment">% |        Cauchy                             |    'cauchy'            |</span>
0030 <span class="comment">% |        Chi                                |    'chi'               |</span>
0031 <span class="comment">% |        Chi-Square (Non-Central)           |    'chisqnc'           |</span>
0032 <span class="comment">% |        Chi-Square (Central)               |    'chisq'             |</span>
0033 <span class="comment">% |        Cobb-Douglas                       |    'lognorm'           |</span>
0034 <span class="comment">% |        Cosine                             |    'cosine'            |</span>
0035 <span class="comment">% |        Double-Exponential                 |    'laplace'           |</span>
0036 <span class="comment">% |        Erlang                             |    'erlang'            |</span>
0037 <span class="comment">% |        Exponential                        |    'exp'               |</span>
0038 <span class="comment">% |        Extreme-Value                      |    'extrval'           |</span>
0039 <span class="comment">% |        F (Central)                        |    'f'                 |</span>
0040 <span class="comment">% |        F (Non-Central)                    |    'fnc'               |</span>
0041 <span class="comment">% |        Fisher-Tippett                     |    'extrval'           |</span>
0042 <span class="comment">% |        Fisk                               |    'fisk'              |</span>
0043 <span class="comment">% |        Frechet                            |    'frechet'           |</span>
0044 <span class="comment">% |        Furry                              |    'furry'             |</span>
0045 <span class="comment">% |        Gamma                              |    'gamma'             |</span>
0046 <span class="comment">% |        Generalized Inverse Gaussian       |    'gig'               |</span>
0047 <span class="comment">% |        Generalized Hyperbolic             |    'gh'                |</span>
0048 <span class="comment">% |        Geometric                          |    'geom'              |</span>
0049 <span class="comment">% |        Gompertz                           |    'gompertz'          |</span>
0050 <span class="comment">% |        Gumbel                             |    'gumbel'            |</span>
0051 <span class="comment">% |        Half-Cosine                        |    'hcos'              |</span>
0052 <span class="comment">% |        Hyperbolic Secant                  |    'hsec'              |</span>
0053 <span class="comment">% |        Hypergeometric                     |    'hypergeom'         |</span>
0054 <span class="comment">% |        Inverse Gaussian                   |    'ig'                |</span>
0055 <span class="comment">% |        Laplace                            |    'laplace'           |</span>
0056 <span class="comment">% |        Logistic                           |    'logistic'          |</span>
0057 <span class="comment">% |        Lognormal                          |    'lognorm'           |</span>
0058 <span class="comment">% |        Lomax                              |    'lomax'             |</span>
0059 <span class="comment">% |        Lorentz                            |    'lorentz'           |</span>
0060 <span class="comment">% |        Maxwell                            |    'maxwell'           |</span>
0061 <span class="comment">% |        Negative Binomial                  |    'negbinom'          |</span>
0062 <span class="comment">% |        Normal                             |    'norm'              |</span>
0063 <span class="comment">% |        Normal-Inverse-Gaussian (NIG)      |    'nig'               |</span>
0064 <span class="comment">% |        Pareto                             |    'pareto'            |</span>
0065 <span class="comment">% |        Pareto2                            |    'pareto2'           |</span>
0066 <span class="comment">% |        Pascal                             |    'pascal'            |</span>
0067 <span class="comment">% |        Planck                             |    'planck'            |</span>
0068 <span class="comment">% |        Poisson                            |    'po'                |</span>
0069 <span class="comment">% |        Quadratic                          |    'quadr'             |</span>
0070 <span class="comment">% |        Rademacher                         |    'rademacher'        |</span>
0071 <span class="comment">% |        Rayleigh                           |    'rayl'              |</span>
0072 <span class="comment">% |        Semicircle                         |    'semicirc'          |</span>
0073 <span class="comment">% |        Skellam                            |    'skellam'           |</span>
0074 <span class="comment">% |        Student's-t                        |    't'                 |</span>
0075 <span class="comment">% |        Triangular                         |    'tri'               |</span>
0076 <span class="comment">% |        Truncated Normal                   |    'normaltrunc'       |</span>
0077 <span class="comment">% |        Tukey-Lambda                       |    'tukeylambda'       |</span>
0078 <span class="comment">% |        U-shape                            |    'u'                 |</span>
0079 <span class="comment">% |        Uniform (continuous)               |    'uniform'           |</span>
0080 <span class="comment">% |        Von Mises                          |    'vonmises'          |</span>
0081 <span class="comment">% |        Wald                               |    'wald'              |</span>
0082 <span class="comment">% |        Weibull                            |    'weibull'           |</span>
0083 <span class="comment">% |        Wigner Semicircle                  |    'wigner'            |</span>
0084 <span class="comment">% |        Yule                               |    'yule'              |</span>
0085 <span class="comment">% |        Zeta                               |    'zeta'              |</span>
0086 <span class="comment">% |        Zipf                               |    'zipf'              |</span>
0087 <span class="comment">% |___________________________________________|________________________|</span>
0088 
0089 <span class="comment">%  Version 1.5 - December 2005</span>
0090 <span class="comment">%        'true' and 'false' functions were replased by ones and zeros to support Matlab releases</span>
0091 <span class="comment">%         below 6.5</span>
0092 <span class="comment">%  Version 1.4 - September 2005 -</span>
0093 <span class="comment">%      Bugs fix:</span>
0094 <span class="comment">%        1) GAMMA distribution (thanks to Earl Lawrence):</span>
0095 <span class="comment">%             special case for a&lt;1</span>
0096 <span class="comment">%        2) GIG distribution (thanks to Panagiotis Braimakis):</span>
0097 <span class="comment">%            typo in help</span>
0098 <span class="comment">%            code adjustment to overcome possible computational overflows</span>
0099 <span class="comment">%        3) CHI SQUARE distribution</span>
0100 <span class="comment">%            typo in help</span>
0101 <span class="comment">%  Version 1.3 - July 2005 -</span>
0102 <span class="comment">%      Bug fix:</span>
0103 <span class="comment">%         Typo in GIG distribution generation:</span>
0104 <span class="comment">%         should be 'out' instead of 'x' in lines 1852 and 1858</span>
0105 <span class="comment">%  Version 1.2 - May 2005  -</span>
0106 <span class="comment">%      Bugs fix:</span>
0107 <span class="comment">%        1) Poisson distribution did not work for lambda &lt; 21.4. Typo ( ti instead of t )</span>
0108 <span class="comment">%        2) GIG distribution:  support to chi=0 or psi=0 cases</span>
0109 <span class="comment">%        3) Beta distribution: column sampleSize</span>
0110 <span class="comment">%        4) Cauchy distribution: typo in example</span>
0111 <span class="comment">%        5) Chi distribution:   typo in example</span>
0112 <span class="comment">%        6) Non-central F distribution:  number of input parameters</span>
0113 <span class="comment">%        7) INVERSE GAUSSIAN (IG) distribution: typo in example</span>
0114 <span class="comment">%</span>
0115 <span class="comment">%  Version 1.1 - April 2005 -  Bug fix:   Generation from binomial distribution using only 'binomial'</span>
0116 <span class="comment">%                                   usage string was changed to 'binom' ( 'binomial' works too ).</span>
0117 <span class="comment">%  Version 1.0 - March 2005 -  Initial version</span>
0118 <span class="comment">%  Alex Bar Guy  &amp;  Alexander Podgaetsky</span>
0119 <span class="comment">%    alex@wavion.co.il</span>
0120 <span class="comment">%</span>
0121 
0122 <span class="comment">% Reference links:</span>
0123 <span class="comment">%   1) http://mathworld.wolfram.com/topics/StatisticalDistributions.html</span>
0124 <span class="comment">%   2) http://en.wikipedia.org/wiki/Category:Probability_distributions</span>
0125 <span class="comment">%   3) http://www.brighton-webs.co.uk/index.asp</span>
0126 <span class="comment">%   4) http://www.jstatsoft.org/v11/i03/v11i03.pdf</span>
0127 <span class="comment">%   5) http://www.quantlet.com/mdstat/scripts/csa/html/node236.html</span>
0128 
0129 <span class="comment">% These programs are distributed in the hope that they will be useful,</span>
0130 <span class="comment">% but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
0131 <span class="comment">% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
0132 
0133 <span class="comment">% Any comments and suggestions please send to:</span>
0134 <span class="comment">%    alex@wavion.co.il</span>
0135 
0136 funcName = mfilename;
0137 
0138 <span class="keyword">if</span> nargin == 0
0139      help(funcName);
0140      <span class="keyword">return</span>;
0141 <span class="keyword">elseif</span> nargin == 1
0142      runMode = <span class="string">'distribHelp'</span>;
0143 <span class="keyword">elseif</span> nargin == 2
0144      runMode = <span class="string">'genRun'</span>;
0145      sampleSize = [1 1];
0146 <span class="keyword">else</span>
0147      runMode = <span class="string">'genRun'</span>;
0148      sampleSize = [varargin{1:end}];
0149 <span class="keyword">end</span>
0150 
0151 distribNameInner = lower( distribName( ~isspace( distribName ) ) );
0152 
0153 <span class="keyword">if</span> strcmp(runMode, <span class="string">'distribHelp'</span>)
0154      fid = fopen( [ funcName <span class="string">'.m'</span> ], <span class="string">'r'</span> );
0155      printHelpFlag = 0;
0156      <span class="keyword">while</span> 1
0157           tline = fgetl( fid );
0158           <span class="keyword">if</span> ~ischar( tline )
0159                fprintf( <span class="string">'\n Unknown distribution name ''%s''.\n'</span>, distribName );
0160                <span class="keyword">break</span>;
0161           <span class="keyword">end</span>
0162           <span class="keyword">if</span> ~isempty( strfind( tline, [ <span class="string">'END '</span>, distribNameInner,<span class="string">' HELP'</span> ] ) )
0163                printHelpFlag = 0;
0164                <span class="keyword">break</span>;
0165           <span class="keyword">end</span>
0166           <span class="keyword">if</span> printHelpFlag
0167                startPosition = strfind( tline, <span class="string">' % '</span> ) + 3;
0168                printLine = tline( startPosition : end );
0169                <span class="keyword">if</span> ~strcmp( funcName, <span class="string">'randraw'</span> )
0170                     indxs = strfind( printLine, <span class="string">'randraw'</span> );
0171                     <span class="keyword">while</span> ~isempty( indxs )
0172                          headLine = printLine( 1:indxs(1)-1 );
0173                          tailLine = printLine( indxs(1)+7:end );
0174                          printLine = [ headLine, funcName, tailLine ];
0175                          indxs = strfind( printLine, <span class="string">'randraw'</span> );
0176                     <span class="keyword">end</span>
0177                <span class="keyword">end</span>
0178                pause(0.02);
0179                fprintf( <span class="string">'\n%s'</span>, printLine );
0180           <span class="keyword">end</span>
0181           <span class="keyword">if</span> ~isempty( strfind( tline, [ <span class="string">'START '</span>, distribNameInner,<span class="string">' HELP'</span> ] ) )
0182                printHelpFlag = 1;
0183           <span class="keyword">end</span>
0184      <span class="keyword">end</span>
0185      fprintf( <span class="string">'\n\n'</span> );
0186      fclose( fid );
0187      <span class="keyword">return</span>;
0188 <span class="keyword">end</span>
0189 
0190 <span class="keyword">if</span> length(sampleSize) == 1
0191      sampleSize = [ sampleSize, 1 ];
0192 <span class="keyword">end</span>
0193 
0194 <span class="keyword">if</span> strcmp(runMode, <span class="string">'genRun'</span>)
0195      runExample = 0;
0196      plotFlag = 0;
0197 
0198      dbclear <span class="keyword">if</span> warning;
0199      out = [];
0200      <span class="keyword">if</span> prod(sampleSize) &gt; 0
0201           <span class="keyword">switch</span> lower( distribNameInner )
0202                <span class="keyword">case</span> {<span class="string">'alpha'</span>}
0203                     <span class="comment">% START alpha HELP</span>
0204                     <span class="comment">% THE ALPHA DISTRIBUTION</span>
0205                     <span class="comment">%</span>
0206                     <span class="comment">% pdf(y) = b*normpdf(a-b./y) ./ (y.^2*normcdf(a)); y&gt;0; a&gt;0; b&gt;0;</span>
0207                     <span class="comment">% cdf(y) = normcdf(a-b./y)/normcdf(a); y&gt;0; a&gt;0; b&gt;0;</span>
0208                     <span class="comment">%   where normpdf(x) = 1/sqrt(2*pi) * exp(-1/2*x.^2); is the standard normal PDF</span>
0209                     <span class="comment">%         normcdf(x) = 0.5*(1+erf(y/sqrt(2))); is the standard normal CDF</span>
0210                     <span class="comment">%</span>
0211                     <span class="comment">% PARAMETERS:</span>
0212                     <span class="comment">%   a - shape parameter (a&gt;0)</span>
0213                     <span class="comment">%   b - shape parameter (b&gt;0)</span>
0214                     <span class="comment">%</span>
0215                     <span class="comment">% SUPPORT:</span>
0216                     <span class="comment">%   y,  y&gt;0</span>
0217                     <span class="comment">%</span>
0218                     <span class="comment">% CLASS:</span>
0219                     <span class="comment">%   Continuous skewed distributions</span>
0220                     <span class="comment">%</span>
0221                     <span class="comment">% USAGE:</span>
0222                     <span class="comment">%   randraw('alpha', [], sampleSize) - generate sampleSize number</span>
0223                     <span class="comment">%         of variates from Alpha distribution with shape parameters a and b;</span>
0224                     <span class="comment">%   randraw('alpha') - help for Alpha distribution;</span>
0225                     <span class="comment">%</span>
0226                     <span class="comment">% EXAMPLES:</span>
0227                     <span class="comment">%  1.   y = randraw('alpha', [1 2], [1 1e5]);</span>
0228                     <span class="comment">%  2.   y = randraw('alpha', [2 3], 1, 1e5);</span>
0229                     <span class="comment">%  3.   y = randraw('alpha', [10 50], 1e5 );</span>
0230                     <span class="comment">%  4.   y = randraw('alpha', [20.5 30.5], [1e5 1] );</span>
0231                     <span class="comment">%  5.   randraw('alpha');</span>
0232                     <span class="comment">% END alpha HELP</span>
0233 
0234                     <span class="comment">% References:</span>
0235                     <span class="comment">% 1. doc erf</span>
0236 
0237                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Alpha'</span>, <span class="string">'alpha'</span>, distribParams, [2]);
0238                     a  = distribParams(1);
0239                     b  = distribParams(2);
0240                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Alpha'</span>, <span class="string">'alpha'</span>, <span class="string">'[a, b]'</span>, <span class="string">'a'</span>, a, {<span class="string">'&gt; 0'</span>});
0241                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Alpha'</span>, <span class="string">'alpha'</span>, <span class="string">'[a, b]'</span>, <span class="string">'b'</span>, b, {<span class="string">'&gt; 0'</span>});
0242 
0243                     out = b ./ ( a - <a href="#_sub5" class="code" title="subfunction cdfinv = norminv(y)">norminv</a>(<a href="#_sub3" class="code" title="subfunction cdf = normcdf(y)">normcdf</a>(a)*rand(sampleSize)) );
0244 
0245                <span class="keyword">case</span> {<span class="string">'anglit'</span>}
0246                     <span class="comment">% START anglit HELP</span>
0247                     <span class="comment">% THE ANGLIT DISTRIBUTION</span>
0248                     <span class="comment">%</span>
0249                     <span class="comment">% Standard form of anglit distribution:</span>
0250                     <span class="comment">%   pdf(y) = sin(2*y+pi/2);  -pi/4 &lt;= y &lt;= pi/4;</span>
0251                     <span class="comment">%   cdf(y) = sin(y+pi/4).^2; -pi/4 &lt;= y &lt;= pi/4;</span>
0252                     <span class="comment">%</span>
0253                     <span class="comment">%   Mean = Median = Mode = 0;</span>
0254                     <span class="comment">%   Variance = (pi/4)^2 - 0.5;</span>
0255                     <span class="comment">%</span>
0256                     <span class="comment">% General form of anglit distribution:</span>
0257                     <span class="comment">%   pdf(y) = sin(pi/2*(y-t)/s+pi/2);  t-s &lt;= y &lt;= t+s; s&gt;0</span>
0258                     <span class="comment">%   cdf(y) = sin(pi/4*(y-t)/s+pi/4).^2;  t-s &lt;= y &lt;= t+s; s&gt;0</span>
0259                     <span class="comment">%</span>
0260                     <span class="comment">%   Mean = Median = Mode = t;</span>
0261                     <span class="comment">%   Variance = ???????;</span>
0262                     <span class="comment">%</span>
0263                     <span class="comment">% PARAMETERS:</span>
0264                     <span class="comment">%   t - location</span>
0265                     <span class="comment">%   s -scale; s&gt;0</span>
0266                     <span class="comment">%</span>
0267                     <span class="comment">% SUPPORT:</span>
0268                     <span class="comment">%   y,   -pi/4 &lt;= y &lt;= pi.4   - standard Anglit distribution</span>
0269                     <span class="comment">%    or</span>
0270                     <span class="comment">%   y,   t-s &lt;= y &lt;= t+s  - generalized Anglit distribution</span>
0271                     <span class="comment">%</span>
0272                     <span class="comment">% CLASS:</span>
0273                     <span class="comment">%   Continuous distributions</span>
0274                     <span class="comment">%</span>
0275                     <span class="comment">% USAGE:</span>
0276                     <span class="comment">%   randraw('anglit', [], sampleSize) - generate sampleSize number</span>
0277                     <span class="comment">%         of variates from standard Anglit distribution;</span>
0278                     <span class="comment">%   randraw('anglit', [t, s], sampleSize) - generate sampleSize number</span>
0279                     <span class="comment">%         of variates from generalized Anglit distribution</span>
0280                     <span class="comment">%         with location parameter 't' and scale parameter 's';</span>
0281                     <span class="comment">%   randraw('anglit') - help for Anglit distribution;</span>
0282                     <span class="comment">%</span>
0283                     <span class="comment">% EXAMPLES:</span>
0284                     <span class="comment">%  1.   y = randraw('anglit', [], [1 1e5]);</span>
0285                     <span class="comment">%  2.   y = randraw('anglit', [], 1, 1e5);</span>
0286                     <span class="comment">%  3.   y = randraw('anglit', [], 1e5 );</span>
0287                     <span class="comment">%  4.   y = randraw('anglit', [10 3], [1e5 1] );</span>
0288                     <span class="comment">%  5.   randraw('anglit');</span>
0289                     <span class="comment">%</span>
0290                     <span class="comment">% END anglit HELP</span>
0291 
0292                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Anglit'</span>, <span class="string">'anglit'</span>, distribParams, [0, 2]);
0293                     <span class="keyword">if</span> numel(distribParams)==2
0294                          t  = distribParams(1);
0295                          s  = distribParams(2);
0296                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Anglit'</span>, <span class="string">'anglit'</span>, <span class="string">'[t, s]'</span>, <span class="string">'s'</span>, s, {<span class="string">'&gt; 0'</span>});
0297                     <span class="keyword">else</span>
0298                          t = 0;
0299                          s = pi/4;
0300                     <span class="keyword">end</span>
0301 
0302                     out = t + s * (4/pi*asin(sqrt(rand(sampleSize)))-1);
0303 
0304                <span class="keyword">case</span> {<span class="string">'arcsin'</span>}
0305                     <span class="comment">% START arcsin HELP</span>
0306                     <span class="comment">% THE ARC-SINE DISTRIBUTION</span>
0307                     <span class="comment">%</span>
0308                     <span class="comment">% pdf(y) = 1 ./ (pi*sqrt(y.*(1-y))); 0&lt;y&lt;1;</span>
0309                     <span class="comment">% cdf(y) = 2*asin(sqrt(y))/pi; 0&lt;y&lt;1;</span>
0310                     <span class="comment">%</span>
0311                     <span class="comment">% Mean = 0.5;</span>
0312                     <span class="comment">% Variance = 0.125;</span>
0313                     <span class="comment">%</span>
0314                     <span class="comment">% PARAMETERS:</span>
0315                     <span class="comment">%  None</span>
0316                     <span class="comment">%</span>
0317                     <span class="comment">% SUPPORT:</span>
0318                     <span class="comment">%  y,    0&lt;y&lt;1</span>
0319                     <span class="comment">%</span>
0320                     <span class="comment">% CLASS:</span>
0321                     <span class="comment">%   Continuous symmetric distributions</span>
0322                     <span class="comment">% NOTES:</span>
0323                     <span class="comment">%  The arc-sine distribution is a special case of the beta distribution</span>
0324                     <span class="comment">%  with both parameters equal to 1/2. The generalized arc-sine distribution</span>
0325                     <span class="comment">%  is the special case of the beta distribution where the two parameters sum</span>
0326                     <span class="comment">%  to 1 but are not necessarily equal to 1/2.</span>
0327                     <span class="comment">%</span>
0328                     <span class="comment">% USAGE:</span>
0329                     <span class="comment">%   randraw('arcsin', [], sampleSize) - generate sampleSize number</span>
0330                     <span class="comment">%         of variates from the Arc-sine distribution;</span>
0331                     <span class="comment">%   randraw('arcsin') - help for the Arc-sine distribution;</span>
0332                     <span class="comment">%</span>
0333                     <span class="comment">% EXAMPLES:</span>
0334                     <span class="comment">%  1.   y = randraw('arcsin', [], [1 1e5]);</span>
0335                     <span class="comment">%  2.   y = randraw('arcsin', [], 1, 1e5);</span>
0336                     <span class="comment">%  3.   y = randraw('arcsin', [], 1e5 );</span>
0337                     <span class="comment">%  4.   randraw('arcsin');</span>
0338                     <span class="comment">%  SEE ALSO:</span>
0339                     <span class="comment">%    U distribution</span>
0340                     <span class="comment">% END arcsin HELP</span>
0341 
0342                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Arcsin'</span>, <span class="string">'arcsin'</span>, distribParams, 0);
0343                     out = sin( rand(sampleSize)*pi/2 ).^2;
0344 
0345                <span class="keyword">case</span> {<span class="string">'bernoulli'</span>, <span class="string">'bern'</span>}
0346                     <span class="comment">% START bernoulli HELP START bern HELP</span>
0347                     <span class="comment">% THE BERNOULLI DISTRIBUTION</span>
0348                     <span class="comment">%</span>
0349                     <span class="comment">% pdf(y) = p.^y .* (1-p).^(1-y);</span>
0350                     <span class="comment">% cdf(y) = (y==0)*(1-p) + (y==1)*1;</span>
0351                     <span class="comment">%</span>
0352                     <span class="comment">% PARAMETERS:</span>
0353                     <span class="comment">%    p is a probability of success; (0&lt;p&lt;1)</span>
0354                     <span class="comment">%</span>
0355                     <span class="comment">% SUPPORT:</span>
0356                     <span class="comment">%     y = [0 1];</span>
0357                     <span class="comment">%</span>
0358                     <span class="comment">% CLASS:</span>
0359                     <span class="comment">%   Discrete distributions</span>
0360                     <span class="comment">%</span>
0361                     <span class="comment">% USAGE:</span>
0362                     <span class="comment">%   randraw('bern', p, sampleSize) - generate sampleSize number</span>
0363                     <span class="comment">%         of variates from the Bernoulli distribution with probability of success p</span>
0364                     <span class="comment">%   randraw('bern') - help for the Bernoulli distribution;</span>
0365                     <span class="comment">%</span>
0366                     <span class="comment">% EXAMPLES:</span>
0367                     <span class="comment">%  1.   y = randraw('bern', 0.5, [1 1e5]);</span>
0368                     <span class="comment">%  2.   y = randraw('bern', 0.1, 1, 1e5);</span>
0369                     <span class="comment">%  3.   y = randraw('bern', 0.9, 1e5 );</span>
0370                     <span class="comment">%  4.   randraw('bern');</span>
0371                     <span class="comment">% END bernoulli HELP END bern HELP</span>
0372 
0373                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Bernoulli'</span>, <span class="string">'bernoulli'</span>, distribParams, 1);
0374                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Bernoulli'</span>, <span class="string">'bernoulli'</span>, <span class="string">'p'</span>, <span class="string">'p'</span>, distribParams(1), {<span class="string">'&gt;=0'</span>,<span class="string">'&lt;=1'</span>});
0375 
0376                     out = double( rand(  sampleSize  ) &lt; distribParams );
0377 
0378                <span class="keyword">case</span> {<span class="string">'beta'</span>, <span class="string">'powerfunction'</span>, <span class="string">'powerfunc'</span>}
0379                     <span class="comment">% START beta HELP</span>
0380                     <span class="comment">%  THE BETA DISTRIBUTION</span>
0381                     <span class="comment">%</span>
0382                     <span class="comment">%  ( sometimes: Power Function distribution )</span>
0383                     <span class="comment">%</span>
0384                     <span class="comment">% Standard form of the Beta distribution:</span>
0385                     <span class="comment">%  pdf(y) = y.^(a-1).*(1-y).^(b-1) / beta(a, b);</span>
0386                     <span class="comment">%  cdf(y) = betainc(y,a,b), if (y&gt;=0 &amp; y&lt;=1); 0, if x&lt;0; 1, if x&gt;1</span>
0387                     <span class="comment">%</span>
0388                     <span class="comment">%  Mean = a/(a+b);</span>
0389                     <span class="comment">%  Variance = (a*b)/((a+b)^2*(a+b+1));</span>
0390                     <span class="comment">%</span>
0391                     <span class="comment">% General form of the Beta distribution:</span>
0392                     <span class="comment">%  pdf(y) = (y-m).^(a-1).*(n-y).^(b-1) / (beta(a, b)*(n-m)^(a+b-1));</span>
0393                     <span class="comment">%  cdf(y) = betainc((y-m)/(n-m),a,b), if (y&gt;=m &amp; y&lt;=n); 0, if x&lt;m; 1, if x&gt;n</span>
0394                     <span class="comment">%</span>
0395                     <span class="comment">%  Mean = (n*a + m*b)/(a+b);</span>
0396                     <span class="comment">%  Variance = (a*b)*(n-m)^2/((a+b)^2*(a+b+1));</span>
0397                     <span class="comment">%</span>
0398                     <span class="comment">% PARAMETERS:</span>
0399                     <span class="comment">%   a&gt;0 - shape parameter</span>
0400                     <span class="comment">%   b&gt;0 - shape parameter</span>
0401                     <span class="comment">%   m - location</span>
0402                     <span class="comment">%   n -scale (upper bound); n&gt;=m</span>
0403                     <span class="comment">%</span>
0404                     <span class="comment">% SUPPORT:</span>
0405                     <span class="comment">%   y,   0&lt;=y&lt;=1 - standard beta distribution</span>
0406                     <span class="comment">%    or</span>
0407                     <span class="comment">%   y,   m&lt;=y&lt;=n - generalized beta distribution</span>
0408                     <span class="comment">%</span>
0409                     <span class="comment">% CLASS:</span>
0410                     <span class="comment">%   Continuous skewed distributions</span>
0411                     <span class="comment">%</span>
0412                     <span class="comment">% USAGE:</span>
0413                     <span class="comment">%   randraw('beta', [a, b], sampleSize) - generate sampleSize number</span>
0414                     <span class="comment">%         of variates from standard beta distribution with shape parameters</span>
0415                     <span class="comment">%         'a' and 'b'</span>
0416                     <span class="comment">%   randraw('beta', [m, n, a, b], sampleSize) - generate sampleSize number</span>
0417                     <span class="comment">%         of variates from generalized beta distribution on the interval [m, n]</span>
0418                     <span class="comment">%         with shape parameters 'a' and 'b';</span>
0419                     <span class="comment">%   randraw('beta') - help for the Beta distribution;</span>
0420                     <span class="comment">% EXAMPLES:</span>
0421                     <span class="comment">%  1.   y = randraw('beta', [0.2 0.9], [1 1e5]);</span>
0422                     <span class="comment">%  2.   y = randraw('beta', [0.6 3.2], 1, 1e5);</span>
0423                     <span class="comment">%  3.   y = randraw('beta', [-10 20 3.1 6.2], 1e5 );</span>
0424                     <span class="comment">%  4.   y = randraw('beta', [3 4 5.3 0.7], [1e5 1] );</span>
0425                     <span class="comment">%  5.   randraw('beta');</span>
0426                     <span class="comment">% END beta HELP</span>
0427 
0428                     <span class="comment">% Refernce:</span>
0429                     <span class="comment">%      Dagpunar, John.</span>
0430                     <span class="comment">%      Principles of Random Variate Generation.</span>
0431                     <span class="comment">%      Oxford University Press, 1988.</span>
0432                     <span class="comment">%</span>
0433                     <span class="comment">%  max_ab &lt; 0.5            Joehnk's algorithm</span>
0434                     <span class="comment">%  1 &lt; min_ab              Cheng's algortihm BB</span>
0435                     <span class="comment">%  min_ab &lt;= 1 &lt;= max_ab   Atkinson's switching algorithm</span>
0436                     <span class="comment">%  0.5&lt;= max_ab &lt; 1        Atkinson's switching algorithm</span>
0437 
0438 
0439                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Beta'</span>, <span class="string">'beta'</span>, distribParams, [2, 4]);
0440 
0441                     <span class="keyword">if</span> numel(distribParams) == 2
0442                          a = distribParams(1);
0443                          b = distribParams(2);
0444                          m = 0;
0445                          n = 1;
0446                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Beta'</span>, <span class="string">'beta'</span>, <span class="string">'[a, b]'</span>, <span class="string">'a'</span>, a, {<span class="string">'&gt; 0'</span>});
0447                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Beta'</span>, <span class="string">'beta'</span>, <span class="string">'[a, b]'</span>, <span class="string">'b'</span>, b, {<span class="string">'&gt; 0'</span>});
0448                     <span class="keyword">else</span>
0449                          m = distribParams(1);
0450                          n = distribParams(2);
0451                          a = distribParams(3);
0452                          b = distribParams(4);
0453                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Beta'</span>, <span class="string">'beta'</span>, <span class="string">'[m, n, a, b]'</span>, <span class="string">'n-m'</span>, n-m, {<span class="string">'&gt;= 0'</span>});
0454                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Beta'</span>, <span class="string">'beta'</span>, <span class="string">'[m, n, a, b]'</span>, <span class="string">'a'</span>, a, {<span class="string">'&gt; 0'</span>});
0455                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Beta'</span>, <span class="string">'beta'</span>, <span class="string">'[m, n, a, b]'</span>, <span class="string">'b'</span>, b, {<span class="string">'&gt; 0'</span>});
0456 
0457                     <span class="keyword">end</span>
0458 
0459                     sampleSizeIn = sampleSize;
0460                     sampleSize = [ 1, prod( sampleSizeIn ) ];
0461                     
0462                     max_ab = max( a, b );
0463                     min_ab = min( a, b );
0464                     <span class="keyword">if</span> max_ab &lt; 0.5
0465                          <span class="comment">%  Use log(u1^a) and log(u2^b), rather than a and b, to avoid</span>
0466                          <span class="comment">%  underflow for very small a or b.</span>
0467 
0468                          loga = log(rand( sampleSize ))/a;
0469                          logb = log(rand( sampleSize ))/b;
0470                          logsum = (loga&gt;logb).*(loga + log(1+ exp(logb-loga))) + <span class="keyword">...</span>
0471                               (loga&lt;=logb).*(logb + log(1+ exp(loga-logb)));
0472                          out = exp(loga - logsum);
0473 
0474                          indxs = find( logsum &gt; 0);
0475 
0476                          <span class="keyword">while</span> ~isempty( indxs )
0477                               indxsSize = size( indxs );
0478                               loga = log(rand( indxsSize ))/a;
0479                               logb = log(rand( indxsSize ))/b;
0480                               logsum = (loga&gt;logb).*(loga + log(1+ exp(logb-loga))) + <span class="keyword">...</span>
0481                                    (loga&lt;=logb).*(logb + log(1+ exp(loga-logb)));
0482 
0483                               l = (logsum &lt;= 0);
0484                               out( indxs( l ) ) = exp(loga(l) - logsum(l));
0485                               indxs = indxs( ~l );
0486                          <span class="keyword">end</span>
0487 
0488                     <span class="keyword">elseif</span> min_ab &gt; 1
0489                          <span class="comment">% Algorithm BB</span>
0490 
0491                          sum_ab = a + b;
0492                          lambda = sqrt((sum_ab-2)/(2*a*b-sum_ab));
0493                          c = min_ab+1/lambda;
0494 
0495                          u1 = rand( sampleSize );
0496                          u2 = rand( sampleSize );
0497                          v = lambda*log(u1./(1-u1));
0498                          z = u1.*u1.*u2;
0499                          clear(<span class="string">'u1'</span>); clear(<span class="string">'u2'</span>);
0500                          w = min_ab*exp(v);
0501                          r = c*v-1.38629436112;
0502                          clear(<span class="string">'v'</span>);
0503                          s = min_ab+r-w;
0504                          <span class="keyword">if</span> a == min_ab
0505                               out = w./(max_ab+w);
0506                          <span class="keyword">else</span>
0507                               out = max_ab./(max_ab+w);
0508                          <span class="keyword">end</span>
0509 
0510                          t = log(z);
0511                          indxs = find( (s+2.609438 &lt; 5*z) &amp; (r+sum_ab*log(sum_ab./(max_ab+w)) &lt; t) );
0512 
0513                          clear(<span class="string">'v'</span>);
0514                          clear(<span class="string">'z'</span>);
0515                          clear(<span class="string">'w'</span>);
0516                          clear(<span class="string">'r'</span>);
0517                          <span class="keyword">while</span> ~isempty( indxs )
0518                               indxsSize = size( indxs );
0519 
0520                               u1 = rand( indxsSize );
0521                               u2 = rand( indxsSize );
0522                               v = lambda*log(u1./(1-u1));
0523                               z = u1.*u1.*u2;
0524                               clear(<span class="string">'u1'</span>); clear(<span class="string">'u2'</span>);
0525                               w = min_ab*exp(v);
0526                               r = c*v-1.38629436112;
0527                               clear(<span class="string">'v'</span>);
0528                               s = min_ab+r-w;
0529                               t = log(z);
0530 
0531                               l = (s+2.609438 &gt;= 5*z) | (r+sum_ab*log(sum_ab./(max_ab+w)) &gt;= t);
0532                               <span class="keyword">if</span> a == min_ab
0533                                    out( indxs( l ) ) = w(l)./(max_ab+w(l));
0534                               <span class="keyword">else</span>
0535                                    out( indxs( l ) ) = max_ab./(max_ab+w(l));
0536                               <span class="keyword">end</span>
0537                               indxs = indxs( ~l );
0538 
0539                          <span class="keyword">end</span>
0540 
0541                     <span class="keyword">elseif</span> min_ab &lt; 1 &amp; max_ab &gt; 1
0542                          <span class="comment">%  Atkinson's switching method</span>
0543 
0544                          t = (1-min_ab)/(1+max_ab - min_ab);
0545                          r = max_ab*t/(max_ab*t + min_ab*(1-t)^max_ab);
0546 
0547                          u1 = rand( sampleSize );
0548                          w = zeros( sampleSize );
0549                          l = u1 &lt; r;
0550                          w( l ) =  t*(u1( l )/r).^(1/min_ab);
0551                          l = ~l;
0552                          w( l ) =  1- (1-t)*((1-u1(l))/(1-r)).^(1/max_ab);
0553                          <span class="keyword">if</span> a == min_ab
0554                               out = w;
0555                          <span class="keyword">else</span>
0556                               out = 1 - w;
0557                          <span class="keyword">end</span>
0558                          u2 = rand( sampleSize );
0559 
0560                          indxs1 = find(u1 &lt; r);
0561                          indxs2 = find(u1 &gt;= r);
0562                          clear(<span class="string">'u1'</span>);
0563                          indxs = [ indxs1( log(u2(indxs1)) &gt;= (max_ab-1)*log(1-w(indxs1)) ), <span class="keyword">...</span>
0564                               indxs2( log(u2(indxs2)) &gt;= (min_ab-1)*log(w(indxs2)/t) ) ];
0565 
0566                          clear(<span class="string">'u1'</span>);
0567                          clear(<span class="string">'u2'</span>);
0568                          <span class="keyword">while</span> ~isempty( indxs )
0569                               indxsSize = size( indxs );
0570                               u1 = rand( indxsSize );
0571                               w  = zeros( indxsSize );
0572                               l = u1 &lt; r;
0573                               w( l ) =  t*(u1( l )/r).^(1/min_ab);
0574                               l = ~l;
0575                               w( l ) =  1- (1-t)*((1-u1(l))/(1-r)).^(1/max_ab);
0576 
0577                               u2 = rand( indxsSize );
0578 
0579                               indxs1 = find(u1 &lt; r);
0580                               indxs2 = find(u1 &gt;= r);
0581                               clear(<span class="string">'u1'</span>);
0582                               l = logical( zeros( indxsSize ) );
0583                               l( [ indxs1( log(u2(indxs1)) &lt; (max_ab-1)*log(1-w(indxs1)) ), <span class="keyword">...</span>
0584                                    indxs2( log(u2(indxs2)) &lt; (min_ab-1)*log(w(indxs2)/t) ) ] ) = 1;
0585 
0586                               clear(<span class="string">'u1'</span>);
0587                               clear(<span class="string">'u2'</span>);
0588                               <span class="keyword">if</span> a == min_ab
0589                                    out( indxs(l) ) = w(l);
0590                               <span class="keyword">else</span>
0591                                    out( indxs(l) ) = 1 - w(l);
0592                               <span class="keyword">end</span>
0593                               indxs = indxs( ~l );
0594                          <span class="keyword">end</span>
0595 
0596                     <span class="keyword">else</span>
0597                          <span class="comment">% Atkinson's Algorithm</span>
0598 
0599                          <span class="keyword">if</span> min_ab == 1
0600                               t = 0.5;
0601                               r = 0.5;
0602                          <span class="keyword">else</span>
0603                               t = 1/(1+sqrt(max_ab*(1-max_ab)/(min_ab*(1-min_ab))));
0604                               r = max_ab*t / (max_ab*t + min_ab*(1-t));
0605                          <span class="keyword">end</span>
0606 
0607                          u1 = rand( sampleSize );
0608                          out = zeros( sampleSize );
0609                          w  = zeros( sampleSize );
0610                          l1 = u1 &lt; r;
0611                          w(l1) = t*(u1(l1)/r).^(1/min_ab);
0612                          l2 = u1 &gt;= r;
0613                          w(l2) = 1 - (1-t)*((1-u1(l2))/(1-r)).^(1/max_ab);
0614                          <span class="keyword">if</span> a == min_ab
0615                               out = w;
0616                          <span class="keyword">else</span>
0617                               out = 1 - w;
0618                          <span class="keyword">end</span>
0619 
0620                          u2 = rand( sampleSize );
0621                          indxs1 = find(l1);
0622                          indxs2 = find(l2);
0623                          indxs = [ indxs1( log(u2(l1)) &gt;= (max_ab -1)*log((1-w(l1))/(1-t)) ), <span class="keyword">...</span>
0624                               indxs2( log(u2(l2)) &gt;= (min_ab -1) * log(w(l2)/t) ) ];
0625                          clear(<span class="string">'u2'</span>);
0626 
0627                          <span class="keyword">while</span> ~isempty( indxs )
0628                               indxsSize = size( indxs );
0629                               u1 = rand( indxsSize );
0630                               w  = zeros( indxsSize );
0631 
0632                               l1 = u1 &lt; r;
0633                               w(l1) = t*(u1(l1)/r).^(1/min_ab);
0634                               l2 = u1 &gt;= r;
0635                               w(l2) = 1 - (1-t)*((1-u1(l2))/(1-r)).^(1/max_ab);
0636 
0637                               u2 = rand( indxsSize );
0638 
0639                               indxs1 = find(l1);
0640                               indxs2 = find(l2);
0641                               clear(<span class="string">'u1'</span>);
0642                               l = logical( zeros( indxsSize ) );
0643 
0644                               l( [ indxs1(log(u2(l1)) &lt; (max_ab -1)*log((1-w(l1))/(1-t))), <span class="keyword">...</span>
0645                                    indxs2(log(u2(l2))&lt; (min_ab -1) * log(w(l2)/t)) ] ) = 1;
0646 
0647                               <span class="keyword">if</span> a == min_ab
0648                                    out(indxs(l)) = w(l);
0649                               <span class="keyword">else</span>
0650                                    out(indxs(l)) = 1 - w(l);
0651                               <span class="keyword">end</span>
0652                               indxs = indxs( ~l );
0653                          <span class="keyword">end</span>
0654 
0655                     <span class="keyword">end</span>
0656 
0657                     out = m + (n-m) * out;
0658                     
0659                     reshape( out, sampleSizeIn );
0660                     
0661                <span class="keyword">case</span> {<span class="string">'bessel'</span>}
0662                     <span class="comment">% START bessel HELP</span>
0663                     <span class="comment">%  THE BESSEL DISTRIBUTION</span>
0664                     <span class="comment">%</span>
0665                     <span class="comment">%  Bessel distribution arises in the theory of stochastic processes.</span>
0666                     <span class="comment">%  Bessel(nu,a) is a discrete distribution on the non-negative integers with</span>
0667                     <span class="comment">%  parameters nu &gt; -1 and a &gt; 0.</span>
0668                     <span class="comment">%</span>
0669                     <span class="comment">% pdf(y) = (a/2).^(2*y+nu) ./ (besseli(nu,a).*factorial(y).*gamma(y+nu+1));</span>
0670                     <span class="comment">%</span>
0671                     <span class="comment">% PARAMETERS:</span>
0672                     <span class="comment">%   nu &gt; -1, a &gt; 0</span>
0673                     <span class="comment">% SUPPORT:</span>
0674                     <span class="comment">%   y = 0, 1, 2, 3, ...</span>
0675                     <span class="comment">% CLASS:</span>
0676                     <span class="comment">%   Discrete distributions</span>
0677                     <span class="comment">%</span>
0678                     <span class="comment">% USAGE:</span>
0679                     <span class="comment">%   randraw('bessel', [nu, a], sampleSize) - generate sampleSize number</span>
0680                     <span class="comment">%         of variates from the Bessel distribution with parameters</span>
0681                     <span class="comment">%         'nu' and 'a'</span>
0682                     <span class="comment">%   randraw('bessel') - help for the Bessel distribution;</span>
0683                     <span class="comment">% EXAMPLES:</span>
0684                     <span class="comment">%  1.   y = randraw('bessel', [2 0.9], [1 1e5]);</span>
0685                     <span class="comment">%  2.   y = randraw('bessel', [0.6 3.2], 1, 1e5);</span>
0686                     <span class="comment">%  3.   y = randraw('bessel', [-0.2 8.1], 1e5 );</span>
0687                     <span class="comment">%  4.   y = randraw('bessel', [4 5.3], [1e5 1] );</span>
0688                     <span class="comment">%  5.   randraw('bessel');</span>
0689                     <span class="comment">% END bessel HELP</span>
0690                     
0691                     <span class="comment">% Method:</span>
0692                     <span class="comment">%</span>
0693                     <span class="comment">% We implemented Condensed Table-Lookup method suggested in</span>
0694                     <span class="comment">%    George Marsaglia, &quot;Fast Generation Of Discrete Random Variables,&quot;</span>
0695                     <span class="comment">%    Journal of Statistical Software, July 2004, Volume 11, Issue 4</span>
0696                     <span class="comment">%</span>
0697                     <span class="comment">% Reference:</span>
0698                     <span class="comment">% L. Devroye, &quot;Simulating Bessel random variables,&quot;</span>
0699                     <span class="comment">%  Statistics and Probability Letters, vol. 57, pp. 249-257, 2002.</span>
0700                     <span class="comment">%</span>
0701 
0702                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Bessel'</span>, <span class="string">'bessel'</span>, distribParams, [2]);
0703                     
0704                     nu = distribParams(1);
0705                     a = distribParams(2);
0706                     
0707                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Bessel'</span>, <span class="string">'bessel'</span>, <span class="string">'[nu, a]'</span>, <span class="string">'nu'</span>, nu, {<span class="string">'&gt; -1'</span>});
0708                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Bessel'</span>, <span class="string">'bessel'</span>, <span class="string">'[nu, a]'</span>, <span class="string">'a'</span>, a, {<span class="string">'&gt; 0'</span>});
0709                     
0710                     <span class="comment">% mu = 0.5*a*besseli(nu+1,a)/besseli(nu,a);</span>
0711                     <span class="comment">% chi2 = mu + 0.25*a^2*besseli(nu+1,a)/besseli(nu,a)*...</span>
0712                     <span class="comment">%     (besseli(nu+2,a)/besseli(nu+1,a)-besseli(nu+1,a)/besseli(nu,a));</span>
0713 
0714                     besseliNuA =  besseli(nu, a);
0715 
0716                     proceed = 1;
0717                     <span class="keyword">if</span> ~isfinite( besseliNuA )
0718                          warnStr{1} = [upper(funcName), <span class="string">' - Bessel Variates Generation: '</span>];
0719                          warnStr{2} = [<span class="string">'besseli('</span>, num2str(nu), <span class="string">', '</span> num2str(a), <span class="string">') returns Inf.'</span>];
0720                          warnStr{3} = [<span class="string">'Unable to proceed, return zeros ...'</span>];
0721                          warning(<span class="string">'%s\n  %s\n  %s'</span>,warnStr{1},warnStr{2},warnStr{3});
0722 
0723                          <span class="comment">%warning([upper(funcName), ' - Bessel Variates Generation: besseli(', num2str(nu), ', ' num2str(a), ') returns Inf. Unable to proceed, return zeros ...']);</span>
0724                          out = zeros( sampleSize );
0725                          proceed = 0;
0726                     <span class="keyword">end</span>
0727                     <span class="keyword">if</span> besseliNuA == 0
0728                          warnStr{1} = [upper(funcName), <span class="string">' - Bessel Variates Generation: '</span>];
0729                          warnStr{2} = [<span class="string">'besseli('</span>, num2str(nu), <span class="string">', '</span> num2str(a), <span class="string">') returns 0.'</span>];
0730                          warnStr{3} = [<span class="string">'Unable to proceed, return zeros ...'</span>];
0731                          warning(<span class="string">'%s\n  %s\n  %s'</span>,warnStr{1},warnStr{2},warnStr{3});
0732                          <span class="comment">%warning([upper(funcName), '- Bessel Variates Generation: besseli(', num2str(nu), ', ' num2str(a), ') returns 0. Unable to proceed, return zeros ...']);</span>
0733                          out = zeros( sampleSize );
0734                          proceed = 0;
0735                     <span class="keyword">end</span>
0736 
0737                     <span class="keyword">if</span> proceed
0738                          p0 = exp( nu*log(a/2) - gammaln(nu+1) ) / besseliNuA;
0739                          <span class="keyword">if</span> p0 &gt;= 5e-10
0740                               t = p0;
0741 
0742                               aa = (a/2)^2;
0743                               nu1 = nu+1;
0744                               i = 1;
0745                               <span class="keyword">while</span> t*2147483648 &gt; 1
0746                                    t = t * aa/((i)*(i+nu));
0747                                    i = i + 1;
0748                               <span class="keyword">end</span>
0749                               sizeP = i-1;
0750                               offset = 0;
0751 
0752                               P = round( 2^30*p0*cumprod([1, aa./((1:sizeP-1).*((1:sizeP-1)+nu))] ) );
0753 
0754                          <span class="keyword">else</span> <span class="comment">% if p0 &gt;= 5e-10</span>
0755                               m = floor(0.5*(sqrt(a^2+nu^2)-nu));
0756                               pm = exp( (2*m+nu)*log(a/2) - log(besseliNuA) - <span class="keyword">...</span>
0757                                    gammaln(m+1) - gammaln(m+nu+1) );
0758 
0759                               aa = (a/2)^2;
0760                               t = pm;
0761                               i = m + 1;
0762                               <span class="keyword">while</span> t * 2147483648 &gt; 1
0763                                    t = t * aa/((i)*(i+nu));
0764                                    i = i + 1;
0765                               <span class="keyword">end</span>
0766                               last = i-2;
0767 
0768                               t = pm;
0769                               j = -1;
0770                               <span class="keyword">for</span> i = m-1:-1:0
0771                                    t = t * (i+1)*(i+1+nu)/aa;
0772                                    <span class="keyword">if</span> t*2147483648 &lt; 1
0773                                         j=i;
0774                                         <span class="keyword">break</span>;
0775                                    <span class="keyword">end</span>
0776                               <span class="keyword">end</span>
0777 
0778                               offset = j+1;
0779                               sizeP = last-offset+1;
0780 
0781                               P = zeros(1, sizeP);
0782                               P(m-offset+1:last-offset+1) = <span class="keyword">...</span>
0783                                    round( 2^30*pm*cumprod([1, aa./(((m+1):last).*(((m+1):last)+nu))] ) );
0784                               P(m-offset:-1:1) = <span class="keyword">...</span>
0785                                    round( 2^30*pm*cumprod((m:-1:(offset+1)).*((m:-1:(offset+1))+nu)/aa) );
0786 
0787                          <span class="keyword">end</span> <span class="comment">% if p0 &gt;= 5e-10, else ...</span>
0788 
0789 
0790                          out = <a href="#_sub6" class="code" title="subfunction out = randFrom5Tbls( P, offset, sampleSize)">randFrom5Tbls</a>( P, offset, sampleSize);
0791                          
0792                     <span class="keyword">end</span> <span class="comment">% if proceed</span>
0793 
0794                <span class="keyword">case</span> {<span class="string">'binom'</span>, <span class="string">'binomial'</span>}
0795                     <span class="comment">% START binom HELP START binomial HELP</span>
0796                     <span class="comment">% THE BINOMIAL DISTRIBUTION</span>
0797                     <span class="comment">%</span>
0798                     <span class="comment">% pdf(y) = nchoosek(n,y)*p^y*(1-p)^(n-y) = ...</span>
0799                     <span class="comment">%          exp( gammaln(n+1) - gammaln(n-y+1) - gammaln(y+1) + ...</span>
0800                     <span class="comment">%               y*log(p) + (n-y)*log(1-p) );  0&lt;p&lt;1, n&gt;1</span>
0801                     <span class="comment">%</span>
0802                     <span class="comment">%  Mean = n*p;</span>
0803                     <span class="comment">%  Variance = n*p*(1-p);</span>
0804                     <span class="comment">%  Mode = floor( (n+1)*p );</span>
0805                     <span class="comment">%</span>
0806                     <span class="comment">% PARAMETERS:</span>
0807                     <span class="comment">%   p  - probability of success in a single trial; (0&lt;p&lt;1)</span>
0808                     <span class="comment">%   n  - total number of trials; (n= 1, 2, 3, 4, ...)</span>
0809                     <span class="comment">%</span>
0810                     <span class="comment">% SUPPORT:</span>
0811                     <span class="comment">%   y - number of success,  y = 0, 1, 2, 3 ...</span>
0812                     <span class="comment">%</span>
0813                     <span class="comment">% CLASS:</span>
0814                     <span class="comment">%   Discrete distributions</span>
0815                     <span class="comment">%</span>
0816                     <span class="comment">% NOTES:</span>
0817                     <span class="comment">%   Constructive definition:</span>
0818                     <span class="comment">%    We consider a random experiment with n independent trials; in each trial</span>
0819                     <span class="comment">%    a certain random event A can occur (the urn model with replacement is</span>
0820                     <span class="comment">%    a special case of such an experiment). Let</span>
0821                     <span class="comment">%      p  = probability of A in a single trial;</span>
0822                     <span class="comment">%      n  = total number of trials;</span>
0823                     <span class="comment">%      y  = number of successes (= number of trials where A occurs).</span>
0824                     <span class="comment">%</span>
0825                     <span class="comment">% USAGE:</span>
0826                     <span class="comment">%   randraw('binom', [n, p], sampleSize) - generate sampleSize number</span>
0827                     <span class="comment">%         of variates from the Binomial distribution with total number of trials</span>
0828                     <span class="comment">%         'n' and probability of success in a single trial 'p'</span>
0829                     <span class="comment">%   randraw('binom') - help for the Binomial distribution;</span>
0830                     <span class="comment">%</span>
0831                     <span class="comment">% EXAMPLES:</span>
0832                     <span class="comment">%  1.   y = randraw('binom', [10 0.9], [1 1e5]);</span>
0833                     <span class="comment">%  2.   y = randraw('binom', [100 0.15], 1, 1e5);</span>
0834                     <span class="comment">%  3.   y = randraw('binom', [5 0.5], 1e5 );</span>
0835                     <span class="comment">%  4.   y = randraw('binom', [1000 0.02], [1e5 1] );</span>
0836                     <span class="comment">%  5.   randraw('binom');</span>
0837                     <span class="comment">% END binom HELP END binomial HELP</span>
0838                     
0839                     <span class="comment">% Method:</span>
0840                     <span class="comment">%</span>
0841                     <span class="comment">% We implemented Condensed Table-Lookup method suggested in</span>
0842                     <span class="comment">%    George Marsaglia, &quot;Fast Generation Of Discrete Random Variables,&quot;</span>
0843                     <span class="comment">%    Journal of Statistical Software, July 2004, Volume 11, Issue 4</span>
0844                     
0845                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Binomial'</span>, <span class="string">'binomial'</span>, distribParams, [2]);
0846                     
0847                     n = distribParams(1);
0848                     p = distribParams(2);
0849                     
0850                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Binomial'</span>, <span class="string">'binomial'</span>, <span class="string">'[n, p]'</span>, <span class="string">'n'</span>, n, {<span class="string">'&gt; 0'</span>,<span class="string">'==integer'</span>});
0851                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Binomial'</span>, <span class="string">'binomial'</span>, <span class="string">'[n, p]'</span>, <span class="string">'p'</span>, p, {<span class="string">'&gt; 0'</span>,<span class="string">'&lt; 1'</span>});
0852                     
0853                     <span class="comment">% if n large and p near 1, generate j=Binom(n,1-p), return n-j</span>
0854 
0855                     switchFlag = 0;
0856                     <span class="keyword">if</span> n*p &lt;= 1
0857                          p = 1-p;
0858                          switchFlag = 1;
0859                     <span class="keyword">end</span>
0860 
0861                     <span class="keyword">if</span> n*p &gt; 1e3 &amp; n &gt; 1e3
0862 
0863                          out = round( n*p + sqrt(n*p*(1-p))*randn( sampleSize ) );
0864 
0865                     <span class="keyword">elseif</span> p&lt;1e-4 &amp; n*p &gt; 1 &amp; n*p &lt; 100
0866 
0867                          out = feval(funcName,<span class="string">'poisson'</span>,n*p, sampleSize);
0868 
0869                     <span class="keyword">else</span>
0870 
0871                          mode = floor( (n+1)*p );
0872                          q = 1 - p;
0873                          h = p/q;
0874 
0875                          pmode = exp( gammaln(n+1) - gammaln(n-mode+1) - gammaln(mode+1) + <span class="keyword">...</span>
0876                               mode*log(p) + (n-mode)*log(1-p) );
0877                          
0878                          i = mode + 1;
0879                          t = pmode;
0880                          <span class="keyword">while</span> t*2147483648 &gt; 1
0881                               t = t * h*(n-i+1)/i;
0882                               i = i + 1;
0883                          <span class="keyword">end</span>
0884                          last = i - 2;
0885 
0886                          t = pmode;
0887                          j = -1;
0888                          <span class="keyword">for</span> i=mode-1:-1:0
0889                               t = t * (i+1)/h/(n-i);
0890                               <span class="keyword">if</span> t*2147483648 &lt; 1
0891                                    j=i;
0892                                    <span class="keyword">break</span>;
0893                               <span class="keyword">end</span>
0894                          <span class="keyword">end</span>
0895                          offset=j+1;
0896                          sizeP = last-offset+1;
0897 
0898                          P = zeros(1, sizeP);
0899 
0900                          P(mode-offset+1:last-offset+1) = <span class="keyword">...</span>
0901                               round( 2^30*pmode*cumprod([1, h*(n-(mode+1:last)+1)./(mode+1:last)] ) );
0902                          P(mode-offset:-1:1) = <span class="keyword">...</span>
0903                               round( 2^30*pmode*cumprod( (mode:-1:offset+1)./(h*(n-(mode-1:-1:offset)))) );
0904 
0905                          out = <a href="#_sub6" class="code" title="subfunction out = randFrom5Tbls( P, offset, sampleSize)">randFrom5Tbls</a>( P, offset, sampleSize);
0906 
0907                     <span class="keyword">end</span>
0908                     <span class="keyword">if</span> switchFlag
0909                          out = n - out;
0910                     <span class="keyword">end</span>
0911 
0912                <span class="keyword">case</span> {<span class="string">'bradford'</span>}
0913                     <span class="comment">% START bradford HELP</span>
0914                     <span class="comment">%  THE BRADFORD DISTRIBUTION</span>
0915                     <span class="comment">%</span>
0916                     <span class="comment">%  pdf(y) = b ./ ( log(1+b)*(1+b*y) ); 0&lt;y&lt;1</span>
0917                     <span class="comment">%  cdf(y) = log(1+b*x) ./ log(1+b);</span>
0918                     <span class="comment">%</span>
0919                     <span class="comment">%  Mean = (b - log(1+b)) / (b*log(1+b));</span>
0920                     <span class="comment">%  Variance = (b*(log(1+b)-2) + 2*log(1+b)) / (2*b*(log(1+b))^2);</span>
0921                     <span class="comment">%</span>
0922                     <span class="comment">% PARAMETERS:</span>
0923                     <span class="comment">%    b&gt;-1,b~=0  - shape parameter;</span>
0924                     <span class="comment">%</span>
0925                     <span class="comment">% SUPPORT:</span>
0926                     <span class="comment">%    0&lt;y&lt;1</span>
0927                     <span class="comment">%</span>
0928                     <span class="comment">% CLASS:</span>
0929                     <span class="comment">%   Continuous skewed distributions</span>
0930                     <span class="comment">%</span>
0931                     <span class="comment">% USAGE:</span>
0932                     <span class="comment">%   randraw('bradford', [b], sampleSize) - generate sampleSize number</span>
0933                     <span class="comment">%         of variates from the Bradford distribution with parameter b;</span>
0934                     <span class="comment">%   randraw('bradford') - help for the Bradford distribution;</span>
0935                     <span class="comment">%</span>
0936                     <span class="comment">% EXAMPLES:</span>
0937                     <span class="comment">%  1.   y = randraw('bradford', 1, [1 1e5]);</span>
0938                     <span class="comment">%  2.   y = randraw('bradford', 2.2, 1, 1e5);</span>
0939                     <span class="comment">%  3.   y = randraw('bradford', -0.4, 1e5 );</span>
0940                     <span class="comment">%  4.   y = randraw('bradford', 10, [1e5 1] );</span>
0941                     <span class="comment">%  5.   randraw('bradford');</span>
0942                     <span class="comment">% END bradford HELP</span>
0943                     
0944                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Bradford'</span>, <span class="string">'bradford'</span>, distribParams, [1]);                    
0945                     b = distribParams(1);                    
0946                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Bradford'</span>, <span class="string">'bradford'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, b, {<span class="string">'&gt; -1'</span>,<span class="string">'~=0'</span>});                    
0947                     
0948                     out = ((1+b).^rand( sampleSize ) - 1)/b;
0949                     
0950                <span class="keyword">case</span> {<span class="string">'burr'</span>, <span class="string">'fisk'</span>}
0951                     <span class="comment">% START burr HELP START fisk HELP</span>
0952                     <span class="comment">% THE BURR DISTRIBUTION</span>
0953                     <span class="comment">%  pdf(y) = c*d * y.^(-c-1) .* (1+y.^-c).^(-d-1);    y&gt;0</span>
0954                     <span class="comment">%  cdf(y) = (1 + y.^-c).^(-d);</span>
0955                     <span class="comment">%</span>
0956                     <span class="comment">% Mean = gamma(1-1/c)*gamma(1/c+d)/gamma(d);</span>
0957                     <span class="comment">% Variance = COEF / gamma(d)^2;</span>
0958                     <span class="comment">%    where  COEF = gamma(d)*gamma(1-2/c)*gamma(2/c+d) - gamma(1-1/c)^2*gamma(1/c+d)^2;</span>
0959                     <span class="comment">%</span>
0960                     <span class="comment">% PARAMETERS:</span>
0961                     <span class="comment">%   c - shape parameter (c&gt;0)</span>
0962                     <span class="comment">%   d - shape parameter (d&gt;0)</span>
0963                     <span class="comment">%</span>
0964                     <span class="comment">% SUPPORT:</span>
0965                     <span class="comment">%   y&gt;0</span>
0966                     <span class="comment">%</span>
0967                     <span class="comment">% NOTES:</span>
0968                     <span class="comment">%  The Burr distribution with d = 1, is often called the Fisk or</span>
0969                     <span class="comment">%  LogLogistic distribution</span>
0970                     <span class="comment">%  The Burr distribution is a generalization of the Fisk distribution</span>
0971                     <span class="comment">%</span>
0972                     <span class="comment">% CLASS:</span>
0973                     <span class="comment">%   Continuous skewed distributions</span>
0974                     <span class="comment">%</span>
0975                     <span class="comment">% USAGE:</span>
0976                     <span class="comment">%   randraw('burr', [c d], sampleSize) - generate sampleSize number</span>
0977                     <span class="comment">%         of variates from the Burr distribution with shape parameters</span>
0978                     <span class="comment">%         'c' and 'd';</span>
0979                     <span class="comment">%   randraw('burr') - help for the Burr distribution;</span>
0980                     <span class="comment">%</span>
0981                     <span class="comment">% EXAMPLES:</span>
0982                     <span class="comment">%  1.   y = randraw('burr', [1 2], [1 1e5]);</span>
0983                     <span class="comment">%  2.   y = randraw('burr', [2 3], 1, 1e5);</span>
0984                     <span class="comment">%  3.   y = randraw('burr', [1.5 0.2], 1e5 );</span>
0985                     <span class="comment">%  4.   y = randraw('burr', [2 2], [1e5 1] );</span>
0986                     <span class="comment">%  5.   randraw('burr');</span>
0987                     <span class="comment">% END burr HELP END fisk HELP</span>
0988                     
0989                     
0990                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Burr'</span>, <span class="string">'burr'</span>, distribParams, [2]);
0991                     c = distribParams(1);
0992                     d = distribParams(2);
0993                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Burr'</span>, <span class="string">'burr'</span>, <span class="string">'[c, d]'</span>, <span class="string">'c'</span>, c, {<span class="string">'&gt; 0'</span>});
0994                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Burr'</span>, <span class="string">'burr'</span>, <span class="string">'[c, d]'</span>, <span class="string">'d'</span>, d, {<span class="string">'&gt; 0'</span>});
0995 
0996                     out = ( rand(sampleSize).^(-1/d) - 1).^(-1/c);
0997                     
0998                <span class="keyword">case</span> {<span class="string">'cauchy'</span>, <span class="string">'lorentz'</span>, <span class="string">'caushy'</span>}
0999                     <span class="comment">% START cauchy HELP  START lorentz HELP  START caushy HELP</span>
1000                     <span class="comment">% THE CAUCHY DISTRIBUTION</span>
1001                     <span class="comment">% (sometimes: Lorentz or Breit-Wigner distribution)</span>
1002                     <span class="comment">%</span>
1003                     <span class="comment">%  The standard form of the Caushy distribution:</span>
1004                     <span class="comment">%     pdf = 1 / ( pi*(1+y.^2) );</span>
1005                     <span class="comment">%     cdf = 0.5 + atan(y)/pi;</span>
1006                     <span class="comment">%</span>
1007                     <span class="comment">%  The general form of the Cauchy distribution:</span>
1008                     <span class="comment">%     pdf = s ./ (pi*(s^2+(y-t).^2));  s&gt;0;</span>
1009                     <span class="comment">%     cdf = 0.5 + atan((y-t)/s)/pi;</span>
1010                     <span class="comment">%</span>
1011                     <span class="comment">% The Cauchy distribution does not have a finite mean or</span>
1012                     <span class="comment">% standard deviation.</span>
1013                     <span class="comment">% Like the normal distribution, it is symmetric about its median,</span>
1014                     <span class="comment">%  but with longer and flatter tails.</span>
1015                     <span class="comment">%</span>
1016                     <span class="comment">% PARAMETERS:</span>
1017                     <span class="comment">%   s&gt;0 - scale parameter;</span>
1018                     <span class="comment">%   t - loacation;</span>
1019                     <span class="comment">%</span>
1020                     <span class="comment">% SUPPORT;</span>
1021                     <span class="comment">%    -Inf &lt; y &lt; Inf</span>
1022                     <span class="comment">%</span>
1023                     <span class="comment">% CLASS:</span>
1024                     <span class="comment">%   Continuous skewed distributions</span>
1025                     <span class="comment">%</span>
1026                     <span class="comment">% USAGE:</span>
1027                     <span class="comment">%    randraw('caushy',[],sampleSize) - generation array of sampleSize</span>
1028                     <span class="comment">%         of variates from standard Cauchy distribution;</span>
1029                     <span class="comment">%    randraw('caushy',[t, s],sampleSize) - generation array of sampleSize</span>
1030                     <span class="comment">%         of variates from general form of Cauchy distribution;</span>
1031                     <span class="comment">%</span>
1032                     <span class="comment">% EXAMPLES:</span>
1033                     <span class="comment">%  1.   y = randraw('cauchy', [], [1 1e5]);</span>
1034                     <span class="comment">%  2.   y = randraw('cauchy', [10 1], 1, 1e5);</span>
1035                     <span class="comment">%  3.   y = randraw('cauchy', [-10 1.5], 1e5 );</span>
1036                     <span class="comment">%  4.   y = randraw('cauchy', [5.1 10.3], [1e5 1] );</span>
1037                     <span class="comment">%  5.   randraw('cauchy');</span>
1038                     <span class="comment">% END cauchy HELP  END lorentz HELP END caushy HELP</span>
1039                     
1040                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Cauchy'</span>, <span class="string">'cauchy'</span>, distribParams, [0, 2]);
1041                     
1042                     <span class="keyword">if</span> numel(distribParams)==2
1043                          t = distribParams(1);
1044                          s = distribParams(2);
1045 
1046                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Cauchy'</span>, <span class="string">'cauchy'</span>, <span class="string">'[t, s]'</span>, <span class="string">'s'</span>, s, {<span class="string">'&gt; 0'</span>});
1047                     <span class="keyword">else</span>
1048                          t = 0;
1049                          s = 1;
1050                     <span class="keyword">end</span>
1051 
1052                     out = t + s * tan(pi*( rand( sampleSize ) - 0.5));
1053 
1054                <span class="keyword">case</span> {<span class="string">'chi'</span>}
1055                     <span class="comment">% START chi HELP</span>
1056                     <span class="comment">% THE CHI DISTRIBUTION</span>
1057                     <span class="comment">%</span>
1058                     <span class="comment">% The standard form of the Chi distribution:</span>
1059                     <span class="comment">%</span>
1060                     <span class="comment">%   pdf(y) = exp(-y.^2/2).*y.^(nu-1) / (2^(nu/2-1)*gamma(nu/2)); nu&gt;0; y&gt;0</span>
1061                     <span class="comment">%   cdf(y) = gammainc(y.^2/2,nu/2);</span>
1062                     <span class="comment">%</span>
1063                     <span class="comment">%   Mean = sqrt(2)*gamma((nu+1)/2)/gamma(nu/2);</span>
1064                     <span class="comment">%   Variance = nu - 2*gamma((nu+1)/2)^2/gamma(nu/2)^2;</span>
1065                     <span class="comment">%</span>
1066                     <span class="comment">% The general form of the Chi distribution:</span>
1067                     <span class="comment">%</span>
1068                     <span class="comment">%   pdf(y) = exp(-((y-a)/b).^2/2).*((y-a)/b).^(nu-1) / (2^(nu/2-1)*b*gamma(nu/2)); nu&gt;0; y&gt;a; b&gt;0</span>
1069                     <span class="comment">%   cdf(y) = gammainc(((y-a)/b).^2/2,nu/2);</span>
1070                     <span class="comment">%</span>
1071                     <span class="comment">%   Mean = a + sqrt(2)*b*gamma((nu+1)/2)/gamma(nu/2);</span>
1072                     <span class="comment">%   Variance = b^2 * (nu-2*gamma((nu+1)/2)^2/gamma(nu/2)^2);</span>
1073                     <span class="comment">%</span>
1074                     <span class="comment">% PARAMETERS:</span>
1075                     <span class="comment">%   a - location</span>
1076                     <span class="comment">%   b &gt; 0 - scale</span>
1077                     <span class="comment">%   nu &gt; 0 - shape (also, degrees of freedom)</span>
1078                     <span class="comment">%</span>
1079                     <span class="comment">% SUPPORT:</span>
1080                     <span class="comment">%   y,   y&gt;0 - standard Chi distribution</span>
1081                     <span class="comment">%    or</span>
1082                     <span class="comment">%   y,   y&gt;a - generalized Chi distribution</span>
1083                     <span class="comment">%</span>
1084                     <span class="comment">% CLASS:</span>
1085                     <span class="comment">%   Continuous skewed distributions</span>
1086                     <span class="comment">%</span>
1087                     <span class="comment">% NOTES:</span>
1088                     <span class="comment">%  The chi-distribution includes several distributions as special cases.</span>
1089                     <span class="comment">%  If nu is 1, the chi-distribution reduces to the half-normal distribution.</span>
1090                     <span class="comment">%  If nu is 2, the chi-distribution is a Rayleigh distribution.</span>
1091                     <span class="comment">%  If nu is 3, the chi-distribution is a Maxwell-Boltzmann distribution.</span>
1092                     <span class="comment">%  A generalized Rayleigh distribution is a chi-distribution with a scale parameter equal to 1.</span>
1093                     <span class="comment">%</span>
1094                     <span class="comment">% USAGE:</span>
1095                     <span class="comment">%   randraw('chi', nu, sampleSize) - generate sampleSize number</span>
1096                     <span class="comment">%         of variates from the standrad Chi distribution with shape parameter 'nu';</span>
1097                     <span class="comment">%   randraw('chi', [a, b, nu], sampleSize) - generate sampleSize number</span>
1098                     <span class="comment">%         of variates from the generalized Chi distribution with location parameter</span>
1099                     <span class="comment">%         'a', scale parameter 'b' and shape parameter 'nu';</span>
1100                     <span class="comment">%   randraw('chi') - help for the Chi distribution;</span>
1101                     <span class="comment">%</span>
1102                     <span class="comment">% EXAMPLES:</span>
1103                     <span class="comment">%  1.   y = randraw('chi', [2], [1 1e5]);</span>
1104                     <span class="comment">%  2.   y = randraw('chi', [3, 1, 5], 1, 1e5);</span>
1105                     <span class="comment">%  3.   y = randraw('chi', [-10 1, 1], 1e5 );</span>
1106                     <span class="comment">%  4.   y = randraw('chi', [-2.1  3.5 4], [1e5 1] );</span>
1107                     <span class="comment">%  5.   randraw('chi');</span>
1108                     <span class="comment">% END chi HELP</span>
1109                     
1110                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Chi'</span>, <span class="string">'chi'</span>, distribParams, [1, 3]);
1111                     <span class="keyword">if</span> numel(distribParams)==3
1112                          a  = distribParams(1);
1113                          b  = distribParams(2);
1114                          nu = distribParams(3);   
1115                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Chi'</span>, <span class="string">'chi'</span>, <span class="string">'[a, b, nu]'</span>, <span class="string">'b'</span>, b, {<span class="string">'&gt; 0'</span>});
1116                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Chi'</span>, <span class="string">'chi'</span>, <span class="string">'[a, b, nu]'</span>, <span class="string">'nu'</span>, nu, {<span class="string">'&gt; 0'</span>});
1117                     <span class="keyword">else</span>
1118                          a = 0;
1119                          b = 1;
1120                          nu = distribParams(1);
1121                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Chi'</span>, <span class="string">'chi'</span>, <span class="string">'nu'</span>, <span class="string">'nu'</span>, nu, {<span class="string">'&gt; 0'</span>});                         
1122                     <span class="keyword">end</span>                    
1123 
1124                     out = a + b*sqrt( feval(funcName, <span class="string">'chisq'</span>, [nu], sampleSize) );
1125                     
1126                <span class="keyword">case</span> {<span class="string">'chisquare'</span>, <span class="string">'chisq'</span>, <span class="string">'chi2'</span>}
1127                     <span class="comment">% START chisquare HELP START chisq HELP START chi2 HELP</span>
1128                     <span class="comment">% THE CHI SQUARE DISTRIBUTION (with r degrees of freedom)</span>
1129                     <span class="comment">%</span>
1130                     <span class="comment">%  pdf(y) = y.^(r/2-1) .* exp(-y/2) / (gamma(r/2)*2^(r/2)); r &gt;=1 (integer); y&gt;0</span>
1131                     <span class="comment">%  cdf(y) = gammainc(y/2, r/2); r &gt;=1 (integer); y&gt;0;</span>
1132                     <span class="comment">%</span>
1133                     <span class="comment">%  Mean = r;</span>
1134                     <span class="comment">%  Variance = 2*r;</span>
1135                     <span class="comment">%  Skewness = 2*sqrt(2/r);</span>
1136                     <span class="comment">%  Kurtosis = 12/r;</span>
1137                     <span class="comment">%</span>
1138                     <span class="comment">% PARAMETERS:</span>
1139                     <span class="comment">%   r - degrees of freedom ( r = 1, 2, 3, ...)</span>
1140                     <span class="comment">%</span>
1141                     <span class="comment">% SUPPORT:</span>
1142                     <span class="comment">%   y,   y&gt;0</span>
1143                     <span class="comment">%</span>
1144                     <span class="comment">% CLASS:</span>
1145                     <span class="comment">%   Continuous skewed distributions</span>
1146                     <span class="comment">%</span>
1147                     <span class="comment">% NOTES:</span>
1148                     <span class="comment">%   1. Chi square distribution with r degrees of freedom is sum of r squared i.i.d Normal</span>
1149                     <span class="comment">%      distributions with zero mean and variance equal to 1;</span>
1150                     <span class="comment">%   2. It is a special case of the gamma distribution where:</span>
1151                     <span class="comment">%       the scale parameter is 2 and the shape parameter has the value r/2;</span>
1152                     <span class="comment">%</span>
1153                     <span class="comment">% USAGE:</span>
1154                     <span class="comment">%   randraw('chisq', r, sampleSize) - generate sampleSize number</span>
1155                     <span class="comment">%         of variates from CHI SQUARE distribution with r degrees of freedom;</span>
1156                     <span class="comment">%   randraw('chisq') - help for CHI SQUARE  distribution;</span>
1157                     <span class="comment">%</span>
1158                     <span class="comment">% EXAMPLES:</span>
1159                     <span class="comment">%  1.   y = randraw('chisq', [2], [1 1e5]);</span>
1160                     <span class="comment">%  2.   y = randraw('chisq', [3], 1, 1e5);</span>
1161                     <span class="comment">%  3.   y = randraw('chisq', [4], 1e5 );</span>
1162                     <span class="comment">%  4.   y = randraw('chisq', [5], [1e5 1] );</span>
1163                     <span class="comment">%  5.   randraw('chisq');</span>
1164                     <span class="comment">%</span>
1165                     <span class="comment">% SEE ALSO:</span>
1166                     <span class="comment">%  GAMMA, NON-CENTRAL CHI SQUARE distributions</span>
1167                     <span class="comment">% END chisquare HELP END chisq HELP END chi2 HELP</span>
1168                     
1169                     
1170                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Chi Square'</span>, <span class="string">'chisq'</span>, distribParams, [1]);  
1171                     r  = distribParams(1);
1172                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Chi Square'</span>, <span class="string">'chisq'</span>, <span class="string">'r'</span>, <span class="string">'r'</span>, r, {<span class="string">'&gt; 0'</span>,<span class="string">'==integer'</span>});
1173  
1174                     <span class="keyword">if</span> r &gt; 1
1175                          out = 2*<a href="randraw.html" class="code" title="function varargout = randraw(distribName, distribParams, varargin)">randraw</a>(<span class="string">'gamma'</span>, 0.5*r, sampleSize);
1176                     <span class="keyword">else</span>
1177                          out = randn(sampleSize).^2;
1178                     <span class="keyword">end</span>
1179 
1180                <span class="keyword">case</span> {<span class="string">'chisqnc'</span>,<span class="string">'chisqnoncentral'</span>, <span class="string">'chisqnoncentr'</span>,<span class="string">'chi2noncentral'</span>}
1181                     <span class="comment">% START chisqnc HELP START chisqnoncentral HELP START chisqnoncentr HELP START chi2noncentral HELP</span>
1182                     <span class="comment">% THE NON-CENTRAL CHI-SQUARE DISTRIBUTION (with non-centrality parameter lambda and</span>
1183                     <span class="comment">%                                          r degrees of freedom)</span>
1184                     <span class="comment">%</span>
1185                     <span class="comment">%  The non-central chi-square distribution with degrees of freedom r and</span>
1186                     <span class="comment">%  non-centrality parameter lambda is the sum of r independent normal</span>
1187                     <span class="comment">%  distributions with standard deviation 1.</span>
1188                     <span class="comment">%  The non-centrality parameter is one half the sum of squares of the normal</span>
1189                     <span class="comment">%  means.</span>
1190                     <span class="comment">%</span>
1191                     <span class="comment">%</span>
1192                     <span class="comment">%  pdf(y) = exp(-(y+lambda)/2).*y.^((r-1)/2)./(2*(lambda*y).^(r/4)) .* ...</span>
1193                     <span class="comment">%            besseli(r/2-1, sqrt(lambda*y)); lambda&gt;=0; r=positive integer;</span>
1194                     <span class="comment">%</span>
1195                     <span class="comment">%   Mean = lambda+r;</span>
1196                     <span class="comment">%   Variance = 2*(2*lambda+r);</span>
1197                     <span class="comment">%   Skewness = 2*sqrt(2)*(3*lambda+r)/(2*lambda+r)^(3/2);</span>
1198                     <span class="comment">%   Kurtosis = 12*(4*lambda+r)/(2*lambda+r)^2;</span>
1199                     <span class="comment">%</span>
1200                     <span class="comment">% PARAMETERS:</span>
1201                     <span class="comment">%   lambda - non-centrality parameter:  lambda&gt;=0</span>
1202                     <span class="comment">%   r - degrees of freedom ( r = 1, 2, 3, ...)</span>
1203                     <span class="comment">%</span>
1204                     <span class="comment">% SUPPORT:</span>
1205                     <span class="comment">%   y,   y&gt;0</span>
1206                     <span class="comment">%</span>
1207                     <span class="comment">% CLASS:</span>
1208                     <span class="comment">%   Continuous skewed distributions</span>
1209                     <span class="comment">%</span>
1210                     <span class="comment">% USAGE:</span>
1211                     <span class="comment">%   randraw('chisqnoncentral', [lambda, r], sampleSize) - generate sampleSize number</span>
1212                     <span class="comment">%         of variates from the NON CENTRAL CHI SQUARE distribution with</span>
1213                     <span class="comment">%         non-centrality parameter 'lambda ' and 'r' degrees of freedom;</span>
1214                     <span class="comment">%   randraw('chisqnoncentral') - help for the NON CENTRAL CHI-SQUARE  distribution;</span>
1215                     <span class="comment">%</span>
1216                     <span class="comment">% EXAMPLES:</span>
1217                     <span class="comment">%  1.   y = randraw('chisqnoncentral', [10 2], [1 1e5]);</span>
1218                     <span class="comment">%  2.   y = randraw('chisqnoncentral', [20 3], 1, 1e5);</span>
1219                     <span class="comment">%  3.   y = randraw('chisqnoncentral', [30 4], 1e5 );</span>
1220                     <span class="comment">%  4.   y = randraw('chisqnoncentral', [40 5], [1e5 1] );</span>
1221                     <span class="comment">%  5.   randraw('chisqnoncentral');</span>
1222                     <span class="comment">%</span>
1223                     <span class="comment">% SEE ALSO:</span>
1224                     <span class="comment">%  CHI SQUARE distribution</span>
1225                     <span class="comment">% END chisqnc HELP START END chisqnoncentral HELP END chisqnoncentr HELP END chi2noncentral HELP</span>
1226                     
1227                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Non-Central Chi-Square'</span>, <span class="string">'chisqnoncentral'</span>, distribParams, [2]);  
1228                     lambda = distribParams(1);
1229                     r = distribParams(2);
1230                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Non-Central Chi-Square'</span>, <span class="string">'chisqnoncentral'</span>, <span class="string">'r'</span>, <span class="string">'r'</span>, r, {<span class="string">'&gt; 0'</span>,<span class="string">'==integer'</span>});
1231                     
1232                     normalS = sqrt(lambda) + randn( sampleSize );
1233                     out = feval(funcName, <span class="string">'chisq'</span>, r-1, sampleSize);
1234                     out = out + normalS.^2;
1235                     
1236                <span class="keyword">case</span> {<span class="string">'cosine'</span>}
1237                     <span class="comment">% START cosine HELP</span>
1238                     <span class="comment">% THE COSINE DISTRIBUTION</span>
1239                     <span class="comment">%</span>
1240                     <span class="comment">% Standard form of the Cosine distribution:</span>
1241                     <span class="comment">%   pdf(y) = (1+cos(y))/(2*pi);  -pi &lt;= y &lt;= pi;</span>
1242                     <span class="comment">%   cdf(y) = (pi+y+sin(y))/(2*pi); -pi &lt;= y &lt;= pi;</span>
1243                     <span class="comment">%</span>
1244                     <span class="comment">%   Mean = Median = Mode = 0;</span>
1245                     <span class="comment">%   Variance = pi^2/3-2;</span>
1246                     <span class="comment">%</span>
1247                     <span class="comment">% General form of the Cosine distribution:</span>
1248                     <span class="comment">%   pdf(y) = (1+cos(pi*(y-t)/s))/(2*s);  t-s &lt;= y &lt;= t+s; s&gt;0</span>
1249                     <span class="comment">%   cdf(y) = (pi + pi*(y-t)/s + sin(pi*(y-t)/s))/(2*pi); t-s &lt;= y &lt;= t+s; s&gt;0</span>
1250                     <span class="comment">%</span>
1251                     <span class="comment">%   Mean = Median = Mode = t;</span>
1252                     <span class="comment">%   Variance = (pi^2/3-2)*(s/pi)^2;</span>
1253                     <span class="comment">%</span>
1254                     <span class="comment">% PARAMETERS:</span>
1255                     <span class="comment">%   t - location</span>
1256                     <span class="comment">%   s -scale; s&gt;0</span>
1257                     <span class="comment">%</span>
1258                     <span class="comment">% SUPPORT:</span>
1259                     <span class="comment">%   y,   -pi &lt;= y &lt;= pi   - standard Cosine distribution</span>
1260                     <span class="comment">%    or</span>
1261                     <span class="comment">%   y,   t-s &lt;= y &lt;= t+s  - generalized Cosine distribution</span>
1262                     <span class="comment">%</span>
1263                     <span class="comment">% CLASS:</span>
1264                     <span class="comment">%   Continuous distributions</span>
1265                     <span class="comment">%</span>
1266                     <span class="comment">% USAGE:</span>
1267                     <span class="comment">%   randraw('cosine', [], sampleSize) - generate sampleSize number</span>
1268                     <span class="comment">%         of variates from the standard Cosine distribution;</span>
1269                     <span class="comment">%   randraw('cosine', [t, s], sampleSize) - generate sampleSize number</span>
1270                     <span class="comment">%         of variates from the generalized Cosine distribution</span>
1271                     <span class="comment">%         with location parameter 't' and scale parameter 's';</span>
1272                     <span class="comment">%   randraw('cosine') - help for the Cosine distribution;</span>
1273                     <span class="comment">%</span>
1274                     <span class="comment">% EXAMPLES:</span>
1275                     <span class="comment">%  1.   y = randraw('cosine', [], [1 1e5]);</span>
1276                     <span class="comment">%  2.   y = randraw('cosine', [], 1, 1e5);</span>
1277                     <span class="comment">%  3.   y = randraw('cosine', [], 1e5 );</span>
1278                     <span class="comment">%  4.   y = randraw('cosine', [10 3], [1e5 1] );</span>
1279                     <span class="comment">%  5.   randraw('cosine');</span>
1280                     <span class="comment">% END cosine HELP</span>
1281                     
1282                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Cosine'</span>, <span class="string">'cosine'</span>, distribParams, [0, 2]);  
1283                     <span class="keyword">if</span> numel(distribParams)==2
1284                          t  = distribParams(1);
1285                          s  = distribParams(2);  
1286                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Cosine'</span>, <span class="string">'cosine'</span>, <span class="string">'[t, s]'</span>, <span class="string">'s'</span>, s, {<span class="string">'&gt; 0'</span>});
1287                     <span class="keyword">else</span>
1288                          t = 0;
1289                          s = pi;                        
1290                     <span class="keyword">end</span>   
1291 
1292                     tol = 1e-9;
1293                     
1294                     coeff1 = 1/(2*pi);
1295                     coeff2 = 1/(2*s);
1296                     coeff3 = pi/s;
1297                     
1298                     
1299                     u = 0.5 - rand(sampleSize);
1300                     out = -u*s;
1301                     outNext = out - (coeff1*sin(coeff3*out) + coeff2*out + u) ./ <span class="keyword">...</span>
1302                          (coeff2*cos(coeff3*out)+coeff2);
1303 
1304                     indxs = find(abs(outNext - out)&gt;tol);
1305                     outPrev = out(indxs);
1306                     <span class="keyword">while</span> ~isempty(indxs)
1307 
1308                          outNext = outPrev - (coeff1*sin(coeff3*outPrev) + coeff2*outPrev + u(indxs)) ./ <span class="keyword">...</span>
1309                               (coeff2*cos(coeff3*outPrev)+coeff2);
1310                          l = (abs(outNext - outPrev)&gt;tol);
1311                          out(indxs(~l)) = outNext(~l);
1312                          outPrev = outNext(l);
1313                          indxs = indxs(l);
1314                     <span class="keyword">end</span>
1315                      
1316                     out = t + out;
1317                     
1318                <span class="keyword">case</span> {<span class="string">'erlang'</span>}
1319                     <span class="comment">% START erlang HELP</span>
1320                     <span class="comment">% THE ERLANG DISTRIBUTION</span>
1321                     <span class="comment">%</span>
1322                     <span class="comment">%  pdf = (y/a).^(n-1) .* exp( -y/a ) / (a*gamma(n));</span>
1323                     <span class="comment">%  cdf = gammainc( n, y/sacle );</span>
1324                     <span class="comment">%</span>
1325                     <span class="comment">%   Mean = a*n;</span>
1326                     <span class="comment">%   Variance = a^2*n;</span>
1327                     <span class="comment">%   Skewness = 2/sqrt(n);</span>
1328                     <span class="comment">%   Kurtosis = 6/n;</span>
1329                     <span class="comment">%   Mode = (a&lt;1)*0 + (a&gt;=1)*a*(n-1);</span>
1330                     <span class="comment">%</span>
1331                     <span class="comment">%  PARAMETERS:</span>
1332                     <span class="comment">%    a - scale parameter (a&gt;0)</span>
1333                     <span class="comment">%    n - shape parameter (n = 1, 2, 3, ...)</span>
1334                     <span class="comment">%</span>
1335                     <span class="comment">%  SUPPORT:</span>
1336                     <span class="comment">%    y,  y &gt;= 0</span>
1337                     <span class="comment">%</span>
1338                     <span class="comment">%  CLASS:</span>
1339                     <span class="comment">%    Continuous skewed distributions</span>
1340                     <span class="comment">%</span>
1341                     <span class="comment">%  NOTES:</span>
1342                     <span class="comment">%    The Erlang distribution is a special case of the gamma distribution where</span>
1343                     <span class="comment">%    the shape parameter is an integer</span>
1344                     <span class="comment">%</span>
1345                     <span class="comment">% USAGE:</span>
1346                     <span class="comment">%   randraw('erlang', [a, n], sampleSize) - generate sampleSize number</span>
1347                     <span class="comment">%         of variates from the Erlang distribution</span>
1348                     <span class="comment">%         with scale parameter 'a' and shape parameter 'n';</span>
1349                     <span class="comment">%   randraw('erlang') - help for the Erlang distribution;</span>
1350                     <span class="comment">%</span>
1351                     <span class="comment">% EXAMPLES:</span>
1352                     <span class="comment">%  1.   y = randraw('erlang', [1, 3], [1 1e5]);</span>
1353                     <span class="comment">%  2.   y = randraw('erlang', [0.5, 5], 1, 1e5);</span>
1354                     <span class="comment">%  3.   y = randraw('erlang', [10, 6], 1e5 );</span>
1355                     <span class="comment">%  4.   y = randraw('erlang', [7, 4], [1e5 1] );</span>
1356                     <span class="comment">%  5.   randraw('erlang');</span>
1357                     <span class="comment">%</span>
1358                     <span class="comment">% SEE ALSO:</span>
1359                     <span class="comment">%   GAMMA distribution</span>
1360                     <span class="comment">% END erlang HELP</span>
1361                     
1362                     <span class="comment">%</span>
1363                     <span class="comment">% Inverse CDF transformation method.</span>
1364                     <span class="comment">%</span>
1365                    
1366                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Erlang'</span>, <span class="string">'erlang'</span>, distribParams, [2]);
1367                     a = distribParams(1);
1368                     n = distribParams(2);                    
1369                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Erlang'</span>, <span class="string">'erlang'</span>, <span class="string">'[a, n]'</span>, <span class="string">'a'</span>, a, {<span class="string">'&gt; 0'</span>});
1370                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Erlang'</span>, <span class="string">'erlang'</span>, <span class="string">'[a, n]'</span>, <span class="string">'n'</span>, n, {<span class="string">'&gt; 0'</span>, <span class="string">'==integer'</span>});
1371                     
1372                     out = feval(funcName, <span class="string">'gamma'</span>, n, sampleSize);
1373                     out = a * out;
1374                     
1375                <span class="keyword">case</span> {<span class="string">'exp'</span>,<span class="string">'exponential'</span>}
1376                     <span class="comment">% START exp HELP START exponential HELP</span>
1377                     <span class="comment">% THE EXPONENTIAL DISTRIBUTION</span>
1378                     <span class="comment">%</span>
1379                     <span class="comment">% pdf = lambda * exp( -lambda*y );</span>
1380                     <span class="comment">% cdf = 1 - exp(-lambda*y);</span>
1381                     <span class="comment">%</span>
1382                     <span class="comment">%  Mean = 1/lambda;</span>
1383                     <span class="comment">%  Variance = 1/lambda^2;</span>
1384                     <span class="comment">%  Mode = lambda;</span>
1385                     <span class="comment">%  Median = log(2)/lambda;</span>
1386                     <span class="comment">%  Skewness = 2;</span>
1387                     <span class="comment">%  Kurtosis = 6;</span>
1388                     <span class="comment">%</span>
1389                     <span class="comment">% PARAMETERS:</span>
1390                     <span class="comment">%   lambda - inverse scale or rate (lambda&gt;0)</span>
1391                     <span class="comment">%</span>
1392                     <span class="comment">% SUPPORT:</span>
1393                     <span class="comment">%   y,  y&gt;= 0</span>
1394                     <span class="comment">%</span>
1395                     <span class="comment">% CLASS:</span>
1396                     <span class="comment">%   Continuous skewed distributions</span>
1397                     <span class="comment">%</span>
1398                     <span class="comment">% NOTES:</span>
1399                     <span class="comment">%  The discrete version of the Exponential distribution is</span>
1400                     <span class="comment">%  the Geometric distribution.</span>
1401                     <span class="comment">%</span>
1402                     <span class="comment">% USAGE:</span>
1403                     <span class="comment">%   randraw('exp', lambda, sampleSize) - generate sampleSize number</span>
1404                     <span class="comment">%         of variates from the Exponential distribution</span>
1405                     <span class="comment">%         with parameter 'lambda';</span>
1406                     <span class="comment">%   randraw('exp') - help for the Exponential distribution;</span>
1407                     <span class="comment">%</span>
1408                     <span class="comment">% EXAMPLES:</span>
1409                     <span class="comment">%  1.   y = randraw('exp', 1, [1 1e5]);</span>
1410                     <span class="comment">%  2.   y = randraw('exp', 1.5, 1, 1e5);</span>
1411                     <span class="comment">%  3.   y = randraw('exp', 2, 1e5 );</span>
1412                     <span class="comment">%  4.   y = randraw('exp', 3, [1e5 1] );</span>
1413                     <span class="comment">%  5.   randraw('exp');</span>
1414                     <span class="comment">%</span>
1415                     <span class="comment">% SEE ALSO:</span>
1416                     <span class="comment">%   GEOMETRIC, GAMMA, POISSON, WEIBULL distributions</span>
1417                     <span class="comment">% END exp HELP END exponential HELP</span>
1418                     
1419                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Exponential'</span>, <span class="string">'exp'</span>, distribParams, [1]);  
1420                     lambda  = distribParams(1);
1421                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Exponential'</span>, <span class="string">'exp'</span>, <span class="string">'lambda'</span>, <span class="string">'lambda'</span>, lambda, {<span class="string">'&gt; 0'</span>});
1422                     
1423                     out = -log( rand( sampleSize ) ) / lambda;
1424                
1425                <span class="keyword">case</span> {<span class="string">'extrval'</span>, <span class="string">'extremevalue'</span>, <span class="string">'extrvalue'</span>, <span class="string">'gumbel'</span>}
1426                     <span class="comment">% START extrval HELP START extremevalue HELP START extrvalue HELP START gumbel HELP</span>
1427                     <span class="comment">% THE EXTREME VALUE DISTRIBUTION</span>
1428                     <span class="comment">%   Also known as the Fisher-Tippett distribution or log-Weibull distribution or Gumbel</span>
1429                     <span class="comment">%   distribution</span>
1430                     <span class="comment">%</span>
1431                     <span class="comment">%  pdf(y) = 1/b * exp((mu-y)/b - exp((mu-y)/b)); -Inf&lt;y&lt;Inf; b&gt;0</span>
1432                     <span class="comment">%  cdf(y) = exp(-exp((mu-y)/b)); -Inf&lt;y&lt;Inf; b&gt;0</span>
1433                     <span class="comment">%</span>
1434                     <span class="comment">%   Mean = mu + b*g; where g=5.772156649015329e-001; is the Euler-Mascheroni constant</span>
1435                     <span class="comment">%   Variance = pi^2*b^2/6;</span>
1436                     <span class="comment">%   Skewness = 12*sqrt(6)*zeta3/pi^3; where zeta3=1.20205690315732e+000; is Apery's constant</span>
1437                     <span class="comment">%   Kurtosis = 12/5;</span>
1438                     <span class="comment">%</span>
1439                     <span class="comment">% PARAMETERS:</span>
1440                     <span class="comment">%   mu - location (-Inf&lt;mu&lt;inf)</span>
1441                     <span class="comment">%   b  - scale (b&gt;0)</span>
1442                     <span class="comment">%</span>
1443                     <span class="comment">% SUPPORT:</span>
1444                     <span class="comment">%   y,   -Inf&lt;y&lt;Inf</span>
1445                     <span class="comment">%</span>
1446                     <span class="comment">% CLASS:</span>
1447                     <span class="comment">%   Continuous skewed distributions</span>
1448                     <span class="comment">%</span>
1449                     <span class="comment">% NOTES:</span>
1450                     <span class="comment">%</span>
1451                     <span class="comment">% USAGE:</span>
1452                     <span class="comment">%   randraw('extrvalue', [mu b], sampleSize) - generate sampleSize number</span>
1453                     <span class="comment">%         of variates from Extreme-Value distribution with location parameter mu</span>
1454                     <span class="comment">%         and scale parameter b;</span>
1455                     <span class="comment">%   randraw('extrvalue') - help for Extreme-Value distribution;</span>
1456                     <span class="comment">%</span>
1457                     <span class="comment">% EXAMPLES:</span>
1458                     <span class="comment">%  1.   y = randraw('extrvalue', [0 1], [1 1e5]);</span>
1459                     <span class="comment">%  2.   y = randraw('extrvalue', [10 2], 1, 1e5);</span>
1460                     <span class="comment">%  3.   y = randraw('extrvalue', [15.5 4], 1e5 );</span>
1461                     <span class="comment">%  4.   y = randraw('extrvalue', [100 100], [1e5 1] );</span>
1462                     <span class="comment">%  5.   randraw('extrvalue');</span>
1463                     <span class="comment">%</span>
1464                     <span class="comment">% SEE ALSO:</span>
1465                     <span class="comment">%   GUMBEL, WEIBULL distributions</span>
1466                     <span class="comment">% END extrval HELP END extremevalue HELP END extrvalue HELP END gumbel HELP</span>
1467                                         
1468                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Extreme Value'</span>, <span class="string">'extrvalue'</span>, distribParams, [2]);  
1469                     mu  = distribParams(1);
1470                     b  = distribParams(2);
1471                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Extreme Value'</span>, <span class="string">'extrvalue'</span>, <span class="string">'[mu, b]'</span>, <span class="string">'b'</span>, b, {<span class="string">'&gt; 0'</span>});
1472 
1473                     out = mu - b * log(-log( rand( sampleSize )));
1474 
1475                <span class="keyword">case</span> {<span class="string">'f'</span>,<span class="string">'fdistribution'</span>, <span class="string">'fdistrib'</span>, <span class="string">'fdistr'</span>, <span class="string">'fdist'</span>, <span class="string">'fdis'</span> }
1476                     <span class="comment">% START f HELP START fdistribution HELP START fdistrib HELP START fdistr HELP START fdist HELP START fdis HELP</span>
1477                     <span class="comment">% THE F-DISTRIBUTION (also Central F-distribution)</span>
1478                     <span class="comment">%</span>
1479                     <span class="comment">%     In statistics and probability, the F-distribution is a continuous</span>
1480                     <span class="comment">%   probability distribution. It is also known as Snedecor's F distribution or</span>
1481                     <span class="comment">%   the Fisher-Snedecor distribution (after Ronald Fisher and George W. Snedecor).</span>
1482                     <span class="comment">%     A random variate of the F-distribution arises as the ratio of two chi-squared</span>
1483                     <span class="comment">%   variates: (U1/d1)/(U2/d2), where U1 and U2 have chi-square distributions with</span>
1484                     <span class="comment">%   d1 and d2 degrees of freedom respectively, and U1 and U2 are independent.</span>
1485                     <span class="comment">%    The F-distribution arises frequently as the null distribution of a test statistic,</span>
1486                     <span class="comment">%   especially in likelihood-ratio tests, perhaps most notably in the analysis of</span>
1487                     <span class="comment">%   variance;</span>
1488                     <span class="comment">%</span>
1489                     <span class="comment">%   pdf(y) = 1/beta(d1/2,d2/2) * (d1*y./(d1*y+d2)).^(d1/2) .* (1 - d1*y./(d1*y+d2)).^(d2/2) ./ y;</span>
1490                     <span class="comment">%   cdf(y) = beatinc(d1*y./(d1*y+d2), d1/2, d2/2);</span>
1491                     <span class="comment">%</span>
1492                     <span class="comment">%   Mean = d2/(d2-2), provided d2 &gt; 2;</span>
1493                     <span class="comment">%   Variance = 2*d2^2*(d1+d2-2)/(d1*(d2-2)^2*(d2-4)), provided d2&gt;4;</span>
1494                     <span class="comment">%   Skewness = (2*d1+d2-2)*sqrt(8*(d2-4))/((d2-6)*sqrt(d1*(d1+d2-2))), provided d2&gt;6;</span>
1495                     <span class="comment">%   Mode = (d1-2)/d1 * d2/(d2+2), provided d1&gt;2;</span>
1496                     <span class="comment">%</span>
1497                     <span class="comment">% PARAMETERS:</span>
1498                     <span class="comment">%   d1 - positive integer</span>
1499                     <span class="comment">%   d2 - positive integer</span>
1500                     <span class="comment">%</span>
1501                     <span class="comment">% SUPPORT:</span>
1502                     <span class="comment">%   y,   y&gt;0</span>
1503                     <span class="comment">%</span>
1504                     <span class="comment">% CLASS:</span>
1505                     <span class="comment">%   Continuous skewed distributions</span>
1506                     <span class="comment">%</span>
1507                     <span class="comment">% USAGE:</span>
1508                     <span class="comment">%   randraw('f', [d1 d2], sampleSize) - generate sampleSize number</span>
1509                     <span class="comment">%         of variates from F-distribution with parameters d1 and d2;</span>
1510                     <span class="comment">%   randraw('f') - help for F-distribution;</span>
1511                     <span class="comment">%</span>
1512                     <span class="comment">% EXAMPLES:</span>
1513                     <span class="comment">%  1.   y = randraw('f', [2 3], [1 1e5]);</span>
1514                     <span class="comment">%  2.   y = randraw('f', [2 3], 1, 1e5);</span>
1515                     <span class="comment">%  3.   y = randraw('f', [2 3], 1e5 );</span>
1516                     <span class="comment">%  4.   y = randraw('f', [2 3], [1e5 1] );</span>
1517                     <span class="comment">%  5.   randraw('f');</span>
1518                     <span class="comment">% END f HELP END fdistribution HELP END fdistrib HELP END fdistr HELP END fdist HELP END fdis HELP</span>
1519 
1520                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'F'</span>, <span class="string">'f'</span>, distribParams, [2]);                    
1521                     d1 = distribParams(1);
1522                     d2 = distribParams(2);                    
1523                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'F'</span>, <span class="string">'f'</span>, <span class="string">'[d1, d2]'</span>, <span class="string">'d1'</span>, d1, {<span class="string">'&gt; 0'</span>,<span class="string">'==integer'</span>});
1524                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'F'</span>, <span class="string">'f'</span>, <span class="string">'[d1, d2]'</span>, <span class="string">'d2'</span>, d2, {<span class="string">'&gt; 0'</span>,<span class="string">'==integer'</span>});
1525                     
1526                     out = feval(funcName, <span class="string">'beta'</span>, [0.5*d1 0.5*d2], sampleSize);
1527                     out = d2*out ./ (d1*(1-out));
1528               
1529                <span class="keyword">case</span> {<span class="string">'fnc'</span>, <span class="string">'fnoncentral'</span>, <span class="string">'fnoncentr'</span>}
1530                     <span class="comment">% START fnc HELP START fnoncentral HELP START fnoncentr HELP</span>
1531                     <span class="comment">% THE NONCENTRAL F-DISTRIBUTION</span>
1532                     <span class="comment">%</span>
1533                     <span class="comment">%  The central F distribution is the ratio of 2 central chi-square distributions with</span>
1534                     <span class="comment">%  d1 and d2 degrees of freedom respectively. The noncentral F distribution is the ratio</span>
1535                     <span class="comment">%  of a non-central chi-square distribution with d1 degrees of freedom and non-centrality</span>
1536                     <span class="comment">%  parameter lambda and a central chi-square distribution with degrees of freedom parameter</span>
1537                     <span class="comment">%  d2.</span>
1538                     <span class="comment">%  The non-centrality parameter should be non-negative, and both degrees of freedom parameters</span>
1539                     <span class="comment">%  should be positive.</span>
1540                     <span class="comment">%</span>
1541                     <span class="comment">%    Mean = (d1+lambda)*d2/(d1*(d2-2)), provided d2 &gt; 2;</span>
1542                     <span class="comment">%    Variance = ( ( d1+lambda )^2 + 2*( d1+lambda )*d2^2 )/( (d2-2)*(d2-4)*d1^2 ) - ...</span>
1543                     <span class="comment">%              (d1+lambda)^2*d2^2/((d2-2)^2*d1^2);  provided d2 &gt; 4;</span>
1544                     <span class="comment">%</span>
1545                     <span class="comment">% PARAMETERS:</span>
1546                     <span class="comment">%   lambda - non-centrality parameter (lambda&gt;=0);</span>
1547                     <span class="comment">%   d1     - positive integer</span>
1548                     <span class="comment">%   d2     - positive integer</span>
1549                     <span class="comment">%</span>
1550                     <span class="comment">% SUPPORT:</span>
1551                     <span class="comment">%   y,   y&gt;0</span>
1552                     <span class="comment">%</span>
1553                     <span class="comment">% CLASS:</span>
1554                     <span class="comment">%   Continuous skewed distributions</span>
1555                     <span class="comment">%</span>
1556                     <span class="comment">% USAGE:</span>
1557                     <span class="comment">%   randraw('fnoncentral', [lambda d1 d2], sampleSize) - generate sampleSize number</span>
1558                     <span class="comment">%         of variates from noncentral F-distribution with parameters lambda, d1 and d2;</span>
1559                     <span class="comment">%   randraw('fnoncentral') - help for noncentral F-distribution;</span>
1560                     <span class="comment">%</span>
1561                     <span class="comment">% EXAMPLES:</span>
1562                     <span class="comment">%  1.   y = randraw('fnoncentral', [1 2 5], [1 1e5]);</span>
1563                     <span class="comment">%  2.   y = randraw('fnoncentral', [2 3 5], 1, 1e5);</span>
1564                     <span class="comment">%  3.   y = randraw('fnoncentral', [6 6 6], 1e5 );</span>
1565                     <span class="comment">%  4.   y = randraw('fnoncentral', [1.1 8 9], [1e5 1] );</span>
1566                     <span class="comment">%  5.   randraw('fnoncentral');</span>
1567                     <span class="comment">%</span>
1568                     <span class="comment">% SEE ALSO:</span>
1569                     <span class="comment">%  F distribution</span>
1570                     <span class="comment">% END fnc HELP END fnoncentral HELP END fnoncentr HELP</span>
1571                     
1572                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'noncentral F'</span>, <span class="string">'fnoncentral'</span>, distribParams, [3]);
1573                     
1574                     lambda = distribParams(1);
1575                     d1 = distribParams(2);
1576                     d2 = distribParams(3);
1577                     
1578                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'noncentral F'</span>, <span class="string">'fnoncentral'</span>, <span class="string">'[lambda, d1, d2]'</span>, <span class="string">'lambda'</span>, lambda, {<span class="string">'&gt;=0'</span>});                    
1579                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'noncentral F'</span>, <span class="string">'fnoncentral'</span>, <span class="string">'[lambda, d1, d2]'</span>, <span class="string">'d1'</span>, d1, {<span class="string">'&gt; 0'</span>,<span class="string">'==integer'</span>});
1580                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'noncentral F'</span>, <span class="string">'fnoncentral'</span>, <span class="string">'[lambda, d1, d2]'</span>, <span class="string">'d2'</span>, d2, {<span class="string">'&gt; 0'</span>,<span class="string">'==integer'</span>});
1581                     
1582                     chisq1 = feval(funcName, <span class="string">'chisqnoncentral'</span>, [lambda, d1], sampleSize);
1583                     out = feval(funcName, <span class="string">'chisq'</span>, d2, sampleSize);
1584                     out = (chisq1/d1) ./ (out/d2);
1585                     
1586                <span class="keyword">case</span> {<span class="string">'gamma'</span>}
1587                     <span class="comment">% START gamma HELP START gama HELP</span>
1588                     <span class="comment">% THE GAMMA DISTRIBUTION</span>
1589                     <span class="comment">%</span>
1590                     <span class="comment">% The standard form of the GAMMA distribution:</span>
1591                     <span class="comment">%</span>
1592                     <span class="comment">%   pdf(y) = y^(a-1)*exp(-y)/gamma(a);  y&gt;=0, a&gt;0</span>
1593                     <span class="comment">%   cdf(y) = gammainc(y, a);</span>
1594                     <span class="comment">%</span>
1595                     <span class="comment">%   Mean = a;</span>
1596                     <span class="comment">%   Variance = a;</span>
1597                     <span class="comment">%   Skewness = 2/sqrt(a);</span>
1598                     <span class="comment">%   Kurtosis = 6/a;</span>
1599                     <span class="comment">%   Mode = a-1;</span>
1600                     <span class="comment">%</span>
1601                     <span class="comment">% The general form of the GAMMA distribution:</span>
1602                     <span class="comment">%</span>
1603                     <span class="comment">%   pdf(y) = ((y-m)/b).^(a-1) .* exp(-(y-m)/b)/ (b*gamma(a));  y&gt;=m; a&gt;0; b&gt;0</span>
1604                     <span class="comment">%   cdf(y) = gammainc((y-m)/b, a);  y&gt;=m; a&gt;0; b&gt;0</span>
1605                     <span class="comment">%</span>
1606                     <span class="comment">%   Mean = m + a*b;</span>
1607                     <span class="comment">%   Variance = a*b^2;</span>
1608                     <span class="comment">%   Skewness = 2/sqrt(a);</span>
1609                     <span class="comment">%   Kurtosis = 6/a;</span>
1610                     <span class="comment">%   Mode = m + b*(a-1);</span>
1611                     <span class="comment">%</span>
1612                     <span class="comment">% PARAMETERS:</span>
1613                     <span class="comment">%   m - location</span>
1614                     <span class="comment">%   b - scale; b&gt;0</span>
1615                     <span class="comment">%   a - shape; a&gt;0</span>
1616                     <span class="comment">%</span>
1617                     <span class="comment">% SUPPORT:</span>
1618                     <span class="comment">%   y,   y&gt;=0   - standard GAMMA distribution</span>
1619                     <span class="comment">%    or</span>
1620                     <span class="comment">%   y,   y&gt;=m   - generalized GAMMA distribution</span>
1621                     <span class="comment">%</span>
1622                     <span class="comment">% CLASS:</span>
1623                     <span class="comment">%   Continuous skewed distributions</span>
1624                     <span class="comment">%</span>
1625                     <span class="comment">% NOTES:</span>
1626                     <span class="comment">% 1. The GAMMA distribution approaches a NORMAL distribution as a goes to Inf</span>
1627                     <span class="comment">% 5. GAMMA(m, b, a), where a is an integer, is the Erlang distribution.</span>
1628                     <span class="comment">% 6. GAMMA(m, b, 1) is the Exponential distribution.</span>
1629                     <span class="comment">% 7. GAMMA(0, 2, nu/2) is the Chi-square distribution with nu degrees of freedom.</span>
1630                     <span class="comment">%</span>
1631                     <span class="comment">% USAGE:</span>
1632                     <span class="comment">%   randraw('gamma', a, sampleSize) - generate sampleSize number</span>
1633                     <span class="comment">%         of variates from standard GAMMA distribution with shape parameter 'a';</span>
1634                     <span class="comment">%   randraw('gamma', [m, b, a], sampleSize) - generate sampleSize number</span>
1635                     <span class="comment">%         of variates from generalized GAMMA distribution</span>
1636                     <span class="comment">%         with location parameter 'm', scale parameter 'b' and shape parameter 'a';</span>
1637                     <span class="comment">%   randraw('gamma') - help for GAMMA distribution;</span>
1638                     <span class="comment">%</span>
1639                     <span class="comment">% EXAMPLES:</span>
1640                     <span class="comment">%  1.   y = randraw('gamma', [2], [1 1e5]);</span>
1641                     <span class="comment">%  2.   y = randraw('gamma', [0 10 2], 1, 1e5);</span>
1642                     <span class="comment">%  3.   y = randraw('gamma', [3], 1e5 );</span>
1643                     <span class="comment">%  4.   y = randraw('gamma', [1/3], 1e5 );</span>
1644                     <span class="comment">%  5.   y = randraw('gamma', [1 3 2], [1e5 1] );</span>
1645                     <span class="comment">%  6.   randraw('gamma');</span>
1646                     <span class="comment">%</span>
1647                     <span class="comment">% END gamma HELP END gama HELP</span>
1648                     
1649                     <span class="comment">% Method:</span>
1650                     <span class="comment">%</span>
1651                     <span class="comment">% Reference:</span>
1652                     <span class="comment">% George Marsaglia and Wai Wan Tsang, &quot;A Simple Method for Generating Gamma</span>
1653                     <span class="comment">%   Variables&quot;: ACM Transactions on Mathematical Software, Vol. 26, No. 3,</span>
1654                     <span class="comment">%   September 2000, Pages 363-372</span>
1655                     
1656                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Gamma'</span>, <span class="string">'gamma'</span>, distribParams, [1, 3]);
1657                     <span class="keyword">if</span> numel(distribParams)==3
1658                          m  = distribParams(1);
1659                          b  = distribParams(2);
1660                          a  = distribParams(3);
1661                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Gamma'</span>, <span class="string">'gamma'</span>, <span class="string">'[m, b, a]'</span>, <span class="string">'a'</span>, a, {<span class="string">'&gt; 0'</span>});
1662                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Gamma'</span>, <span class="string">'gamma'</span>, <span class="string">'[m, b, a]'</span>, <span class="string">'b'</span>, b, {<span class="string">'&gt; 0'</span>});
1663                     <span class="keyword">else</span>
1664                          m = 0;
1665                          b = 1;
1666                          a  = distribParams(1);
1667                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Gamma'</span>, <span class="string">'gamma'</span>, <span class="string">'[m, b, a]'</span>, <span class="string">'a'</span>, a, {<span class="string">'&gt; 0'</span>});                         
1668                     <span class="keyword">end</span>
1669                     
1670                     <span class="keyword">if</span> a &lt; 1
1671                          <span class="comment">% If a&lt;1, one can use GAMMA(a)=GAMMA(1+a)*UNIFORM(0,1)^(1/a);</span>
1672                          out = m + b*(feval(funcName, <span class="string">'gamma'</span>, 1+a, sampleSize)).*(rand(sampleSize).^(1/a));                         
1673                          
1674                     <span class="keyword">else</span>
1675                          
1676                          d = a - 1/3;
1677                          c = 1/sqrt(9*d);
1678                          
1679                          x = randn( sampleSize );
1680                          v = 1+c*x;
1681                          
1682                          indxs = find(v &lt;= 0);
1683                          <span class="keyword">while</span> ~isempty(indxs)
1684                               indxsSize = size( indxs );
1685                               xNew = randn( indxsSize );
1686                               vNew = a+c*xNew;
1687                               
1688                               l = (vNew &gt; 0);
1689                               v( indxs( l ) ) = vNew(l);
1690                               x( indxs( l ) ) = xNew(l);
1691                               indxs = indxs( ~l );
1692                          <span class="keyword">end</span>
1693                          
1694                          u = rand( sampleSize );
1695                          v = v.^3;
1696                          x2 = x.^2;
1697                          out = d*v;
1698                          
1699                          indxs = find( (u&gt;=1-0.0331*x2.^2) &amp; (log(u)&gt;=0.5*x2+d*(1-v+log(v))) );
1700                          <span class="keyword">while</span> ~isempty(indxs)
1701                               indxsSize = size( indxs );
1702                               
1703                               x = randn( indxsSize );
1704                               v = 1+c*x;
1705                               indxs1 = find(v &lt;= 0);
1706                               <span class="keyword">while</span> ~isempty(indxs1)
1707                                    indxsSize1 = size( indxs1 );
1708                                    xNew = randn( indxsSize1 );
1709                                    vNew = a+c*xNew;
1710                                    
1711                                    l1 = (vNew &gt; 0);
1712                                    v( indxs1(l1) ) = vNew(l1);
1713                                    x( indxs1(l1) ) = xNew(l1);
1714                                    indxs1 = indxs1( ~l1 );
1715                               <span class="keyword">end</span>
1716                               
1717                               u = rand( indxsSize );
1718                               v = v .* v .* v;
1719                               x2 = x.*x;
1720                               
1721                               l = (u&lt;1-0.0331*x2.*x2) | (log(u)&lt;0.5*x2+d*(1-v+log(v)));
1722                               out( indxs( l ) ) = d*v(l);
1723                               indxs = indxs( ~l );
1724                          <span class="keyword">end</span> <span class="comment">% while ~isempty(indxs)</span>
1725                          
1726                          out = m + b*out;
1727                          
1728                     <span class="keyword">end</span> <span class="comment">% if a &lt; 1, else ...</span>
1729                
1730                <span class="keyword">case</span> {<span class="string">'geometric'</span>, <span class="string">'geom'</span>, <span class="string">'furry'</span>}
1731                     <span class="comment">% START geometric HELP START geom HELP START furry HELP</span>
1732                     <span class="comment">% THE GEOMETRIC DISTRIBUTION</span>
1733                     <span class="comment">%</span>
1734                     <span class="comment">% pdf(n) = p*(1-p)^(n-1);</span>
1735                     <span class="comment">%</span>
1736                     <span class="comment">% Mean = 1/p;</span>
1737                     <span class="comment">% Variance = (1-p)/p^2;</span>
1738                     <span class="comment">% Mode = 1;</span>
1739                     <span class="comment">%</span>
1740                     <span class="comment">% PARAMETERS:</span>
1741                     <span class="comment">%    p - probability of success (0&lt;p&lt;1)</span>
1742                     <span class="comment">%</span>
1743                     <span class="comment">% SUPPORT:</span>
1744                     <span class="comment">%   n,  n = 1, 2, 3, 4, ...</span>
1745                     <span class="comment">%</span>
1746                     <span class="comment">% CLASS:</span>
1747                     <span class="comment">%   Discrete distributions</span>
1748                     <span class="comment">%</span>
1749                     <span class="comment">% NOTES:</span>
1750                     <span class="comment">%  1. The Geometric distribution is the discrete version of</span>
1751                     <span class="comment">%     the Exponential distribution.</span>
1752                     <span class="comment">%  2. The Geometric distribution is sometimes called</span>
1753                     <span class="comment">%     the Furry distribution.</span>
1754                     <span class="comment">%  3. In a series of Bernoulli trials, with Prob(success) = p,</span>
1755                     <span class="comment">%     the number of trials required to realize the first</span>
1756                     <span class="comment">%     success is ~Geometric(p).</span>
1757                     <span class="comment">%  4. For the k'th success, see the Negative Binomial distribution.</span>
1758                     <span class="comment">%</span>
1759                     <span class="comment">% USAGE:</span>
1760                     <span class="comment">%   randraw('geom', p, sampleSize) - generate sampleSize number</span>
1761                     <span class="comment">%         of variates from the Geometric distribution with</span>
1762                     <span class="comment">%         probability of success 'p'</span>
1763                     <span class="comment">%   randraw('geom') - help for the Geometric distribution;</span>
1764                     <span class="comment">%</span>
1765                     <span class="comment">% EXAMPLES:</span>
1766                     <span class="comment">%  1.   y = randraw('geom', 0.1, [1 1e5]);</span>
1767                     <span class="comment">%  2.   y = randraw('geom', 0.22, 1, 1e5);</span>
1768                     <span class="comment">%  3.   y = randraw('geom', 0.5, 1e5 );</span>
1769                     <span class="comment">%  4.   y = randraw('geom', 0.99, [1e5 1] );</span>
1770                     <span class="comment">%  5.   randraw('geom');</span>
1771                     <span class="comment">% END geometric HELP END geom HELP END furry HELP</span>
1772                     
1773                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Geometric'</span>, <span class="string">'geom'</span>, distribParams, [1]);  
1774                     p  = distribParams(1);
1775                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Geometric'</span>, <span class="string">'geom'</span>, <span class="string">'p'</span>, <span class="string">'p'</span>, p, {<span class="string">'&gt; 0'</span>});
1776                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Geometric'</span>, <span class="string">'geom'</span>, <span class="string">'p'</span>, <span class="string">'p'</span>, p, {<span class="string">'&lt; 1'</span>});
1777                     
1778                     out = ceil( log( rand( sampleSize ) ) / log( 1 - p ) );
1779                     
1780                <span class="keyword">case</span> {<span class="string">'gig'</span>}
1781                     <span class="comment">% START gig HELP</span>
1782                     <span class="comment">% THE GENERALIZED INVERSE GAUSSIAN DISTRIBUTION</span>
1783                     <span class="comment">%     GIG(lam, chi, psi)</span>
1784                     <span class="comment">%</span>
1785                     <span class="comment">% pdf = (psi/chi)^(lam/2)*y.^(lam-1)/(2*besselk(lam, sqrt(chi*psi))) .* exp(-1/2*(chi./y + psi*y));  y &gt; 0</span>
1786                     <span class="comment">%</span>
1787                     <span class="comment">% Mean = sqrt( chi / psi ) * besselk(lam+1,sqrt(chi*psi),1)/besselk(lam,sqrt(chi*psi),1);</span>
1788                     <span class="comment">% Variance = chi/psi * besselk(lam+2,sqrt(chi*psi),1)/besselk(lam,sqrt(chi*psi),1) - Mean^2;</span>
1789                     <span class="comment">%</span>
1790                     <span class="comment">% PARAMETERS:</span>
1791                     <span class="comment">%   chi&gt;0,  psi&gt;=0  if lam&lt;0;</span>
1792                     <span class="comment">%   chi&gt;0,  psi&gt;0   if lam=0;</span>
1793                     <span class="comment">%   chi&gt;=0, psi&gt;0   if lam&gt;0;</span>
1794                     <span class="comment">%</span>
1795                     <span class="comment">% SUPPORT:</span>
1796                     <span class="comment">%   y,  y &gt;= 0</span>
1797                     <span class="comment">%</span>
1798                     <span class="comment">% CLASS:</span>
1799                     <span class="comment">%   Continuous skewed distributions</span>
1800                     <span class="comment">%</span>
1801                     <span class="comment">% NOTES:</span>
1802                     <span class="comment">%    1) GIG(lam, chi, psi) = 1/c * GIG(lam, chi*c, psi/c), for all c&gt;=0</span>
1803                     <span class="comment">%    2) GIG(lam, chi, psi) = sqrt(chi/psi) * GIG(lam, sqrt(psi*chi), sqrt(psi*chi));</span>
1804                     <span class="comment">%    3) GIG(lam, chi, psi) = 1 / GIG(-lam, psi, chi);</span>
1805                     <span class="comment">%</span>
1806                     <span class="comment">%   Special cases of GIG distribution are the gamma distribution (chi=0), the</span>
1807                     <span class="comment">%     reciprocal gamma distribution (psi=0), the inverse Gaussian distribution</span>
1808                     <span class="comment">%     (lam = -1/2), and the inverse Gaussian or random walk distribution (lam=1/2).</span>
1809                     <span class="comment">%</span>
1810                     <span class="comment">% USAGE:</span>
1811                     <span class="comment">%   randraw('gig', [lam, chi, psi], sampleSize) - generate sampleSize number</span>
1812                     <span class="comment">%         of variates from the Generalized Inverse Gaussian distribution with</span>
1813                     <span class="comment">%         parameters 'lam', 'chi' and 'psi'</span>
1814                     <span class="comment">%   randraw('gig') - help for the Generalized Inverse Gaussian distribution;</span>
1815                     <span class="comment">%</span>
1816                     <span class="comment">% EXAMPLES:</span>
1817                     <span class="comment">%  1.   y = randraw('gig', [-1, 2, 0], [1 1e5]);</span>
1818                     <span class="comment">%  2.   y = randraw('gig', [2, 3, 4], 1, 1e5);</span>
1819                     <span class="comment">%  3.   y = randraw('gig', [0, 1.1, 2.2], 1e5 );</span>
1820                     <span class="comment">%  4.   y = randraw('gig', [2.5, 3.5, 4.5], [1e5 1] );</span>
1821                     <span class="comment">%  5.   y = randraw('gig', [0.5, 0.6, 0.7], [1e5 1] );</span>
1822                     <span class="comment">%  6.   randraw('gig');</span>
1823                     <span class="comment">% END gig HELP</span>
1824                     
1825                     <span class="comment">% Reference:</span>
1826                     <span class="comment">%  1. Dagpunar, J.S., &quot;Principles of random variate generation,&quot;</span>
1827                     <span class="comment">%        Clarendon Press, Oxford, 1988.   ISBN 0-19-852202-9</span>
1828                     <span class="comment">%  2. Dagpunar, J.S., &quot;An easily implemented generalized inverse Gaussian generator,&quot;</span>
1829                     <span class="comment">%        Commun. Statist. Simul. 18(2), 1989, pp 703-710.</span>
1830                     
1831                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Generalized Inverse Gaussian'</span>, <span class="string">'gig'</span>, distribParams, [3]);
1832                     lam = distribParams(1);
1833                     chi = distribParams(2);
1834                     psi = distribParams(3);
1835                     
1836                     <span class="keyword">if</span> lam &lt; 0,
1837                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Generalized Inverse Gaussian'</span>, <span class="string">'gig'</span>, <span class="string">'[lambda, chi, psi]'</span>, <span class="string">'chi'</span>, chi, {<span class="string">'&gt; 0'</span>});
1838                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Generalized Inverse Gaussian'</span>, <span class="string">'gig'</span>, <span class="string">'[lambda, chi, psi]'</span>, <span class="string">'psi'</span>, psi, {<span class="string">'&gt;=0'</span>});
1839                     <span class="keyword">elseif</span> lam &gt; 0,
1840                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Generalized Inverse Gaussian'</span>, <span class="string">'gig'</span>, <span class="string">'[lambda, chi, psi]'</span>, <span class="string">'chi'</span>, chi, {<span class="string">'&gt;=0'</span>});
1841                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Generalized Inverse Gaussian'</span>, <span class="string">'gig'</span>, <span class="string">'[lambda, chi, psi]'</span>, <span class="string">'psi'</span>, psi, {<span class="string">'&gt; 0'</span>});
1842                     <span class="keyword">else</span> <span class="comment">% lam==0</span>
1843                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Generalized Inverse Gaussian'</span>, <span class="string">'gig'</span>, <span class="string">'[lambda, chi, psi]'</span>, <span class="string">'chi'</span>, chi, {<span class="string">'&gt; 0'</span>});
1844                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Generalized Inverse Gaussian'</span>, <span class="string">'gig'</span>, <span class="string">'[lambda, chi, psi]'</span>, <span class="string">'psi'</span>, psi, {<span class="string">'&gt; 0'</span>});                         
1845                     <span class="keyword">end</span>
1846                     
1847                     <span class="keyword">if</span> chi == 0,
1848                          <span class="comment">% Gamma distribution: Gamma(m=0, b=2/psi, lam)</span>
1849                          out = feval(funcName, <span class="string">'gamma'</span>, [0, 2/psi, lam], sampleSize);
1850                          varargout{1} = out;
1851                          <span class="keyword">return</span>;
1852                     <span class="keyword">end</span>
1853                     
1854                     <span class="keyword">if</span> psi == 0,
1855                          <span class="comment">% Reciprocal Gamma distribution: Gamma(m=0, b=2/chi, -lam)</span>
1856                          out = feval(funcName, <span class="string">'gamma'</span>, [0, 2/chi, -lam], sampleSize);
1857                          varargout{1} = 1./out;
1858                          <span class="keyword">return</span>;
1859                     <span class="keyword">end</span>
1860                     
1861                     h = lam;
1862                     b = sqrt( chi * psi );
1863                                         
1864                     <span class="keyword">if</span> h&lt;=1 &amp; b&lt;=1                         
1865                          <span class="comment">% without shifting by m</span>
1866                                                  
1867                          ym = (-h-1 + sqrt((h+1)^2 + b^2))/b;                         
1868                          xm = ( h-1 + sqrt((h-1)^2 + b^2))/b;
1869                          <span class="comment">% a = vplus/uplus</span>
1870                          a = exp(-0.5*h*log(xm*ym) + 0.5*log(xm/ym) + b/4*(xm + 1/xm - ym - 1.0/ym));
1871                          <span class="comment">% c = 1/log(sqrt(hx(xm)))</span>
1872                          c = -(h-1)/2* log(xm) + b/4*(xm + 1/xm);
1873                          <span class="comment">% vminus = 0</span>
1874 
1875                          u = rand( sampleSize );
1876                          v = rand( sampleSize );
1877                          out = a * (v./u);
1878                          indxs = find( log(u) &gt; (h-1)/2*log(out) - b/4*(out + 1./out) + c );
1879                          <span class="keyword">while</span> ~isempty( indxs )
1880                               indxsSize = size( indxs );
1881                               u = rand( indxsSize );
1882                               v = rand( indxsSize );
1883                               outNew = a * (v./u);
1884                               l = log(u) &lt;= (h-1)/2*log(outNew) - b/4*(outNew + 1./outNew) + c;
1885                               out( indxs( l ) ) = outNew(l);
1886                               indxs = indxs( ~l );
1887                          <span class="keyword">end</span>                      
1888 
1889                     <span class="keyword">else</span> <span class="comment">% if h&lt;=1 &amp; b&lt;=1</span>
1890                          <span class="comment">% with shifting by m</span>
1891                          
1892                          <span class="comment">% Mode of the reparameterized distribution GIG(lam, b, b)</span>
1893                          m = ( h-1+sqrt((h-1)^2+b^2) ) / b;  <span class="comment">% Mode</span>
1894                          log_1_over_pm = -(h-1)/2*log(m) + b/4*(m + (1/m));
1895                          
1896                          r = (6*m + 2*h*m - b*m^2 + b)/(4*m^2);
1897                          s = (1 + h - b*m)/(2*m^2);
1898                          p = (3*s - r^2)/3;
1899                          q = (2*r^3)/27 - (r*s)/27 + b/(-4*m^2);
1900                          eta = sqrt(-(p^3)/27);
1901                          
1902                          y1  = 2*exp(log(eta)/3) * cos(acos(-q/(2*eta))/3) - r/3;
1903                          y2  = 2*exp(log(eta)/3) * cos(acos(-q/(2*eta))/3 + 2/3*pi) - r/3;
1904 
1905 
1906                          vplus = exp( log_1_over_pm + log(1/y1) + (h-1)/2*log(1/y1 + m) - <span class="keyword">...</span>
1907                               b/4*(1/y1 + m + 1/(1/y1 + m)) );
1908                          vminus = -exp( log_1_over_pm + log(-1/y2) + (h-1)/2*log(1/y2 + m) - <span class="keyword">...</span>
1909                               b/4*(1/y2 + m + 1/(1/y2 + m)) );  
1910                          
1911                          u = rand( sampleSize );
1912                          v = vminus + (vplus - vminus) * rand( sampleSize );
1913                          z = v ./ u;
1914                          clear(<span class="string">'v'</span>);
1915                          indxs = find( z &lt; -m );
1916                          
1917                          <span class="keyword">while</span> ~isempty(indxs),
1918                               indxsSize = size( indxs );
1919                               uNew = rand( indxsSize );
1920                               vNew = vminus + (vplus - vminus) * rand( indxsSize );
1921                               zNew = vNew ./ uNew;
1922                               l = (zNew &gt;= -m);
1923                               z( indxs( l ) ) = zNew(l);
1924                               u( indxs( l ) ) = uNew(l);
1925                               indxs = indxs( ~l );
1926                          <span class="keyword">end</span>
1927                          
1928                          out = z + m;
1929                          indxs = find( log(u) &gt; (log_1_over_pm + (h-1)/2*log(out) - b/4*(out + 1./out)) );
1930                          
1931                          <span class="keyword">while</span> ~isempty(indxs),
1932                               indxsSize = size( indxs );                             
1933                               u = rand( indxsSize );
1934                               v = vminus + (vplus - vminus) * rand( indxsSize );
1935                               z = v ./ u;
1936                               clear(<span class="string">'v'</span>);
1937                               indxs1 = find( z &lt; -m );
1938                               <span class="keyword">while</span> ~isempty(indxs1),
1939                                    indxsSize1 = size( indxs1 );
1940                                    uNew = rand( indxsSize1 );
1941                                    vNew = vminus + (vplus - vminus) * rand( indxsSize1 );
1942                                    zNew = vNew ./ uNew;
1943                                    l = (zNew &gt;= -m);
1944                                    z( indxs1( l ) ) = zNew(l);
1945                                    u( indxs1( l ) ) = uNew(l);
1946                                    indxs1 = indxs1( ~l );
1947                               <span class="keyword">end</span>
1948                               
1949                               outNew = z + m;
1950                               l = ( log(u) &lt;= (log_1_over_pm + (h-1)/2*log(outNew) - b/4*(outNew + 1./outNew)) );
1951                               out( indxs(l) ) = outNew( l );
1952                               indxs = indxs( ~l );
1953                               
1954                          <span class="keyword">end</span>
1955                          
1956                     <span class="keyword">end</span> <span class="comment">%% if h&lt;=1 &amp; b&lt;=1, else ...</span>
1957  
1958                     out = sqrt( chi / psi ) * out;
1959                     
1960                <span class="keyword">case</span> {<span class="string">'gh'</span>}
1961                     <span class="comment">% START gh HELP</span>
1962                     <span class="comment">% THE GENERALIZED HYPERBOLIC DISTRIBUTION</span>
1963                     <span class="comment">%   GH(lam, alpha, beta, mu, delta)</span>
1964                     <span class="comment">%</span>
1965                     <span class="comment">%  pdf =  (alpha^2-beta^2)^(lam/2) / (sqrt(2*pi) * alpha^(lam-1/2) * delta^lam * ...</span>
1966                     <span class="comment">%                   besselk(lam, delta*sqrt(alpha^2-beta^2) ) ) * ...</span>
1967                     <span class="comment">%            (delta^2 + (y-mu).^2).^(1/2*(lam-1/2)) .* ...</span>
1968                     <span class="comment">%             besselk( lam-1/2, alpha*sqrt(delta^2 + (y-mu).^2) ) .* ...</span>
1969                     <span class="comment">%             exp( beta*(y-mu) );</span>
1970                     <span class="comment">%</span>
1971                     <span class="comment">%  Mean = mu + beta*delta^2/(delta*sqrt(alpha^2-beta^2)) * besselk(lam+1, delta*sqrt(alpha^2-beta^2) ) / ...</span>
1972                     <span class="comment">%           besselk(lam, delta*sqrt(alpha^2-beta^2) );</span>
1973                     <span class="comment">%  Variance = delta^2 * ( besselk(lam+1, zeta)/(zeta*besselk(lam, zeta)) + ...</span>
1974                     <span class="comment">%               beta^2*delta^2/zeta^2 * (besselk(lam+2, zeta)/besselk(lam, zeta) - ...</span>
1975                     <span class="comment">%               (besselk(lam+1, zeta)/besselk(lam, zeta))^2) );</span>
1976                     <span class="comment">%       where zeta = delta*sqrt(alpha^2-beta^2);</span>
1977                     <span class="comment">%</span>
1978                     <span class="comment">% PARAMETERS:</span>
1979                     <span class="comment">%     lam,  -Inf &lt; lam &lt; Inf;</span>
1980                     <span class="comment">%     alpha - shape parameter (alpha&gt;0) (steepness)</span>
1981                     <span class="comment">%     beta -  0 &lt;= abs(beta) &lt; alpha  (skewness)</span>
1982                     <span class="comment">%     mu - location parameter (-Inf &lt; mu &lt; Inf)</span>
1983                     <span class="comment">%     delta - scale parameter (delta &gt; 0)</span>
1984                     <span class="comment">%</span>
1985                     <span class="comment">% SUPPORT:</span>
1986                     <span class="comment">%   y,  -Inf &lt; y &lt; Inf;</span>
1987                     <span class="comment">%</span>
1988                     <span class="comment">% CLASS:</span>
1989                     <span class="comment">%   Continuous skewed distributions</span>
1990                     <span class="comment">%</span>
1991                     <span class="comment">% USAGE:</span>
1992                     <span class="comment">%   randraw('gh', [lam, alpha, beta, mu, delta], sampleSize) - generate sampleSize number</span>
1993                     <span class="comment">%         of variates from the Generalized Hyperbolic distribution with</span>
1994                     <span class="comment">%         parameters [lam, alpha, beta, mu, delta]</span>
1995                     <span class="comment">%   randraw('gh') - help for the Generalized Hyperbolic distribution;</span>
1996                     <span class="comment">%</span>
1997                     <span class="comment">% EXAMPLES:</span>
1998                     <span class="comment">%  1.   y = randraw('gh', [3, 4, 3, 7.5, 1.5], [1 1e5]);</span>
1999                     <span class="comment">%  2.   y = randraw('gh', [3, 4, 3, 8.5, 1.5], 1, 1e5);</span>
2000                     <span class="comment">%  3.   y = randraw('gh', [3, 4, 3, 9.5, 1.5], 1e5 );</span>
2001                     <span class="comment">%  4.   y = randraw('gh', [3, 4, 3, 12.5, 1.5], [1e5 1] );</span>
2002                     <span class="comment">%  5.   randraw('gh');</span>
2003                     <span class="comment">% END gh HELP</span>
2004                     
2005                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'GH'</span>, <span class="string">'gh'</span>, distribParams, [5]);
2006                       
2007                     lam   = distribParams(1);
2008                     alpha = distribParams(2);
2009                     beta  = distribParams(3);
2010                     mu    = distribParams(4);
2011                     delta = distribParams(5);
2012                     
2013                                         
2014                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'GH'</span>, <span class="string">'gh'</span>, <span class="string">'[lam, alpha, beta, mu, delta]'</span>, <span class="string">'alpha'</span>, alpha, {<span class="string">'&gt; 0'</span>});
2015                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'GH'</span>, <span class="string">'gh'</span>, <span class="string">'[lam, alpha, beta, mu, delta]'</span>, <span class="string">'delta'</span>, delta, {<span class="string">'&gt; 0'</span>});
2016                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'GH'</span>, <span class="string">'gh'</span>, <span class="string">'[lam, alpha, beta, mu, delta]'</span>, <span class="string">'alpha-abs(beta)'</span>, alpha-abs(beta), {<span class="string">'&gt; 0'</span>});
2017                     
2018                     ygig = feval(funcName, <span class="string">'gig'</span>, [lam, delta^2, alpha^2-beta^2], sampleSize);
2019                     
2020                     out = mu + beta*ygig + sqrt(ygig).*randn( sampleSize );
2021                     
2022                <span class="keyword">case</span> {<span class="string">'gompertz'</span>}
2023                     <span class="comment">% START gompertz HELP</span>
2024                     <span class="comment">% THE GOMPERTZ DISTRIBUTION</span>
2025                     <span class="comment">%</span>
2026                     <span class="comment">%  pdf(y) = b * c.^y * exp(-b*(c.^y-1)/log(c)); y&gt;=0; b&gt;0; c&gt;1</span>
2027                     <span class="comment">%  cdf(y) = 1 - exp(-b*(c.^y-1)/log(c)); y&gt;=0; b&gt;0; c&gt;1</span>
2028                     <span class="comment">%</span>
2029                     <span class="comment">%  Mean = exp(b/log(c)) * (-1/log(c)) * (-expint(b/log(c)));</span>
2030                     <span class="comment">%  Variance =</span>
2031                     <span class="comment">%</span>
2032                     <span class="comment">% PARAMETERS:</span>
2033                     <span class="comment">%   b - shape parameter (b&gt;0)</span>
2034                     <span class="comment">%   c - shape parameter (c&gt;1)</span>
2035                     <span class="comment">%</span>
2036                     <span class="comment">% SUPPORT:</span>
2037                     <span class="comment">%   y,   y&gt;=0</span>
2038                     <span class="comment">%</span>
2039                     <span class="comment">% CLASS:</span>
2040                     <span class="comment">%   Continuous skewed distributions</span>
2041                     <span class="comment">%</span>
2042                     <span class="comment">% NOTES:</span>
2043                     <span class="comment">%   There are several forms given for the Gompertz distribution in the literature.</span>
2044                     <span class="comment">%   In particular, one common form uses the parameter alpha where alpha=log(c).</span>
2045                     <span class="comment">%</span>
2046                     <span class="comment">%   The Gompertz distribution is frequently used by actuaries as a distribution</span>
2047                     <span class="comment">%   of length of life.</span>
2048                     <span class="comment">%</span>
2049                     <span class="comment">% USAGE:</span>
2050                     <span class="comment">%   randraw('gompertz', [b, c], sampleSize) - generate sampleSize number</span>
2051                     <span class="comment">%         of variates from Gompertz distribution with shape parameters 'b'</span>
2052                     <span class="comment">%         and 'c';</span>
2053                     <span class="comment">%   randraw('gompertz') - help for Gompertz distribution;</span>
2054                     <span class="comment">%</span>
2055                     <span class="comment">% EXAMPLES:</span>
2056                     <span class="comment">%  1.   y = randraw('gompertz', [1 2], [1 1e5]);</span>
2057                     <span class="comment">%  2.   y = randraw('gompertz', [2 3], 1, 1e5);</span>
2058                     <span class="comment">%  3.   y = randraw('gompertz', [1.1 5], 1e5 );</span>
2059                     <span class="comment">%  4.   y = randraw('gompertz', [2.3 4.8], [1e5 1] );</span>
2060                     <span class="comment">%  5.   randraw('gompertz');</span>
2061                     <span class="comment">% END gompertz HELP</span>
2062                     
2063                     <span class="comment">% Method:</span>
2064                     <span class="comment">%</span>
2065                     <span class="comment">% Inverse CDF transformation method.</span>
2066                     <span class="comment">%</span>
2067                     <span class="comment">% Reference:</span>
2068                     <span class="comment">%</span>
2069                     <span class="comment">%  Dennis Kunimura, &quot;The Compertz Distribution - Estimation of Parameters,&quot;</span>
2070                     <span class="comment">%    Actuarial Research Clearing House, 1998, Vol.2</span>
2071                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Gompertz'</span>, <span class="string">'gompertz'</span>, distribParams, [2]);  
2072                     b  = distribParams(1);
2073                     c  = distribParams(2);
2074                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Gompertz'</span>, <span class="string">'gompertz'</span>, <span class="string">'[b, c]'</span>, <span class="string">'b'</span>, b, {<span class="string">'&gt; 0'</span>});
2075                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Gompertz'</span>, <span class="string">'gompertz'</span>, <span class="string">'[b, c]'</span>, <span class="string">'c'</span>, c, {<span class="string">'&gt; 1'</span>});
2076                     
2077                     out = log( 1 - log(1-rand(sampleSize))*log(c)/b ) / log(c);                    
2078 
2079                <span class="keyword">case</span> {<span class="string">'halfcosine'</span>, <span class="string">'hcosine'</span>, <span class="string">'hcos'</span>}
2080                     <span class="comment">% START halfcosine HELP</span>
2081                     <span class="comment">% THE HALF-COSINE DISTRIBUTION</span>
2082                     <span class="comment">%</span>
2083                     <span class="comment">% Standard Half-cosine distribution:</span>
2084                     <span class="comment">%   pdf(y) = 1/4 * cos( y/2 );  -pi &lt;= y &lt;= pi</span>
2085                     <span class="comment">%   cdf(y) = 1/2 * ( 1 + sin( y/2 ) );   -pi &lt;= y &lt;= pi</span>
2086                     <span class="comment">%</span>
2087                     <span class="comment">%  Mean = 0;</span>
2088                     <span class="comment">%  Variance = pi^2-8;</span>
2089                     <span class="comment">%</span>
2090                     <span class="comment">% General half-cosine distribution:</span>
2091                     <span class="comment">%   pdf(y) = pi/(4*a) * cos( pi*(y-t)/(2*s) );  t-s &lt;= y &lt;= t+s</span>
2092                     <span class="comment">%   cdf(y) = 1/2 * ( 1 + sin( pi*(y-t)/(2*s) ) );   t-s &lt;= y &lt;= t+s</span>
2093                     <span class="comment">%</span>
2094                     <span class="comment">%  Mean = t;</span>
2095                     <span class="comment">%  Variance = (1-8/pi^2)*s^2;</span>
2096                     <span class="comment">%</span>
2097                     <span class="comment">% PARAMETERS:</span>
2098                     <span class="comment">%   t - location</span>
2099                     <span class="comment">%   s -scale; s&gt;0</span>
2100                     <span class="comment">%</span>
2101                     <span class="comment">% SUPPORT:</span>
2102                     <span class="comment">%   y,   -pi &lt;= y &lt;= pi   - standard Half-cosine distribution</span>
2103                     <span class="comment">%    or</span>
2104                     <span class="comment">%   y,   t-s &lt;= y &lt;= t+s  - generalized Half-cosine distribution</span>
2105                     <span class="comment">%</span>
2106                     <span class="comment">% CLASS:</span>
2107                     <span class="comment">%   Continuous distributions</span>
2108                     <span class="comment">%</span>
2109                     <span class="comment">% USAGE:</span>
2110                     <span class="comment">%   randraw('halfcosine', [], sampleSize) - generate sampleSize number</span>
2111                     <span class="comment">%         of variates from standard  Half-cosine distribution;</span>
2112                     <span class="comment">%   randraw('halfcosine', [t, s], sampleSize) - generate sampleSize number</span>
2113                     <span class="comment">%         of variates from generalized  Half-cosine distribution</span>
2114                     <span class="comment">%         with location parameter 't' and scale parameter 's';</span>
2115                     <span class="comment">%   randraw('halfcosine') - help for Half-cosine distribution;</span>
2116                     <span class="comment">%</span>
2117                     <span class="comment">% EXAMPLES:</span>
2118                     <span class="comment">%  1.   y = randraw('halfcosine', [], [1 1e5]);</span>
2119                     <span class="comment">%  2.   y = randraw('halfcosine', [], 1, 1e5);</span>
2120                     <span class="comment">%  3.   y = randraw('halfcosine', [], 1e5 );</span>
2121                     <span class="comment">%  4.   y = randraw('halfcosine', [10 3], [1e5 1] );</span>
2122                     <span class="comment">%  5.   randraw('halfcosine');</span>
2123                     <span class="comment">%</span>
2124                     <span class="comment">% END halfcosine HELP</span>
2125                     
2126                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Half-Cosine'</span>, <span class="string">'halfcosine'</span>, distribParams, [0, 2]);  
2127                     <span class="keyword">if</span> numel(distribParams)==2
2128                          t  = distribParams(1);
2129                          s  = distribParams(2);  
2130                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Half-Cosine'</span>, <span class="string">'halfcosine'</span>, <span class="string">'[t, s]'</span>, <span class="string">'s'</span>, s, {<span class="string">'&gt; 0'</span>});
2131                     <span class="keyword">else</span>
2132                          t = 0;
2133                          s = pi;                        
2134                     <span class="keyword">end</span>                       
2135                     
2136                     out = t + s*2/pi*asin(2*rand(sampleSize)-1);
2137                     
2138                <span class="keyword">case</span> {<span class="string">'hyperbolicsecant'</span>, <span class="string">'hsecant'</span>, <span class="string">'hsec'</span>}
2139                     <span class="comment">% START hsecant HELP START hsec HELP START hyperbolicsecant HELP</span>
2140                     <span class="comment">% THE HYPERBOLIC SECANT DISTRIBUTION</span>
2141                     <span class="comment">%</span>
2142                     <span class="comment">%  Standard form of the Hyperbolic Secant distribution</span>
2143                     <span class="comment">%    pdf(y) = sech(y)/pi;</span>
2144                     <span class="comment">%    cdf(y) = 2*atan(exp(y))/pi;</span>
2145                     <span class="comment">%</span>
2146                     <span class="comment">%    Mean = Median = Mode = 0;</span>
2147                     <span class="comment">%    Variance = pi^2/4;</span>
2148                     <span class="comment">%    Skewness = 0;</span>
2149                     <span class="comment">%    Kurtosis = 2;</span>
2150                     <span class="comment">%</span>
2151                     <span class="comment">%  General form of the Hyperbolic Secant distribution</span>
2152                     <span class="comment">%    pdf(y) = sech((y-a)/b)/(b*pi);</span>
2153                     <span class="comment">%    cdf(y) = 2*atan(exp((y-a)/b))/pi;</span>
2154                     <span class="comment">%</span>
2155                     <span class="comment">%    Mean = Median = Mode = a;</span>
2156                     <span class="comment">%    Variance = (pi*b)^2/4;</span>
2157                     <span class="comment">%    Skewness = 0;</span>
2158                     <span class="comment">%    Kurtosis = 2;</span>
2159                     <span class="comment">%</span>
2160                     <span class="comment">% PARAMETERS:</span>
2161                     <span class="comment">%    a - location;</span>
2162                     <span class="comment">%    b - scale; (b&gt;0)</span>
2163                     <span class="comment">%</span>
2164                     <span class="comment">% SUPPORT:</span>
2165                     <span class="comment">%   y,   -Inf &lt; y &lt; Inf</span>
2166                     <span class="comment">%</span>
2167                     <span class="comment">% CLASS:</span>
2168                     <span class="comment">%   Continuous symmetric distributions</span>
2169                     <span class="comment">%</span>
2170                     <span class="comment">% NOTES:</span>
2171                     <span class="comment">%  1. The Hyperbolic Secant is related to the Logistic distribution.</span>
2172                     <span class="comment">%  2. If Z ~Hyperbolic Secant, then W = exp(Z) ~Half Cauchy.</span>
2173                     <span class="comment">%  3. The Hyperbolic Secant distribution is used in lifetime analysis.</span>
2174                     <span class="comment">%</span>
2175                     <span class="comment">% USAGE:</span>
2176                     <span class="comment">%   randraw('hsecant', [], sampleSize) - generate sampleSize number</span>
2177                     <span class="comment">%         of variates from standard Hyperbolic Secant distribution;</span>
2178                     <span class="comment">%   randraw('hsecant', [a, b], sampleSize) - generate sampleSize number</span>
2179                     <span class="comment">%         of variates from generalized Hyperbolic Secant distribution</span>
2180                     <span class="comment">%         with location parameter 'a' and scale parameter 'b';</span>
2181                     <span class="comment">%   randraw('hsecant') - help for Hyperbolic Secant distribution;</span>
2182                     <span class="comment">%</span>
2183                     <span class="comment">% EXAMPLES:</span>
2184                     <span class="comment">%  1.   y = randraw('hsecant', [], [1 1e5]);</span>
2185                     <span class="comment">%  2.   y = randraw('hsecant', [-1 4], 1, 1e5);</span>
2186                     <span class="comment">%  3.   y = randraw('hsecant', [], 1e5 );</span>
2187                     <span class="comment">%  4.   y = randraw('hsecant', [10.1 3.2], [1e5 1] );</span>
2188                     <span class="comment">%  5.   randraw('hsecant');</span>
2189                     <span class="comment">% END hsecant HELP END hsec HELP END hyperbolicsecant HELP</span>
2190                     
2191                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Hyperbolic Secant'</span>, <span class="string">'hsecant'</span>, distribParams, [0, 2]);  
2192                     <span class="keyword">if</span> numel(distribParams)==2
2193                          a  = distribParams(1);
2194                          b  = distribParams(2);  
2195                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Hyperbolic Secant'</span>, <span class="string">'hsecant'</span>, <span class="string">'[a, b]'</span>, <span class="string">'b'</span>, b, {<span class="string">'&gt; 0'</span>});
2196                     <span class="keyword">else</span>
2197                          a = 0;
2198                          b = 1;                        
2199                     <span class="keyword">end</span>   
2200                     
2201                     out = a + b* log(tan(pi/2*rand(sampleSize)));
2202                     
2203                <span class="keyword">case</span> {<span class="string">'hypergeom'</span>, <span class="string">'hypergeometric'</span>}
2204                     <span class="comment">% START hypergeom HELP START hypergeometric HELP</span>
2205                     <span class="comment">% THE HYPERGEOMETRIC DISTRIBUTION</span>
2206                     <span class="comment">% If Y is the number of SUCCESSES in a completely random sample of size n drawn from</span>
2207                     <span class="comment">% a population consisting of M SUCCESSES and (N-M) FAILURES, then Y distributed according</span>
2208                     <span class="comment">%  to Hypergeometric distribution</span>
2209                     <span class="comment">%</span>
2210                     <span class="comment">% pdf(y) = nchoosek(M,y)*nchoosek(N-M,n-y) / nchoosek(N,n) = ...</span>
2211                     <span class="comment">%          exp( gammaln(M+1) - gammaln(M-y+1) - gammaln(y+1) + ...</span>
2212                     <span class="comment">%               gammaln(N-M+1) - gammaln(N-M-n+y+1) - gammaln(n-y+1) + ...</span>
2213                     <span class="comment">%               gammaln(n+1) + gammaln(N-n+1) - gammaln(N+1) );</span>
2214                     <span class="comment">%</span>
2215                     <span class="comment">%    max(0, n-N+M) &lt;= y &lt;= min(n,M)</span>
2216                     <span class="comment">%</span>
2217                     <span class="comment">% Mean = n*(M/N);</span>
2218                     <span class="comment">% Variance = (N-n)/(N-1)*n*M/N*(1-M/N);</span>
2219                     <span class="comment">% Mode = floor( (M+1)*(n+1)/(N+2) );</span>
2220                     <span class="comment">%</span>
2221                     <span class="comment">% PARAMETERS:</span>
2222                     <span class="comment">%   N,   N = 2, 3, 4, ...</span>
2223                     <span class="comment">%   M,   0 &lt; M &lt; N</span>
2224                     <span class="comment">%   n,   0 &lt; n &lt; N</span>
2225                     <span class="comment">%</span>
2226                     <span class="comment">% SUPPORT:</span>
2227                     <span class="comment">%   y,  y is integer and  max(0, n-N+M) &lt;= y &lt;= min(n,M),</span>
2228                     <span class="comment">%</span>
2229                     <span class="comment">% CLASS:</span>
2230                     <span class="comment">%   Discrete distributions</span>
2231                     <span class="comment">%</span>
2232                     <span class="comment">% NOTES:</span>
2233                     <span class="comment">%  1. In the urn model:</span>
2234                     <span class="comment">%     From an urn with white and black balls a random sample is drawn without</span>
2235                     <span class="comment">%     replacement, then</span>
2236                     <span class="comment">%     N = total number of balls in the urn;</span>
2237                     <span class="comment">%     M = number of white balls in the urn;</span>
2238                     <span class="comment">%     n = sample size (number of balls drawn without replacement);</span>
2239                     <span class="comment">%     Y = number of white balls in the sample.</span>
2240                     <span class="comment">%</span>
2241                     <span class="comment">%  2. When the population size is large (i.e. N is large) the hypergeometric</span>
2242                     <span class="comment">%     distribution can be approximated reasonably well with a binomial</span>
2243                     <span class="comment">%     distribution with parameters n (number of trials) and p = M / N</span>
2244                     <span class="comment">%     (probability of success in a single trial).</span>
2245                     <span class="comment">%</span>
2246                     <span class="comment">% USAGE:</span>
2247                     <span class="comment">%   randraw('hypergeom', [N, M, n], sampleSize) - generate sampleSize number</span>
2248                     <span class="comment">%         of variates from the  Hypergeometric distribution</span>
2249                     <span class="comment">%         with parameters N, M and n;</span>
2250                     <span class="comment">%   randraw('hypergeom') - help for the  Hypergeometric distribution;</span>
2251                     <span class="comment">%</span>
2252                     <span class="comment">% EXAMPLES:</span>
2253                     <span class="comment">%  1.   y = randraw('hypergeom', [20 13 17], [1 1e5]);</span>
2254                     <span class="comment">%  2.   y = randraw('hypergeom', [30 22 14], 1, 1e5);</span>
2255                     <span class="comment">%  3.   y = randraw('hypergeom', [50 3  22], 1e5 );</span>
2256                     <span class="comment">%  4.   y = randraw('hypergeom', [33 32 10], [1e5 1] );</span>
2257                     <span class="comment">%  5.   randraw('hypergeom');</span>
2258                     <span class="comment">%</span>
2259                     <span class="comment">% SEE ALSO:</span>
2260                     <span class="comment">%  BINOMIAL distribution</span>
2261                     <span class="comment">% END hypergeom HELP END hypergeometric HELP</span>
2262 
2263                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Hypergeometric'</span>, <span class="string">'hypergeom'</span>, distribParams, [3]);
2264                     N = distribParams(1);
2265                     M = distribParams(2);
2266                     n = distribParams(3);
2267                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Hypergeometric'</span>, <span class="string">'hypergeom'</span>, <span class="string">'[N, M, n]'</span>, <span class="string">'N'</span>, N, {<span class="string">'&gt; 1'</span>, <span class="string">'==integer'</span>});
2268                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Hypergeometric'</span>, <span class="string">'hypergeom'</span>, <span class="string">'[N, M, n]'</span>, <span class="string">'M'</span>, M, {<span class="string">'&gt; 0'</span>, <span class="string">'==integer'</span>});
2269                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Hypergeometric'</span>, <span class="string">'hypergeom'</span>, <span class="string">'[N, M, n]'</span>, <span class="string">'n'</span>, n, {<span class="string">'&gt; 0'</span>, <span class="string">'==integer'</span>});
2270                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Hypergeometric'</span>, <span class="string">'hypergeom'</span>, <span class="string">'[N, M, n]'</span>, <span class="string">'N-M'</span>, N-M, {<span class="string">'&gt; 0'</span>});
2271                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Hypergeometric'</span>, <span class="string">'hypergeom'</span>, <span class="string">'[N, M, n]'</span>, <span class="string">'N-n'</span>, N-n, {<span class="string">'&gt; 0'</span>});
2272                                         
2273                     mode = floor( (M+1)/(N+2)*(n+1) );
2274                     <span class="keyword">if</span> ~isfinite(mode)
2275                          warning(<span class="string">'Numeric Overflow !'</span>);
2276                          varargout{1} = [];
2277                          <span class="keyword">return</span>;
2278                     <span class="keyword">end</span>
2279                     pmode = exp( gammaln(M+1) - gammaln(M-mode+1) - gammaln(mode+1) + <span class="keyword">...</span>
2280                          gammaln(N-M+1) - gammaln(N-M-n+mode+1) - gammaln(n-mode+1) + <span class="keyword">...</span>
2281                          gammaln(n+1) + gammaln(N-n+1) - gammaln(N+1) );
2282 
2283                     <span class="keyword">if</span> pmode &lt; 5e-10
2284                          varargout{1} = repmat(mode, sampleSize);
2285                          <span class="keyword">return</span>;                         
2286                     <span class="keyword">end</span>
2287                     
2288                     <span class="keyword">if</span> ~isfinite(pmode)
2289                          varargout{1} = feval(funcName, <span class="string">'binomial'</span>, [n M/N], sampleSize);
2290                     <span class="keyword">end</span>
2291                     <span class="keyword">if</span> pmode==1,
2292                          varargout{1} = repmat(mode, sampleSize);
2293                          <span class="keyword">return</span>;
2294                     <span class="keyword">end</span>
2295                     <span class="comment">% nchoosek(M,y)*nchoosek(N-M,n-y) / nchoosek(N,n)</span>
2296                     t=pmode;
2297                     ii = mode+1;
2298                     <span class="keyword">while</span> t*2147483648 &gt; 1
2299                          t = t * (M-ii+1)/(ii) *(n-ii+1)/(N-M-n+ii);
2300                          ii = ii + 1;
2301                     <span class="keyword">end</span> 
2302                     last=ii-2;
2303                                    
2304                     t=pmode;
2305                     j=-1;
2306                     <span class="keyword">for</span> ii=mode-1:-1:0 
2307                          t = t * (ii+1)/(M-ii) *(N-M-n+ii+1)/(n-ii);
2308                          <span class="keyword">if</span> t*2147483648 &lt; 1
2309                               j=ii;
2310                               <span class="keyword">break</span>;
2311                          <span class="keyword">end</span>
2312                     <span class="keyword">end</span>                    
2313                     offset=j+1;
2314                     sizeP=last-offset+1;
2315 
2316                     P = zeros(1, sizeP);
2317 
2318                     ii = (mode+1):last;
2319                     P(mode-offset+1:last-offset+1) = round( 2^30*pmode*cumprod([1, (M-ii+1)./(ii).*(n-ii+1)./(N-M-n+ii)] ) );
2320                     
2321                     ii = (mode-1):-1:offset;
2322                     P(mode-offset:-1:1) = round( 2^30*pmode*cumprod((ii+1)./(M-ii).*(N-M-n+ii+1)./(n-ii)) );
2323                              
2324                     out = <a href="#_sub6" class="code" title="subfunction out = randFrom5Tbls( P, offset, sampleSize)">randFrom5Tbls</a>( P, offset, sampleSize);
2325                        
2326                                    
2327                <span class="keyword">case</span> {<span class="string">'ig'</span>, <span class="string">'inversegauss'</span>, <span class="string">'invgauss'</span>}                   
2328                     <span class="comment">%</span>
2329                     <span class="comment">% START ig HELP START inversegauss HELP  START invgauss HELP</span>
2330                     <span class="comment">% THE INVERSE GAUSSIAN DISTRIBUTION</span>
2331                     <span class="comment">%</span>
2332                     <span class="comment">% The Inverse Gaussian distribution is left skewed distribution whose</span>
2333                     <span class="comment">% location is set by the mean with the profile determined by the</span>
2334                     <span class="comment">% scale factor.  The random variable can take a value between zero and</span>
2335                     <span class="comment">% infinity.  The skewness increases rapidly with decreasing values of</span>
2336                     <span class="comment">% the scale parameter.</span>
2337                     <span class="comment">%</span>
2338                     <span class="comment">%</span>
2339                     <span class="comment">% pdf(y) = sqrt(chi/(2*pi*y^3)) * exp(-chi./(2*y).*(y/theta-1).^2);</span>
2340                     <span class="comment">% cdf(y) = normcdf(sqrt(chi./y).*(y/theta-1)) + ...</span>
2341                     <span class="comment">%            exp(2*chi/theta)*normcdf(sqrt(chi./y).*(-y/theta-1));</span>
2342                     <span class="comment">%</span>
2343                     <span class="comment">%   where  normcdf(x) = 0.5*(1+erf(y/sqrt(2))); is the standard normal CDF</span>
2344                     <span class="comment">%</span>
2345                     <span class="comment">% Mean     = theta;</span>
2346                     <span class="comment">% Variance = theta^3/chi;</span>
2347                     <span class="comment">% Skewness = sqrt(9*theta/chi);</span>
2348                     <span class="comment">% Kurtosis = 15*mean/scale;</span>
2349                     <span class="comment">% Mode = theta/(2*chi)*(sqrt(9*theta^2+4*chi^2)-3*theta);</span>
2350                     <span class="comment">%</span>
2351                     <span class="comment">% PARAMETERS:</span>
2352                     <span class="comment">%  theta - location; (theta&gt;0)</span>
2353                     <span class="comment">%  chi - scale; (chi&gt;0)</span>
2354                     <span class="comment">%</span>
2355                     <span class="comment">% SUPPORT:</span>
2356                     <span class="comment">%  y,  y&gt;0</span>
2357                     <span class="comment">%</span>
2358                     <span class="comment">% CLASS:</span>
2359                     <span class="comment">%   Continuous skewed distribution</span>
2360                     <span class="comment">%</span>
2361                     <span class="comment">% NOTES:</span>
2362                     <span class="comment">%   1. There are several alternate forms for the PDF,</span>
2363                     <span class="comment">%      some of which have more than two parameters</span>
2364                     <span class="comment">%   2. The Inverse Gaussian distribution is often called the Inverse Normal</span>
2365                     <span class="comment">%   3. Wald distribution is a special case of The Inverse Gaussian distribution</span>
2366                     <span class="comment">%      where the mean is a constant with the value one.</span>
2367                     <span class="comment">%   4. The Inverse Gaussian distribution is a special case of The Generalized</span>
2368                     <span class="comment">%        Hyperbolic Distribution</span>
2369                     <span class="comment">%</span>
2370                     <span class="comment">% USAGE:</span>
2371                     <span class="comment">%   randraw('ig', [theta, chi], sampleSize) - generate sampleSize number</span>
2372                     <span class="comment">%         of variates from the Inverse Gaussian distribution with</span>
2373                     <span class="comment">%         parameters theta and chi;</span>
2374                     <span class="comment">%   randraw('ig') - help for the Inverse Gaussian distribution;</span>
2375                     <span class="comment">%</span>
2376                     <span class="comment">% EXAMPLES:</span>
2377                     <span class="comment">%  1.   y = randraw('ig', [0.1, 1], [1 1e5]);</span>
2378                     <span class="comment">%  2.   y = randraw('ig', [3.2, 10], 1, 1e5);</span>
2379                     <span class="comment">%  3.   y = randraw('ig', [100.2, 6], 1e5 );</span>
2380                     <span class="comment">%  4.   y = randraw('ig', [10, 10.5], [1e5 1] );</span>
2381                     <span class="comment">%  5.   randraw('ig');</span>
2382                     <span class="comment">%</span>
2383                     <span class="comment">% SEE ALSO:</span>
2384                     <span class="comment">%   WALD distribution</span>
2385                     <span class="comment">% END ig HELP END inversegauss HELP  END invgauss HELP</span>
2386                     
2387                     <span class="comment">% Method:</span>
2388                     <span class="comment">%</span>
2389                     <span class="comment">% There is an efficient procedure that utilizes a transformation</span>
2390                     <span class="comment">% yielding two roots.</span>
2391                     <span class="comment">% If Y is Inverse Gauss random variable, then following to [1]</span>
2392                     <span class="comment">% we can write:</span>
2393                     <span class="comment">% V = chi*(Y-theta)^2/(Y*theta^2) ~ Chi-Square(1),</span>
2394                     <span class="comment">%</span>
2395                     <span class="comment">% i.e. V is distributed as a chi-square random variable with</span>
2396                     <span class="comment">% one degree of freedom.</span>
2397                     <span class="comment">% So it can be simply generated by taking a square of a</span>
2398                     <span class="comment">% standard normal random number.</span>
2399                     <span class="comment">% Solving this equation for Y yields two roots:</span>
2400                     <span class="comment">%</span>
2401                     <span class="comment">% y1 = theta + 0.5*theta/chi * ( theta*V - sqrt(4*theta*chi*V + ...</span>
2402                     <span class="comment">%      theta^2*V.^2) );</span>
2403                     <span class="comment">% and</span>
2404                     <span class="comment">% y2 = theta^2/y1;</span>
2405                     <span class="comment">%</span>
2406                     <span class="comment">% In [2] showed that  Y can be simulated by choosing y1 with probability</span>
2407                     <span class="comment">% theta/(theta+y1) and y2 with probability 1-theta/(theta+y1)</span>
2408                     <span class="comment">%</span>
2409                     <span class="comment">% References:</span>
2410                     <span class="comment">% [1] Shuster, J. (1968). On the Inverse Gaussian Distribution Function,</span>
2411                     <span class="comment">%         Journal of the American Statistical Association 63: 1514-1516.</span>
2412                     <span class="comment">%</span>
2413                     <span class="comment">% [2] Michael, J.R., Schucany, W.R. and Haas, R.W. (1976).</span>
2414                     <span class="comment">%     Generating Random Variates Using Transformations with Multiple Roots,</span>
2415                     <span class="comment">%     The American Statistician 30: 88-90.</span>
2416                     <span class="comment">%</span>
2417                     <span class="comment">%</span>
2418 
2419                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Inverse Gaussian'</span>, <span class="string">'ig'</span>, distribParams, [2]);
2420                     theta = distribParams(1);
2421                     chi = distribParams(2);
2422                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Inverse Gaussian'</span>, <span class="string">'ig'</span>, <span class="string">'[theta, chi]'</span>, <span class="string">'theta'</span>, theta, {<span class="string">'&gt; 0'</span>});
2423                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Inverse Gaussian'</span>, <span class="string">'ig'</span>, <span class="string">'[theta, chi]'</span>, <span class="string">'chi'</span>, chi, {<span class="string">'&gt; 0'</span>});
2424 
2425                     chisq1 = randn(sampleSize).^2;
2426                     out = theta + 0.5*theta/chi * ( theta*chisq1 - <span class="keyword">...</span>
2427                          sqrt(4*theta*chi*chisq1 + theta^2*chisq1.^2) );
2428 
2429                     l = rand(sampleSize) &gt;= theta./(theta+out);
2430                     out( l ) = theta^2./out( l );
2431 
2432                <span class="keyword">case</span> {<span class="string">'laplace'</span> <span class="string">'doubleexponential'</span>, <span class="string">'doubleexp'</span>, <span class="string">'bilateralexponential'</span>, <span class="string">'bilateralexp'</span>}
2433                     <span class="comment">% START laplace HELP START doubleexponential HELP START doubleexp HELP START bilateralexponential HELP START bilateralexp HELP</span>
2434                     <span class="comment">% THE LAPLACE DISTRIBUTION</span>
2435                     <span class="comment">% (sometimes: double-exponential or bilateral exponential distribution)</span>
2436                     <span class="comment">%</span>
2437                     <span class="comment">% pdf = 1/(2*lam)*exp(-abs(y-theta)/lam);</span>
2438                     <span class="comment">% cdf = (y&lt;=theta) .* 1/2*exp((y-theta)/lam) + (y&gt;theta) .* (1 - 1/2*exp((theta-y)/lam));</span>
2439                     <span class="comment">%</span>
2440                     <span class="comment">% Mean = Median = Mode = theta;</span>
2441                     <span class="comment">% Variance = 2*lam^2;</span>
2442                     <span class="comment">% Skewness = 0;</span>
2443                     <span class="comment">% Kurtosis = 3;</span>
2444                     <span class="comment">%</span>
2445                     <span class="comment">% PARAMETERS:</span>
2446                     <span class="comment">%   theta  - location</span>
2447                     <span class="comment">%   lam   -  scale  (lam&gt;0)</span>
2448                     <span class="comment">%</span>
2449                     <span class="comment">% SUPPORT:</span>
2450                     <span class="comment">%   y ,   -Inf &lt; y &lt; Inf</span>
2451                     <span class="comment">%</span>
2452                     <span class="comment">% CLASS:</span>
2453                     <span class="comment">%   Continuous symmetric distribution</span>
2454                     <span class="comment">%</span>
2455                     <span class="comment">% USAGE:</span>
2456                     <span class="comment">%   randraw('laplace', [], sampleSize) - generate sampleSize number</span>
2457                     <span class="comment">%         of variates from the Laplace distribution with</span>
2458                     <span class="comment">%         loaction parameter theta=0 and scale parameter lam=1;</span>
2459                     <span class="comment">%   randraw('laplace', [theta, lam], sampleSize) - generate sampleSize number</span>
2460                     <span class="comment">%         of variates from the Laplace distribution with</span>
2461                     <span class="comment">%         loaction parameter theta and scale parameter lam;</span>
2462                     <span class="comment">%   randraw('laplace') - help for the Laplace distribution;</span>
2463                     <span class="comment">%</span>
2464                     <span class="comment">% EXAMPLES:</span>
2465                     <span class="comment">%  1.   y = randraw('laplace', [0, 1], [1 1e5]);</span>
2466                     <span class="comment">%  2.   y = randraw('laplace', [3.2, 10], 1, 1e5);</span>
2467                     <span class="comment">%  3.   y = randraw('laplace', [100.2, 6], 1e5 );</span>
2468                     <span class="comment">%  4.   y = randraw('laplace', [10, 10.5], [1e5 1] );</span>
2469                     <span class="comment">%  5.   randraw('laplace');</span>
2470                     <span class="comment">% END laplace HELP END doubleexponential HELP END doubleexp HELP END bilateralexponential HELP END bilateralexp HELP</span>
2471 
2472                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Laplace'</span>, <span class="string">'laplace'</span>, distribParams, [0, 2]);
2473                     <span class="keyword">if</span> numel(distribParams)==2
2474                          theta  = distribParams(1);
2475                          lam  = distribParams(2);
2476                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Laplace'</span>, <span class="string">'laplace'</span>, <span class="string">'[theta, lam]'</span>, <span class="string">'lam'</span>, lam, {<span class="string">'&gt; 0'</span>});
2477                     <span class="keyword">else</span>
2478                          theta = 0;
2479                          lam = 1;
2480                     <span class="keyword">end</span>
2481                     
2482                     u = rand( sampleSize );
2483                     out = zeros( sampleSize );
2484                     out(u&lt;=0.5) = theta + lam*log(2*u(u&lt;=0.5));
2485                     out(u&gt;0.5) = theta - lam*log(2*(1-u(u&gt;0.5)));
2486                     
2487                <span class="keyword">case</span> {<span class="string">'logistic'</span>}
2488                     <span class="comment">% START logistic HELP</span>
2489                     <span class="comment">% THE LOGISTIC DISTRIBUTION</span>
2490                     <span class="comment">%   The logistic distribution is a symmetrical bell shaped distribution.</span>
2491                     <span class="comment">%   One of its applications is an alternative to the Normal distribution</span>
2492                     <span class="comment">%   when a higher proportion of the population being modeled is</span>
2493                     <span class="comment">%   distributed in the tails.</span>
2494                     <span class="comment">%</span>
2495                     <span class="comment">%  pdf(y) = exp((y-a)/k)./(k*(1+exp((y-a)/k)).^2);</span>
2496                     <span class="comment">%  cdf(y) = 1 ./ (1+exp(-(y-a)/k))</span>
2497                     <span class="comment">%</span>
2498                     <span class="comment">%  Mean = a;</span>
2499                     <span class="comment">%  Variance = k^2*pi^2/3;</span>
2500                     <span class="comment">%  Skewness = 0;</span>
2501                     <span class="comment">%  Kurtosis = 1.2;</span>
2502                     <span class="comment">%</span>
2503                     <span class="comment">% PARAMETERS:</span>
2504                     <span class="comment">%  a - location;</span>
2505                     <span class="comment">%  k - scale (k&gt;0);</span>
2506                     <span class="comment">%</span>
2507                     <span class="comment">% SUPPORT:</span>
2508                     <span class="comment">%   y,  -Inf &lt; y &lt; Inf</span>
2509                     <span class="comment">%</span>
2510                     <span class="comment">% CLASS:</span>
2511                     <span class="comment">%   Continuous symmetric distribution</span>
2512                     <span class="comment">%</span>
2513                     <span class="comment">% USAGE:</span>
2514                     <span class="comment">%   randraw('logistic', [], sampleSize) - generate sampleSize number</span>
2515                     <span class="comment">%         of variates from the standard Logistic distribution with</span>
2516                     <span class="comment">%         loaction parameter a=0 and scale parameter k=1;</span>
2517                     <span class="comment">%   randraw('logistic', [a, k], sampleSize) - generate sampleSize number</span>
2518                     <span class="comment">%         of variates from the Logistic distribution with</span>
2519                     <span class="comment">%         loaction parameter 'a' and scale parameter 'k';</span>
2520                     <span class="comment">%   randraw('logistic') - help for the Logistic distribution;</span>
2521                     <span class="comment">%</span>
2522                     <span class="comment">% EXAMPLES:</span>
2523                     <span class="comment">%  1.   y = randraw('logistic', [], [1 1e5]);</span>
2524                     <span class="comment">%  2.   y = randraw('logistic', [0, 4], 1, 1e5);</span>
2525                     <span class="comment">%  3.   y = randraw('logistic', [-1, 10.2], 1e5 );</span>
2526                     <span class="comment">%  4.   y = randraw('logistic', [3.2, 0.3], [1e5 1] );</span>
2527                     <span class="comment">%  5.   randraw('logistic');</span>
2528                     <span class="comment">% END logistic HELP</span>
2529                     
2530                     <span class="comment">% Method:</span>
2531                     <span class="comment">%</span>
2532                     <span class="comment">% Inverse CDF transformation method.</span>
2533 
2534                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Logistic'</span>, <span class="string">'logistic'</span>, distribParams, [0, 2]);
2535                     <span class="keyword">if</span> numel(distribParams)==2
2536                          a  = distribParams(1);
2537                          k  = distribParams(2);
2538                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Laplace'</span>, <span class="string">'laplace'</span>, <span class="string">'[a, k]'</span>, <span class="string">'k'</span>, k, {<span class="string">'&gt; 0'</span>});
2539                     <span class="keyword">else</span>
2540                          a = 0;
2541                          k = 1;
2542                     <span class="keyword">end</span>
2543 
2544                     u1 = rand( sampleSize );
2545                     out = a - k*log( 1./u1 - 1 );
2546 
2547                <span class="keyword">case</span> { <span class="string">'lognorm'</span>, <span class="string">'lognormal'</span>, <span class="string">'cobbdouglas'</span>, <span class="string">'antilognormal'</span> }
2548                     <span class="comment">% START lognorm HELP START lognormal HELP START cobbdouglas HELP START antilognormal HELP</span>
2549                     <span class="comment">% THE LOG-NORMAL DISTRIBUTION</span>
2550                     <span class="comment">% (sometimes: Cobb-Douglas or antilognormal distribution)</span>
2551                     <span class="comment">%</span>
2552                     <span class="comment">% pdf = 1/(k*sqrt(2*pi)) * exp(-1/2*((log(y)-a)/k)^2)</span>
2553                     <span class="comment">% cdf = 1/2*(1 + erf((log(y)-a)/(k*sqrt(2))));</span>
2554                     <span class="comment">%</span>
2555                     <span class="comment">% Mean = exp( a + k^2/2 );</span>
2556                     <span class="comment">% Variance = exp(2*a+k^2)*( exp(k^2)-1 );</span>
2557                     <span class="comment">% Skewness = (exp(1)+2)*sqrt(exp(1)-1), for a=0 and k=1;</span>
2558                     <span class="comment">% Kurtosis = exp(4) + 2*exp(3) + 3*exp(2) - 6; for a=0 and k=1;</span>
2559                     <span class="comment">% Mode = exp(a-k^2);</span>
2560                     <span class="comment">%</span>
2561                     <span class="comment">% PARAMETERS:</span>
2562                     <span class="comment">%  a - location</span>
2563                     <span class="comment">%  k - scale (k&gt;0)</span>
2564                     <span class="comment">%</span>
2565                     <span class="comment">% SUPPORT:</span>
2566                     <span class="comment">%   y,  y&gt;0</span>
2567                     <span class="comment">%</span>
2568                     <span class="comment">% CLASS:</span>
2569                     <span class="comment">%   Continuous skewed distribution</span>
2570                     <span class="comment">%</span>
2571                     <span class="comment">% NOTES:</span>
2572                     <span class="comment">%  1) The LogNormal distribution is always right-skewed</span>
2573                     <span class="comment">%  2) Parameters a and k are the mean and standard deviation</span>
2574                     <span class="comment">%     of y in (natural) log space.</span>
2575                     <span class="comment">%</span>
2576                     <span class="comment">% USAGE:</span>
2577                     <span class="comment">%   randraw('lognorm', [], sampleSize) - generate sampleSize number</span>
2578                     <span class="comment">%         of variates from the standard Lognormal distribution with</span>
2579                     <span class="comment">%         loaction parameter a=0 and scale parameter k=1;</span>
2580                     <span class="comment">%   randraw('lognorm', [a, k], sampleSize) - generate sampleSize number</span>
2581                     <span class="comment">%         of variates from the Lognormal distribution with</span>
2582                     <span class="comment">%         loaction parameter 'a' and scale parameter 'k';</span>
2583                     <span class="comment">%   randraw('lognorm') - help for the Lognormal distribution;</span>
2584                     <span class="comment">%</span>
2585                     <span class="comment">% EXAMPLES:</span>
2586                     <span class="comment">%  1.   y = randraw('lognorm', [], [1 1e5]);</span>
2587                     <span class="comment">%  2.   y = randraw('lognorm', [0, 4], 1, 1e5);</span>
2588                     <span class="comment">%  3.   y = randraw('lognorm', [-1, 10.2], 1e5 );</span>
2589                     <span class="comment">%  4.   y = randraw('lognorm', [3.2, 0.3], [1e5 1] );</span>
2590                     <span class="comment">%  5.   randraw('lognorm');</span>
2591                     <span class="comment">%END lognorm HELP END lognormal HELP END cobbdouglas HELP END antilognormal HELP</span>
2592                     
2593                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Lognormal'</span>, <span class="string">'lognorm'</span>, distribParams, [0, 2]);
2594                     <span class="keyword">if</span> numel(distribParams)==2
2595                          a  = distribParams(1);
2596                          k  = distribParams(2);
2597                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Lognormal'</span>, <span class="string">'lognorm'</span>, <span class="string">'[a, k]'</span>, <span class="string">'k'</span>, k, {<span class="string">'&gt; 0'</span>});
2598                     <span class="keyword">else</span>
2599                          a = 0;
2600                          k = 1;
2601                     <span class="keyword">end</span>
2602 
2603                     out = exp( a + k * randn( sampleSize ) );
2604 
2605                <span class="keyword">case</span> {<span class="string">'maxwell'</span>}
2606                     <span class="comment">% START maxwell HELP</span>
2607                     <span class="comment">% THE MAXWELL DISTRIBUTION</span>
2608                     <span class="comment">%</span>
2609                     <span class="comment">% pdf(y) = 1/a^3 * sqrt(2/pi) * y.^2 * exp(-y.^2/(2*a^2));  a &gt; 0, y &gt;= 0</span>
2610                     <span class="comment">% cdf(y) = gammainc(3/2, y.^2/(2*a^2));</span>
2611                     <span class="comment">%</span>
2612                     <span class="comment">% Mean     = 2*a*sqrt(2/pi);</span>
2613                     <span class="comment">% Variance = a^2*(3-8/pi);</span>
2614                     <span class="comment">% Skewness = 2*(16/pi-5)*sqrt(2/pi) / (3-8/pi)^(3/2) = 0.48569282804959</span>
2615                     <span class="comment">% Kurtosis = (15-8/pi)/(3-8/pi)^2 - 3 ???</span>
2616                     <span class="comment">%</span>
2617                     <span class="comment">% PARAMETERS:</span>
2618                     <span class="comment">%   a - scale parameter (a &gt; 0)</span>
2619                     <span class="comment">%</span>
2620                     <span class="comment">% SUPPORT:</span>
2621                     <span class="comment">%   y, y &gt;= 0</span>
2622                     <span class="comment">%</span>
2623                     <span class="comment">% CLASS:</span>
2624                     <span class="comment">%   Continuous skewed distribution</span>
2625                     <span class="comment">%</span>
2626                     <span class="comment">% NOTES:</span>
2627                     <span class="comment">%  The distribution of speeds of molecules in thermal equilibrium as given by</span>
2628                     <span class="comment">%  statistical mechanics and named after the famous scottish physicist James</span>
2629                     <span class="comment">%  Clerk Maxwell (1831-1879).</span>
2630                     <span class="comment">%</span>
2631                     <span class="comment">% USAGE:</span>
2632                     <span class="comment">%   randraw('maxwell', a, sampleSize) - generate sampleSize number</span>
2633                     <span class="comment">%         of variates from the Maxwell distribution with</span>
2634                     <span class="comment">%         scale parameter 'a';</span>
2635                     <span class="comment">%   randraw('maxwell') - help for the Maxwell distribution;</span>
2636                     <span class="comment">%</span>
2637                     <span class="comment">% EXAMPLES:</span>
2638                     <span class="comment">%  1.   y = randraw('maxwell', 1.1, [1 1e5]);</span>
2639                     <span class="comment">%  2.   y = randraw('maxwell', 0.5, 1, 1e5);</span>
2640                     <span class="comment">%  3.   y = randraw('maxwell', 10, 1e5 );</span>
2641                     <span class="comment">%  4.   y = randraw('maxwell', 5.5, [1e5 1] );</span>
2642                     <span class="comment">%  5.   randraw('maxwell');</span>
2643                     <span class="comment">% END maxwell HELP</span>
2644                     
2645                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Maxwell'</span>, <span class="string">'maxwell'</span>, distribParams, [1]);
2646                     a  = distribParams(1);
2647                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Maxwell'</span>, <span class="string">'maxwell'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, a, {<span class="string">'&gt; 0'</span>});
2648 
2649                     out = sqrt( randn(sampleSize).^2 + randn(sampleSize).^2 + <span class="keyword">...</span>
2650                          randn(sampleSize).^2 ) * a;
2651 
2652                <span class="keyword">case</span> {<span class="string">'negativebinomial'</span>, <span class="string">'negbinomial'</span>, <span class="string">'negbinom'</span>, <span class="string">'pascal'</span>}
2653                     <span class="comment">% START negbinom HELP START pascal HELP</span>
2654                     <span class="comment">% THE NEGATIVE BINOMIAL DISTRIBUTION</span>
2655                     <span class="comment">%  ( sometimes: Pascal distribution )</span>
2656                     <span class="comment">%</span>
2657                     <span class="comment">% Negative Binomial (also known as the Pascal or Polya) distribution</span>
2658                     <span class="comment">% gives the probability of r-1 successes and y failures in y+r-1 trials</span>
2659                     <span class="comment">% and success on the (y+r)'th trial (if r is positive integer )</span>
2660                     <span class="comment">%</span>
2661                     <span class="comment">%  pdf(y) = gamma(r+y)./(gamma(y+1)*gamma(r)) * p^r * (1-p)^y = ...</span>
2662                     <span class="comment">%           exp( gammaln(r+y) - gammaln(y+1) - gammaln(r) + r*log(p) + y*log(1-p) );</span>
2663                     <span class="comment">%              y&gt;=0</span>
2664                     <span class="comment">%</span>
2665                     <span class="comment">%  Mode = (r&gt;1)*floor( (r-1)*(1-p)/p ) + (r&lt;=1)*0;</span>
2666                     <span class="comment">%  Mean = r*(1-p)/p;</span>
2667                     <span class="comment">%  Variance = r*(1-p)/p^2;</span>
2668                     <span class="comment">%  Skewness = (2-p) / sqrt(r*(1-p));</span>
2669                     <span class="comment">%  Kurtosis = (p^2-6*p+6)/(r*(1-p));</span>
2670                     <span class="comment">%</span>
2671                     <span class="comment">%  PARAMETERS:</span>
2672                     <span class="comment">%      r&gt;0;</span>
2673                     <span class="comment">%      p - probability of success in a single trial ( 0&lt; p &lt;1 );</span>
2674                     <span class="comment">%</span>
2675                     <span class="comment">%  SUPPORT:</span>
2676                     <span class="comment">%      y = 0, 1, 2, 3, ...</span>
2677                     <span class="comment">%</span>
2678                     <span class="comment">% CLASS:</span>
2679                     <span class="comment">%   Discrete distribution</span>
2680                     <span class="comment">%</span>
2681                     <span class="comment">% USAGE:</span>
2682                     <span class="comment">%   randraw('negbinom', [r, p], sampleSize) - generate sampleSize number</span>
2683                     <span class="comment">%         of variates from the Negative Binomial distribution with</span>
2684                     <span class="comment">%        parameters 'r' and 'p';</span>
2685                     <span class="comment">%   randraw('negbinom') - help for the Negative Binomial distribution;</span>
2686                     <span class="comment">%</span>
2687                     <span class="comment">% EXAMPLES:</span>
2688                     <span class="comment">%  1.   y = randraw('negbinom', [10 0.2], [1 1e5]);</span>
2689                     <span class="comment">%  2.   y = randraw('negbinom', [100, 0.9], 1, 1e5);</span>
2690                     <span class="comment">%  3.   y = randraw('negbinom', [20 0.1], 1e5 );</span>
2691                     <span class="comment">%  4.   y = randraw('negbinom', [30 0.99], [1e5 1] );</span>
2692                     <span class="comment">%  5.   randraw('negbinom');</span>
2693                     <span class="comment">% END negbinom HELP END pascal HELP</span>
2694                     
2695                     <span class="comment">% Method:</span>
2696                     <span class="comment">%</span>
2697                     <span class="comment">% We implemented Condensed Table-Lookup method suggested in</span>
2698                     <span class="comment">%    George Marsaglia, &quot;Fast Generation Of Discrete Random Variables,&quot;</span>
2699                     <span class="comment">%    Journal of Statistical Software, July 2004, Volume 11, Issue 4</span>
2700                     
2701                     <span class="comment">% pdf = exp( gammaln(r+y) - gammaln(y+1) - gammaln(r) + r*log(p) + y*log(1-p) );</span>
2702 
2703                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Negative Binomial'</span>, <span class="string">'negbinom'</span>, distribParams, [2]);                                        
2704                     r = distribParams(1);
2705                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Negative Binomial'</span>, <span class="string">'negbinom'</span>, <span class="string">'[r, p]'</span>, <span class="string">'r'</span>, r, {<span class="string">'&gt; 0'</span>});
2706                     p = distribParams(2);
2707                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Negative Binomial'</span>, <span class="string">'negbinom'</span>, <span class="string">'[r, p]'</span>, <span class="string">'p'</span>, p, {<span class="string">'&gt; 0'</span>,<span class="string">'&lt; 1'</span>});
2708                     
2709                     q = 1 - p;
2710 
2711                     <span class="keyword">if</span> r*q/p^2 &gt; 1e8
2712                          out = 1/p * feval(funcName, <span class="string">'gamma'</span>, r*(1-p), sampleSize);
2713                     <span class="keyword">else</span>
2714                          mode = (r&gt;1)*floor( (r-1)*(1-p)/p ) + (r&lt;=1)*0;
2715                          pmode = exp( gammaln(r+mode) - gammaln(mode+1) - gammaln(r) + <span class="keyword">...</span>
2716                               r*log(p) + mode*log(1-p) );
2717 
2718                          t=pmode;
2719                          ii = mode+1;
2720                          <span class="keyword">while</span> t*2147483648 &gt; 1
2721                               t = t * (r+ii-1)/ii * q;
2722                               ii = ii + 1;
2723                          <span class="keyword">end</span>
2724                          last=ii-2;
2725 
2726                          t=pmode;
2727                          j=-1;
2728                          <span class="keyword">for</span> ii=mode-1:-1:0
2729                               t = t * (ii+1)/(r+ii)/q;
2730                               <span class="keyword">if</span> t*2147483648 &lt; 1
2731                                    j=ii;
2732                                    <span class="keyword">break</span>;
2733                               <span class="keyword">end</span>
2734                          <span class="keyword">end</span>
2735                          offset=j+1;
2736                          sizeP=last-offset+1;
2737 
2738                          P = zeros(1, sizeP);
2739 
2740                          ii = (mode+1):last;
2741                          P(mode-offset+1:last-offset+1) = round( 2^30*pmode*cumprod([1, (r+ii-1)./ii * q] ) );
2742 
2743                          ii = (mode-1):-1:offset;
2744                          P(mode-offset:-1:1) = round( 2^30*pmode*cumprod((ii+1)./(r+ii)/q) );
2745 
2746                          out = <a href="#_sub6" class="code" title="subfunction out = randFrom5Tbls( P, offset, sampleSize)">randFrom5Tbls</a>( P, offset, sampleSize);                   
2747                     <span class="keyword">end</span>
2748                     
2749                <span class="keyword">case</span> {<span class="string">'normal'</span>, <span class="string">'gaussian'</span>, <span class="string">'gauss'</span>, <span class="string">'norm'</span>} <span class="comment">% Gaussian distribution</span>
2750                     <span class="comment">% START normal HELP START gaussian HELP START gauss HELP START norm HELP</span>
2751                     <span class="comment">% THE NORMAL DISTRIBUTION</span>
2752                     <span class="comment">% Standard form of the Normal distribution:</span>
2753                     <span class="comment">%   pdf(y) = 1/sqrt(2*pi) * exp(-1/2*y.^2);</span>
2754                     <span class="comment">%   cdf(y) = 0.5*(1+erf(y/sqrt(2)));</span>
2755                     <span class="comment">%</span>
2756                     <span class="comment">% Mean = 0;</span>
2757                     <span class="comment">% Variance = 1;</span>
2758                     <span class="comment">%</span>
2759                     <span class="comment">% General form of the Normal distribution:</span>
2760                     <span class="comment">%   pdf(y) = 1/(sigma*sqrt(2*pi)) * exp(-1/2*((y-mu)/sigma).^2);</span>
2761                     <span class="comment">%   cdf(y) = 1/2*(1+erf((y-mu)/(sigma*sqrt(2))));</span>
2762                     <span class="comment">%</span>
2763                     <span class="comment">% Mean = mu;</span>
2764                     <span class="comment">% Variance = sigma^2;</span>
2765                     <span class="comment">%</span>
2766                     <span class="comment">% PARAMETERS:</span>
2767                     <span class="comment">%  mu      - location (mean)</span>
2768                     <span class="comment">%  sigma&gt;0 - scale (std)</span>
2769                     <span class="comment">%</span>
2770                     <span class="comment">% SUPPORT:</span>
2771                     <span class="comment">%  y,   -Inf &lt; y &lt; Inf</span>
2772                     <span class="comment">%</span>
2773                     <span class="comment">% CLASS:</span>
2774                     <span class="comment">%   Continuous symmetric distributions</span>
2775                     <span class="comment">%</span>
2776                     <span class="comment">% USAGE:</span>
2777                     <span class="comment">%   randraw('norm', [], sampleSize) - generate sampleSize number</span>
2778                     <span class="comment">%         of variates from the standard Normal distribution;</span>
2779                     <span class="comment">%   randraw('norm', [a, k], sampleSize) - generate sampleSize number</span>
2780                     <span class="comment">%         of variates from the Normal distribution with</span>
2781                     <span class="comment">%         mean 'mu' and std 'sigma';</span>
2782                     <span class="comment">%   randraw('norm') - help for the Lognormal distribution;</span>
2783                     <span class="comment">%</span>
2784                     <span class="comment">% EXAMPLES:</span>
2785                     <span class="comment">%  1.   y = randraw('norm', [], [1 1e5]);</span>
2786                     <span class="comment">%  2.   y = randraw('norm', [0, 4], 1, 1e5);</span>
2787                     <span class="comment">%  3.   y = randraw('norm', [-1, 10.2], 1e5 );</span>
2788                     <span class="comment">%  4.   y = randraw('norm', [3.2, 0.3], [1e5 1] );</span>
2789                     <span class="comment">%  5.   randraw('norm');</span>
2790                     <span class="comment">% END normal HELP END gaussian HELP END gauss HELP END norm HELP</span>
2791                     
2792                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Normal'</span>, <span class="string">'normal'</span>, distribParams, [0, 2]);
2793                     
2794                     <span class="keyword">if</span> numel(distribParams)==2
2795                          mu = distribParams(1);
2796                          sigma = distribParams(2);
2797                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Normal'</span>, <span class="string">'normal'</span>, <span class="string">'[mu, sigma]'</span>, <span class="string">'sigma'</span>, sigma, {<span class="string">'&gt; 0'</span>});
2798                     <span class="keyword">else</span>
2799                          mu = 0;
2800                          sigma = 1;
2801                     <span class="keyword">end</span>
2802 
2803                     out = mu + sigma * randn( sampleSize );
2804 
2805                <span class="keyword">case</span> {<span class="string">'normaltrunc'</span>, <span class="string">'normaltruncated'</span>, <span class="string">'gausstrunc'</span>}
2806                     <span class="comment">% START normaltrunc HELP START normaltruncated HELP START gausstrunc HELP</span>
2807                     <span class="comment">% THE TRUNCATED NORMAL DISTRIBUTION</span>
2808                     <span class="comment">%</span>
2809                     <span class="comment">%   pdf(y) = normpdf((y-mu)/sigma) / (sigma*(normcdf((b-mu)/sigma)-normcdf((a-mu)/sigma))); a&lt;=y&lt;=b;</span>
2810                     <span class="comment">%   cdf(y) = (normcdf((y-mu)/sigma)-normcdf((a-mu)/sigma)) / (normcdf((b-mu)/sigma)-normcdf((a-mu)/sigma)); a&lt;=y&lt;=b;</span>
2811                     <span class="comment">%      where mu and sigma are the mean and standard deviation of the parent normal</span>
2812                     <span class="comment">%            distribution and a and b are the lower and upper truncation points.</span>
2813                     <span class="comment">%            normpdf and normcdf are the PDF and CDF for the standard normal distribution respectvely</span>
2814                     <span class="comment">%            ( run randraw('normal') for help).</span>
2815                     <span class="comment">%</span>
2816                     <span class="comment">%</span>
2817                     <span class="comment">% PARAMETERS:</span>
2818                     <span class="comment">%   a  - lower truncation point;</span>
2819                     <span class="comment">%   b  - upper truncation point; (b&gt;=a)</span>
2820                     <span class="comment">%   mu - Mean of the parent normal distribution</span>
2821                     <span class="comment">%   sigma - standard deviation of the parent normal distribution (sigma&gt;0)</span>
2822                     <span class="comment">%</span>
2823                     <span class="comment">%</span>
2824                     <span class="comment">% SUPPORT:</span>
2825                     <span class="comment">%   y,   a &lt;= y &lt;= b</span>
2826                     <span class="comment">%</span>
2827                     <span class="comment">% CLASS:</span>
2828                     <span class="comment">%   Continuous distributions</span>
2829                     <span class="comment">%</span>
2830                     <span class="comment">% USAGE:</span>
2831                     <span class="comment">%   randraw('normaltrunc', [a, b, mu, sigma], sampleSize) - generate sampleSize number</span>
2832                     <span class="comment">%         of variates from Truncated Normal distribution on the interval (a, b) with</span>
2833                     <span class="comment">%         parameters 'mu' and  'sigma';</span>
2834                     <span class="comment">%   randraw('normaltrunc') - help for Truncated Normal distribution;</span>
2835                     <span class="comment">%</span>
2836                     <span class="comment">% EXAMPLES:</span>
2837                     <span class="comment">%  1.   y = randraw('normaltrunc', [0, 1, 0, 1], [1 1e5]);</span>
2838                     <span class="comment">%  2.   y = randraw('normaltrunc', [0, 1, 10, 3], 1, 1e5);</span>
2839                     <span class="comment">%  3.   y = randraw('normaltrunc', [-10, 10, 0, 1], 1e5 );</span>
2840                     <span class="comment">%  4.   y = randraw('normaltrunc', [-13.1, 15.2, 20.1, 3.3], [1e5 1] );</span>
2841                     <span class="comment">%  5.   randraw('normaltrunc');</span>
2842                     <span class="comment">% END normaltrunc HELP END normaltruncated HELP END gausstrunc HELP</span>
2843                     
2844                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Truncated Normal'</span>, <span class="string">'normaltrunc'</span>, distribParams, [4]);
2845                     
2846                     a = distribParams(1);
2847                     b = distribParams(2);
2848                     mu = distribParams(3);
2849                     sigma = distribParams(4);
2850                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Truncated Normal'</span>, <span class="string">'normaltrunc'</span>, <span class="string">'[a, b, mu, sigma]'</span>, <span class="string">'b-a'</span>, b-a, {<span class="string">'&gt;=0'</span>});
2851                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Truncated Normal'</span>, <span class="string">'normaltrunc'</span>, <span class="string">'[a, b, mu, sigma]'</span>, <span class="string">'sigma'</span>, sigma, {<span class="string">'&gt; 0'</span>});
2852 
2853                     PHIl = <a href="#_sub3" class="code" title="subfunction cdf = normcdf(y)">normcdf</a>((a-mu)/sigma);
2854                     PHIr = <a href="#_sub3" class="code" title="subfunction cdf = normcdf(y)">normcdf</a>((b-mu)/sigma);
2855                     
2856                     out = mu + sigma*( sqrt(2)*erfinv(2*(PHIl+(PHIr-PHIl)*rand(sampleSize))-1) );
2857                     
2858                <span class="keyword">case</span> {<span class="string">'nig'</span>}
2859                     <span class="comment">% START nig HELP</span>
2860                     <span class="comment">% THE NORMAL INVERSE GAUSSIAN (NIG) DISTRIBUTION</span>
2861                     <span class="comment">%  NIG(alpha, beta, mu, delta)</span>
2862                     <span class="comment">%</span>
2863                     <span class="comment">%  Heavy-tailed distributions such as the normal inverse Gauss distribution</span>
2864                     <span class="comment">%  (NIG) play a prominent role in the statistical analysis of economic time-series.</span>
2865                     <span class="comment">%  A number of empirical studies have shown that the marginal distribution of the</span>
2866                     <span class="comment">%  daily returns of liquid shares are NIG.</span>
2867                     <span class="comment">%</span>
2868                     <span class="comment">%   The NIG density is a variance-mean mixture of a Gaussian density with</span>
2869                     <span class="comment">%  an inverse Gaussian.</span>
2870                     <span class="comment">%   The shape of the NIG density is specified by the four-dimensional</span>
2871                     <span class="comment">%  parameter vector [alpha, beta , mu, delta]. The rich parametrization</span>
2872                     <span class="comment">%  makes the NIG density a suitable model for a variety of unimodal positive</span>
2873                     <span class="comment">%  kurtotic data. The alpha-parameter controls the steepness or pointiness</span>
2874                     <span class="comment">%  of the density, which increases monotonically with increasing alpha.</span>
2875                     <span class="comment">%  A large alpha implies light tails, a small value implies heavy tails.</span>
2876                     <span class="comment">%  The beta-parameter controls the skewness. For beta&lt;0, the density is skewed to</span>
2877                     <span class="comment">%  the left, for beta&gt;0 the density is skewed to the right, while</span>
2878                     <span class="comment">%  beta=0 implies a symmetric density around mu, which is a centrality parameter.</span>
2879                     <span class="comment">%  The delta-parameter is a scale-like parameter.</span>
2880                     <span class="comment">%</span>
2881                     <span class="comment">%  pdf(y; alpha, beta, mu, delta) = ...</span>
2882                     <span class="comment">%      alpha/pi * exp(delta*sqrt(alpha^2-beta^2) - beta*mu) * ...</span>
2883                     <span class="comment">%      1/sqrt(1+((y-mu)/delta).^2) .* ...</span>
2884                     <span class="comment">%      besselk(1, alpha*delta*sqrt(1+((y-mu)/delta).^2)) .*...</span>
2885                     <span class="comment">%      exp(beta*y);</span>
2886                     <span class="comment">%</span>
2887                     <span class="comment">%   Mean = mu+beta*delta/sqrt(alpha^2-beta^2);</span>
2888                     <span class="comment">%   Variance = delta * (alpha^2 / sqrt(alpha^2 - beta^2)^3);</span>
2889                     <span class="comment">%   Skewness = 3*beta/(alpha*sqrt(delta*sqrt(alpha^2 - beta^2)));</span>
2890                     <span class="comment">%   Kurtosis = 3*(1 + 4*(beta/alpha)^2)/(delta*sqrt(alpha^2 - beta^2));</span>
2891                     <span class="comment">%</span>
2892                     <span class="comment">%  PARAMETERS:</span>
2893                     <span class="comment">%    alpha,  alpha &gt; 0</span>
2894                     <span class="comment">%    beta,   0 &lt;= abs(beta) &lt; alpha</span>
2895                     <span class="comment">%    mu,     -Inf &lt; mu &lt; Inf</span>
2896                     <span class="comment">%    delta,  delta &gt; 0</span>
2897                     <span class="comment">%</span>
2898                     <span class="comment">%  SUPPORT:</span>
2899                     <span class="comment">%    y,   -Inf &lt; y &lt; Inf</span>
2900                     <span class="comment">%</span>
2901                     <span class="comment">% CLASS:</span>
2902                     <span class="comment">%   Continuous skewed distribution</span>
2903                     <span class="comment">%</span>
2904                     <span class="comment">% USAGE:</span>
2905                     <span class="comment">%   randraw('nig', [alpha, beta, mu, delta], sampleSize) - generate sampleSize</span>
2906                     <span class="comment">%         number of variates from NIG distribution with parameters</span>
2907                     <span class="comment">%         alpha, beta, mu and delta</span>
2908                     <span class="comment">%   randraw('nig') - help for NIG distribution;</span>
2909                     <span class="comment">%</span>
2910                     <span class="comment">% EXAMPLES:</span>
2911                     <span class="comment">%  1.   y = randraw('nig', [2, 1, 4, 2], [1 1e5]);</span>
2912                     <span class="comment">%  2.   y = randraw('nig', [2, 1, 4, 2], 1, 1e5);</span>
2913                     <span class="comment">%  3.   y = randraw('nig', [2, 1, 4, 2], 1e5 );</span>
2914                     <span class="comment">%  4.   y = randraw('nig', [2, 1, 4, 2], [1e5 1] );</span>
2915                     <span class="comment">%  5.   randraw('nig');</span>
2916                     <span class="comment">%</span>
2917                     <span class="comment">% SEE ALSO:</span>
2918                     <span class="comment">%  INVERSE GAUSSIAN distribution</span>
2919                     <span class="comment">% END nig HELP</span>
2920                     
2921                     <span class="comment">% REFERENCES:</span>
2922                     <span class="comment">% 1. http://www.quantlet.com/mdstat/scripts/csa/html/node236.html</span>
2923                     <span class="comment">% 2. http://www.anst.uu.se/larsfors/APRv1_5.pdf</span>
2924                     <span class="comment">% 3. http://ica2001.ucsd.edu/index_files/pdfs/048-jenssen.pdf</span>
2925                     <span class="comment">% 4. http://www.freidok.uni-freiburg.de/volltexte/15/pdf/15_1.pdf</span>
2926 
2927                     
2928                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'NIG'</span>, <span class="string">'nig'</span>, distribParams, [4]);
2929                                         
2930                     alpha = distribParams(1);
2931                     beta  = distribParams(2);
2932                     mu    = distribParams(3);
2933                     delta = distribParams(4);
2934                     
2935                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'NIG'</span>, <span class="string">'nig'</span>, <span class="string">'[alpha, beta, mu, delta]'</span>, <span class="string">'alpha'</span>, alpha, {<span class="string">'&gt; 0'</span>});
2936                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'NIG'</span>, <span class="string">'nig'</span>, <span class="string">'[alpha, beta, mu, delta]'</span>, <span class="string">'delta'</span>, delta, {<span class="string">'&gt; 0'</span>});
2937                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'NIG'</span>, <span class="string">'nig'</span>, <span class="string">'[alpha, beta, mu, delta]'</span>, <span class="string">'alpha-abs(beta)'</span>, alpha-abs(beta), {<span class="string">'&gt; 0'</span>});
2938                     
2939                     invGaussY = feval(funcName, <span class="string">'ig'</span>, [delta/sqrt(alpha^2-beta^2), delta^2], sampleSize);
2940                     out = mu + beta*invGaussY + sqrt(invGaussY).*randn(sampleSize);
2941                     
2942                <span class="keyword">case</span> {<span class="string">'pareto'</span>}
2943                     <span class="comment">% START pareto HELP</span>
2944                     <span class="comment">%   Pareto or &quot;power law&quot; distribution, used in the analysis of financial data</span>
2945                     <span class="comment">%   and critical behavior</span>
2946                     <span class="comment">%</span>
2947                     <span class="comment">%  pdf = a*k^a ./ y.^(a+1);</span>
2948                     <span class="comment">%  cdf = 1 - (k./y).^a;</span>
2949                     <span class="comment">%</span>
2950                     <span class="comment">%  Mean = k*a/(a-1);</span>
2951                     <span class="comment">%  Variance = k^2*a/((a-2)*(a-1)^2);</span>
2952                     <span class="comment">%  Skewness = 2*(a+1)*sqrt(a-2)/((a-3)*sqrt(a));</span>
2953                     <span class="comment">%  Kurtosis = 6*(a^3+a^2-6*a-2)/(a*(a^2-7*a+12));</span>
2954                     <span class="comment">%</span>
2955                     <span class="comment">% PARAMETERS:</span>
2956                     <span class="comment">%  k - location parameter  (k&gt;0)</span>
2957                     <span class="comment">%  a - shape parameter (a&gt;0)</span>
2958                     <span class="comment">%</span>
2959                     <span class="comment">% SUPPORT:</span>
2960                     <span class="comment">%  y,  y &gt; k</span>
2961                     <span class="comment">%</span>
2962                     <span class="comment">% CLASS:</span>
2963                     <span class="comment">%   Continuous skewed distributions</span>
2964                     <span class="comment">%</span>
2965                     <span class="comment">% USAGE:</span>
2966                     <span class="comment">%   randraw('pareto', [k, a], sampleSize) - generate sampleSize</span>
2967                     <span class="comment">%         number of variates from the Pareto distribution with parameters</span>
2968                     <span class="comment">%         'k' and 'a'</span>
2969                     <span class="comment">%   randraw('pareto') - help for the Pareto distribution;</span>
2970                     <span class="comment">%</span>
2971                     <span class="comment">% EXAMPLES:</span>
2972                     <span class="comment">%  1.   y = randraw('pareto', [1, 2], [1 1e5]);</span>
2973                     <span class="comment">%  2.   y = randraw('pareto', [3, 8], 1, 1e5);</span>
2974                     <span class="comment">%  3.   y = randraw('pareto', [0.5, 2.4], 1e5 );</span>
2975                     <span class="comment">%  4.   y = randraw('pareto', [3.5, 4.5], [1e5 1] );</span>
2976                     <span class="comment">%  5.   randraw('pareto');</span>
2977                     <span class="comment">% END pareto HELP</span>
2978 
2979                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Pareto'</span>, <span class="string">'pareto'</span>, distribParams, [2]);
2980                                         
2981                     k = distribParams(1);
2982                     a  = distribParams(2);
2983                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Pareto'</span>, <span class="string">'pareto'</span>, <span class="string">'[k, a]'</span>, <span class="string">'k'</span>, k, {<span class="string">'&gt; 0'</span>});
2984                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Pareto'</span>, <span class="string">'pareto'</span>, <span class="string">'[k, a]'</span>, <span class="string">'a'</span>, a, {<span class="string">'&gt; 0'</span>});
2985 
2986                     out = k*rand( sampleSize ).^(-1/a);
2987 
2988                <span class="keyword">case</span> {<span class="string">'pareto2'</span>, <span class="string">'lomax'</span>}
2989                     <span class="comment">% START pareto2 HELP</span>
2990                     <span class="comment">% THE PARETO DISTRIBUTION OF THE SECOND TYPE</span>
2991                     <span class="comment">%  (sometimes Lomax distribution )</span>
2992                     <span class="comment">%</span>
2993                     <span class="comment">%  pdf = b*k^b ./ (k+y).^(b+1);   b&gt;0, y&gt;0;</span>
2994                     <span class="comment">%  cdf = 1 - k^b./(k+y).^b;</span>
2995                     <span class="comment">%</span>
2996                     <span class="comment">% PARAMETERS:</span>
2997                     <span class="comment">%   k - location parameters (k&gt;0)</span>
2998                     <span class="comment">%   b - shape parameters (b&gt;0)</span>
2999                     <span class="comment">%</span>
3000                     <span class="comment">% SUPPORT:</span>
3001                     <span class="comment">%   y,  y&gt;0</span>
3002                     <span class="comment">%</span>
3003                     <span class="comment">% CLASS;</span>
3004                     <span class="comment">%  Continuous skewed distribution</span>
3005                     <span class="comment">%</span>
3006                     <span class="comment">% USAGE:</span>
3007                     <span class="comment">%   randraw('pareto2', [k, b], sampleSize) - generate sampleSize</span>
3008                     <span class="comment">%         number of variates from the Pareto Second Type distribution with parameters</span>
3009                     <span class="comment">%         'k' and 'b'</span>
3010                     <span class="comment">%   randraw('pareto2') - help for the Pareto Second Type distribution;</span>
3011                     <span class="comment">%</span>
3012                     <span class="comment">% EXAMPLES:</span>
3013                     <span class="comment">%  1.   y = randraw('pareto2', [1, 2], [1 1e5]);</span>
3014                     <span class="comment">%  2.   y = randraw('pareto2', [3, 8], 1, 1e5);</span>
3015                     <span class="comment">%  3.   y = randraw('pareto2', [0.5, 2.4], 1e5 );</span>
3016                     <span class="comment">%  4.   y = randraw('pareto2', [3.5, 4.5], [1e5 1] );</span>
3017                     <span class="comment">%  5.   randraw('pareto2');</span>
3018                     <span class="comment">% END pareto2 HELP</span>
3019                     
3020                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Pareto Second Type'</span>, <span class="string">'pareto2'</span>, distribParams, [2]);
3021                     
3022                     k = distribParams(1);
3023                     b  = distribParams(2);
3024                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Pareto Second Type'</span>, <span class="string">'pareto2'</span>, <span class="string">'[k, b]'</span>, <span class="string">'k'</span>, k, {<span class="string">'&gt; 0'</span>});
3025                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Pareto Second Type'</span>, <span class="string">'pareto2'</span>, <span class="string">'[k, b]'</span>, <span class="string">'b'</span>, b, {<span class="string">'&gt; 0'</span>});
3026                     
3027                     out = k*(1 - rand( sampleSize )).^(-1/b) - k;
3028                     
3029                <span class="keyword">case</span> <span class="string">'planck'</span>
3030                     <span class="comment">% START planck HELP</span>
3031                     <span class="comment">% THE PLANCK DISTRIBUTION</span>
3032                     <span class="comment">% The Planck distribution widely used in Physics.</span>
3033                     <span class="comment">%</span>
3034                     <span class="comment">% The Planck distribution ia a two parameter distribution:</span>
3035                     <span class="comment">% pdf(y) = b^(a+1)/(gamma(a+1)*zeta(a+1)) * y^a/(exp(b*y)-1);</span>
3036                     <span class="comment">%    where zeta(c) is the Riemann zeta function defined as</span>
3037                     <span class="comment">%       zeta(c) = sum from k=1 to Inf of 1/k^c.</span>
3038                     <span class="comment">%</span>
3039                     <span class="comment">% PARAMETERS:</span>
3040                     <span class="comment">%  a &gt; 0 is a shape parameter</span>
3041                     <span class="comment">%  b &gt; 0 is a scale parameter</span>
3042                     <span class="comment">%</span>
3043                     <span class="comment">% SUPPORT:</span>
3044                     <span class="comment">%  y, y&gt;0</span>
3045                     <span class="comment">%</span>
3046                     <span class="comment">% CLASS:</span>
3047                     <span class="comment">%  Continuous skewed distributions</span>
3048                     <span class="comment">%</span>
3049                     <span class="comment">% USAGE:</span>
3050                     <span class="comment">%   randraw('planck', [a, b], sampleSize) - generate sampleSize</span>
3051                     <span class="comment">%         number of variates from the Planck distribution with parameters</span>
3052                     <span class="comment">%         'a' and 'b'</span>
3053                     <span class="comment">%   randraw('planck') - help for the Planck distribution;</span>
3054                     <span class="comment">%</span>
3055                     <span class="comment">% EXAMPLES:</span>
3056                     <span class="comment">%  1.   y = randraw('planck', [1, 2], [1 1e5]);</span>
3057                     <span class="comment">%  2.   y = randraw('planck', [3, 8], 1, 1e5);</span>
3058                     <span class="comment">%  3.   y = randraw('planck', [0.5, 2.4], 1e5 );</span>
3059                     <span class="comment">%  4.   y = randraw('planck', [3.5, 4.5], [1e5 1] );</span>
3060                     <span class="comment">%  5.   randraw('planck');</span>
3061                     <span class="comment">% END planck HELP</span>
3062                     
3063                     <span class="comment">% Reference:</span>
3064                     <span class="comment">% Luc Devroye, &quot;Non-Uniform Random Variate Generation,&quot;</span>
3065                     <span class="comment">% Springer 1986, 850p. 3-540-96305-7</span>
3066 
3067                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Planck'</span>, <span class="string">'planck'</span>, distribParams, [2]);
3068                     
3069                     a = distribParams(1);
3070                     b  = distribParams(2);
3071                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Planck'</span>, <span class="string">'planck'</span>, <span class="string">'[a, b]'</span>, <span class="string">'a'</span>, a, {<span class="string">'&gt; 0'</span>});
3072                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Planck'</span>, <span class="string">'planck'</span>, <span class="string">'[a, b]'</span>, <span class="string">'b'</span>, b, {<span class="string">'&gt; 0'</span>});
3073 
3074                     zetav = feval(funcName, <span class="string">'zeta'</span>, a+1, sampleSize);
3075                     out = feval(funcName, <span class="string">'gamma'</span>, a+1, sampleSize) ./ <span class="keyword">...</span>
3076                          (b * zetav);
3077 
3078                <span class="keyword">case</span> {<span class="string">'poisson'</span>, <span class="string">'po'</span>}
3079                     <span class="comment">% START po HELP START poisson HELP</span>
3080                     <span class="comment">% THE POISSON DISTRIBUTION</span>
3081                     <span class="comment">%    ~ Poisson(lambda)</span>
3082                     <span class="comment">%</span>
3083                     <span class="comment">% pdf(y) = exp(-lambda)*lambda^y/factorial(y) = ...</span>
3084                     <span class="comment">%           exp( -lambda + y*log(lambda) - gammaln(y+1) ); lambda&gt;0</span>
3085                     <span class="comment">%</span>
3086                     <span class="comment">%  Mean = lambda;</span>
3087                     <span class="comment">%  Variance = lambda</span>
3088                     <span class="comment">%  Mode = floor(lambda);</span>
3089                     <span class="comment">%</span>
3090                     <span class="comment">% PARAMETERS:</span>
3091                     <span class="comment">%  lambda,  lambda &gt; 0</span>
3092                     <span class="comment">%</span>
3093                     <span class="comment">% SUPPORT:</span>
3094                     <span class="comment">%  y,  y = 0, 1, 2, 3, 4, ...</span>
3095                     <span class="comment">%</span>
3096                     <span class="comment">% CLASS:</span>
3097                     <span class="comment">%  Discrete distributions</span>
3098                     <span class="comment">%</span>
3099                     <span class="comment">% NOTES:</span>
3100                     <span class="comment">%  1. If lambda is an integer, Mode also equals (lambda+1).</span>
3101                     <span class="comment">%  2. The Poisson distribution is commonly used as an approximation</span>
3102                     <span class="comment">%     to the Binomial distribution when probability of success is very small.</span>
3103                     <span class="comment">%  3. In queueing theory, when interarrival times are ~Exponential, the number of arrivals in a</span>
3104                     <span class="comment">%     fixed interval are ~Poisson.</span>
3105                     <span class="comment">%  4. Errors in observations with integer values (i.e., miscounting) are ~Poisson.</span>
3106                     <span class="comment">%</span>
3107                     <span class="comment">% USAGE:</span>
3108                     <span class="comment">%   randraw('po', lambda, sampleSize) - generate sampleSize</span>
3109                     <span class="comment">%         number of variates from the Poisson distribution with</span>
3110                     <span class="comment">%         parameter lambda;</span>
3111                     <span class="comment">%   randraw('po') - help for the Poisson distribution;</span>
3112                     <span class="comment">%</span>
3113                     <span class="comment">% EXAMPLES:</span>
3114                     <span class="comment">%  1.   y = randraw('po', [2], [1 1e5]);</span>
3115                     <span class="comment">%  2.   y = randraw('po', [3], 1, 1e5);</span>
3116                     <span class="comment">%  3.   y = randraw('po', [10.4], 1e5 );</span>
3117                     <span class="comment">%  4.   y = randraw('po', [100.25], [1e5 1] );</span>
3118                     <span class="comment">%  5.   randraw('po');</span>
3119                     <span class="comment">%</span>
3120                     <span class="comment">% SEE ALSO:</span>
3121                     <span class="comment">%  BINOMIAL distribution</span>
3122                     <span class="comment">%</span>
3123                     <span class="comment">% END po HELP END poisson HELP</span>
3124                     
3125                     <span class="comment">% Method:</span>
3126                     <span class="comment">% 1) If lambda &gt; 1000 we use normal approximation to poisson distribution</span>
3127                     <span class="comment">%      mean=lambda, variance=lambda^2</span>
3128                     <span class="comment">% 2) If lambda &lt; 1000 we use the following reference:</span>
3129                     <span class="comment">%    George Marsaglia, Fast Generation Of Discrete Random Variables,</span>
3130                     <span class="comment">%    Journal of Statistical Software, July 2004, Volume 11, Issue 4</span>
3131                     <span class="comment">%</span>
3132                     <span class="comment">%    (Note: this method does not support lambda&lt;5e-10.</span>
3133                     <span class="comment">%          So for lambda&lt;5e-10 we return 0 )</span>
3134 
3135                     <span class="keyword">if</span> numel(distribParams) ~= 1
3136                          error(<span class="string">'Poisson Distribution: Wrong numebr of parameters (run randraw(''poisson'') for help) '</span>);
3137                     <span class="keyword">end</span>
3138                     lam = distribParams(1);
3139                     <span class="keyword">if</span> lam &lt; 0
3140                          error(<span class="string">'Poisson Distribution: Parameter ''lambda'' should be positive (run randraw(''poisson'') for help) '</span>);
3141                     <span class="keyword">end</span>
3142 
3143                     <span class="keyword">if</span> lam &gt; 1e3
3144                          <span class="comment">% For sufficiently large values of lambda (lambda &gt; 1000 say),</span>
3145                          <span class="comment">% the normal distribution with mean lambda and variance lambda is</span>
3146                          <span class="comment">% an excellent approximation to the Poisson distribution.</span>
3147 
3148                          out = round( lam + sqrt(lam) * randn( sampleSize ) );
3149 
3150                     <span class="keyword">else</span> <span class="comment">% lam &lt;= 1e3</span>
3151 
3152                          <span class="keyword">if</span> lam&lt;21.4
3153                               <span class="keyword">if</span> lam&lt;5e-10
3154                                    varargout{1} = zeros( sampleSize );
3155                                    <span class="keyword">return</span>;
3156                               <span class="keyword">end</span>
3157                               t=exp(-lam);
3158                               p = t;
3159                               ii = 1;
3160                               <span class="keyword">while</span> t*2147483648 &gt; 1
3161                                    t = t * (lam/ii);
3162                                    ii = ii + 1;
3163                               <span class="keyword">end</span>
3164                               sizeP = ii-1;
3165                               offset = 0;
3166                               <span class="comment">%/* Given size, fill P array (30-bit integers) */</span>
3167 
3168                               P = round( 2^30*p*cumprod([1, lam./(1:sizeP-1)] ) );
3169                          <span class="keyword">else</span> <span class="comment">%lam&gt;21.4</span>
3170 
3171                               <span class="comment">% maximum lam = 1940;</span>
3172 
3173                               mode = floor(lam);
3174                               
3175                               loglam = log(lam);
3176                               log2147483648 = log(2147483648);
3177                               tmode = -lam + mode*loglam - gammaln(mode+1);
3178                               pmode = exp( tmode );
3179 
3180                               t = tmode;
3181                               ii = mode + 1;
3182                               <span class="keyword">while</span> t + log2147483648 &gt; 0
3183                                    t = t + loglam - log(ii);
3184                                    ii = ii + 1;
3185                               <span class="keyword">end</span>                                   
3186                               last = ii-2;
3187                               
3188                               t = tmode;
3189                               j=-1;
3190                               <span class="keyword">for</span> ii=mode-1:-1:0
3191                                    t = t - loglam + log(ii+1);
3192                                    <span class="keyword">if</span> t + log2147483648 &lt; 0
3193                                         j=ii;
3194                                         <span class="keyword">break</span>;
3195                                    <span class="keyword">end</span>
3196                               <span class="keyword">end</span>
3197                     
3198                               offset = j+1;
3199                               sizeP = last-offset+1;
3200 
3201                               P = zeros(1, sizeP);
3202                      
3203                               ii = (mode+1):last;
3204                               P(mode-offset+1:last-offset+1) = round( 2^30*pmode*cumprod([1, lam./ii]) );
3205                              
3206                               ii = (mode-1):-1:offset;
3207                               P(mode-offset:-1:1) = round( 2^30*pmode*cumprod((ii+1)/lam) );
3208 
3209                          <span class="keyword">end</span>
3210 
3211                          out = <a href="#_sub6" class="code" title="subfunction out = randFrom5Tbls( P, offset, sampleSize)">randFrom5Tbls</a>( P, offset, sampleSize);
3212                          
3213                     <span class="keyword">end</span>
3214                     
3215                <span class="keyword">case</span> {<span class="string">'quadratic'</span>, <span class="string">'quad'</span>, <span class="string">'quadr'</span>}
3216                     <span class="comment">% START quadratic HELP  START quad HELP START quadr HELP</span>
3217                     <span class="comment">% THE QUADRATIC DISTRIBUTION</span>
3218                     <span class="comment">%</span>
3219                     <span class="comment">% Standard form of the quadratic distribution:</span>
3220                     <span class="comment">%</span>
3221                     <span class="comment">%   pdf(y) = 3/4*(1-y.^2); -1&lt;=y&lt;=1;</span>
3222                     <span class="comment">%</span>
3223                     <span class="comment">%  Mean = 0;</span>
3224                     <span class="comment">%  Variance = 1/5;</span>
3225                     <span class="comment">%</span>
3226                     <span class="comment">% General form of the quadratic distribution:</span>
3227                     <span class="comment">%</span>
3228                     <span class="comment">%   pdf(y) = 3/(4*s) * (1-((y-t)/s).^2); t-s&lt;=y&lt;=t+s; s&gt;0</span>
3229                     <span class="comment">%   cdf(y) = 1/2 + 3/4*(y-t)/s - 1/4*((y-t)/s).^3; ; t-s&lt;=y&lt;=t+s; s&gt;0</span>
3230                     <span class="comment">%</span>
3231                     <span class="comment">%  Mean = t;</span>
3232                     <span class="comment">%  Variance = s^2/5;</span>
3233                     <span class="comment">%</span>
3234                     <span class="comment">% PARAMETERS:</span>
3235                     <span class="comment">%   t - location</span>
3236                     <span class="comment">%   s -scale; s&gt;0</span>
3237                     <span class="comment">%</span>
3238                     <span class="comment">% SUPPORT:</span>
3239                     <span class="comment">%   y,   -1 &lt;= y &lt;= 1   - standard Quadratic distribution</span>
3240                     <span class="comment">%    or</span>
3241                     <span class="comment">%   y,   t-s &lt;= y &lt;= t+s  - generalized Quadratic distribution</span>
3242                     <span class="comment">%</span>
3243                     <span class="comment">% CLASS:</span>
3244                     <span class="comment">%   Continuous distributions</span>
3245                     <span class="comment">%</span>
3246                     <span class="comment">% USAGE:</span>
3247                     <span class="comment">%   randraw('quadr', [], sampleSize) - generate sampleSize number</span>
3248                     <span class="comment">%         of variates from standard Quadratic distribution;</span>
3249                     <span class="comment">%   randraw('quadr', [t, s], sampleSize) - generate sampleSize number</span>
3250                     <span class="comment">%         of variates from generalized Quadratic distribution</span>
3251                     <span class="comment">%         with location parameter 't' and scale parameter 's';</span>
3252                     <span class="comment">%   randraw('quadr') - help for Quadratic distribution;</span>
3253                     <span class="comment">%</span>
3254                     <span class="comment">% EXAMPLES:</span>
3255                     <span class="comment">%  1.   y = randraw('quadr', [], [1 1e5]);</span>
3256                     <span class="comment">%  2.   y = randraw('quadr', [], 1, 1e5);</span>
3257                     <span class="comment">%  3.   y = randraw('quadr', [], 1e5 );</span>
3258                     <span class="comment">%  4.   y = randraw('quadr', [10 3], [1e5 1] );</span>
3259                     <span class="comment">%  5.   randraw('quadr');</span>
3260                     <span class="comment">% END quadratic HELP END quad HELP END quadr HELP</span>
3261                     
3262                     
3263                     <span class="comment">% Method:</span>
3264                     <span class="comment">%</span>
3265                     <span class="comment">% Inverse CDF transformation method.</span>
3266                     <span class="comment">% We use Vi`ete formula to solve cubic equation.</span>
3267                     
3268                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Quadratic'</span>, <span class="string">'quadratic'</span>, distribParams, [0, 2]);  
3269                     <span class="keyword">if</span> numel(distribParams)==2
3270                          t  = distribParams(1);
3271                          s  = distribParams(2);  
3272                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Quadratic'</span>, <span class="string">'quadratic'</span>, <span class="string">'[t, s]'</span>, <span class="string">'s'</span>, s, {<span class="string">'&gt; 0'</span>});
3273                     <span class="keyword">else</span>
3274                          t = 0;
3275                          s = 1;                        
3276                     <span class="keyword">end</span>                      
3277                     
3278                     out = t + s * 2*sin(1/3*asin(2*rand( sampleSize )-1));
3279                                                          
3280                <span class="keyword">case</span> {<span class="string">'rademacher'</span>}
3281                     <span class="comment">% START rademacher HELP</span>
3282                     <span class="comment">% THE RADEMACHER DISTRIBUTION</span>
3283                     <span class="comment">%   The Rademacher distribution takes value 1 with probability 1/2</span>
3284                     <span class="comment">%   and value -1 with probability 1/2 (it is simply a random sign)</span>
3285                     <span class="comment">%   ( Hans Rademacher (1892-1969) )</span>
3286                     <span class="comment">%</span>
3287                     <span class="comment">% PARAMETERS:</span>
3288                     <span class="comment">%    None</span>
3289                     <span class="comment">%</span>
3290                     <span class="comment">% SUPPORT:</span>
3291                     <span class="comment">%   y = -1 or 1</span>
3292                     <span class="comment">%</span>
3293                     <span class="comment">% CLASS:</span>
3294                     <span class="comment">%   Descrete distributions</span>
3295                     <span class="comment">%</span>
3296                     <span class="comment">% USAGE:</span>
3297                     <span class="comment">%   randraw('rademacher', [], sampleSize) - generate sampleSize number</span>
3298                     <span class="comment">%         of variates from the Rademacher distribution;</span>
3299                     <span class="comment">%   randraw('rademacher') - help for the Rademacher distribution;</span>
3300                     <span class="comment">%</span>
3301                     <span class="comment">% EXAMPLES:</span>
3302                     <span class="comment">%  1.   y = randraw('rademacher', [], [1 1e5]);</span>
3303                     <span class="comment">%  2.   y = randraw('rademacher', [], 1, 1e5);</span>
3304                     <span class="comment">%  3.   y = randraw('rademacher', [], 1e5 );</span>
3305                     <span class="comment">%  4.   y = randraw('rademacher', [], [1e5 1] );</span>
3306                     <span class="comment">%  5.   randraw('rademacher');</span>
3307                     <span class="comment">% END rademacher HELP</span>
3308 
3309                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Rademacher'</span>, <span class="string">'rademacher'</span>, distribParams, [0]); 
3310                     
3311                     out = 2*round(rand(sampleSize)) - 1;
3312 
3313                <span class="keyword">case</span> {<span class="string">'rayl'</span>, <span class="string">'rayleigh'</span>}
3314                     <span class="comment">% START rayl HELP START rayleigh HELP</span>
3315                     <span class="comment">% THE RAYLEIGH DISTRIBUTION</span>
3316                     <span class="comment">%</span>
3317                     <span class="comment">%  pdf  = y./sigma^2 * exp(-y.^2/(2*sigma^2)); y &gt;= 0</span>
3318                     <span class="comment">%  cdf  = 1 - exp(-y.^2/(2*sigma^2));</span>
3319                     <span class="comment">%</span>
3320                     <span class="comment">%  Mean = sqrt(pi/2)*sigma;</span>
3321                     <span class="comment">%  Variance = (4-pi)/2*sigma^2;</span>
3322                     <span class="comment">%</span>
3323                     <span class="comment">% PARAMETERS:</span>
3324                     <span class="comment">%   sigma - scale parameter (-Inf &lt; sigma &lt; Inf)</span>
3325                     <span class="comment">%</span>
3326                     <span class="comment">% SUPPORT:</span>
3327                     <span class="comment">%   y,  y &gt;= 0</span>
3328                     <span class="comment">%</span>
3329                     <span class="comment">% CLASS:</span>
3330                     <span class="comment">%   Continuous skewed distributions</span>
3331                     <span class="comment">%</span>
3332                     <span class="comment">%  USAGE:</span>
3333                     <span class="comment">%   randraw('rayl', sigma, sampleSize) - generate sampleSize number</span>
3334                     <span class="comment">%         of variates from the Rayleigh distribution with scale parameter 'sigma';</span>
3335                     <span class="comment">%   randraw('rayl') - help for the Rayleigh distribution;</span>
3336                     <span class="comment">%</span>
3337                     <span class="comment">%  EXAMPLES:</span>
3338                     <span class="comment">%   1.   y = randraw('rayl', 1, [1 1e5]);</span>
3339                     <span class="comment">%   2.   y = randraw('rayl', 2.5, 1, 1e5);</span>
3340                     <span class="comment">%   3.   y = randraw('rayl', 3, 1e5 );</span>
3341                     <span class="comment">%   4.   y = randraw('rayl', 4, [1e5 1] );</span>
3342                     <span class="comment">%   5.   randraw('rayl');</span>
3343                     <span class="comment">%</span>
3344                     <span class="comment">%  SEE ALSO:</span>
3345                     <span class="comment">%    CHI, MAXWELL, WEIBULL distributions</span>
3346                     <span class="comment">% END rayl HELP END rayleigh HELP</span>
3347 
3348                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Rayleigh'</span>, <span class="string">'rayl'</span>, distribParams, [1]);
3349                     sigma = distribParams(1);
3350                     
3351                     out = sqrt(-2 * sigma^2 * log(rand( sampleSize ) ));
3352 
3353                <span class="keyword">case</span> {<span class="string">'semicirc'</span>, <span class="string">'semicircle'</span>, <span class="string">'wigner'</span>}
3354                     <span class="comment">% START semicirc HELP START semicircle HELP START wigner HELP</span>
3355                     <span class="comment">% THE SEMICIRCLE DISTRIBUTION</span>
3356                     <span class="comment">%   ( Wigner semicircle distribution)</span>
3357                     <span class="comment">%</span>
3358                     <span class="comment">% The Wigner semicircle distribution, named after the physicist Eugene Wigner,</span>
3359                     <span class="comment">% is the probability distribution supported on the interval [m?R, m+R] the graph</span>
3360                     <span class="comment">% of whose probability density function is a semicircle of radius R centered at</span>
3361                     <span class="comment">% (m, 0) and then suitably normalized (so that it is really a semi-ellipse).</span>
3362                     <span class="comment">%</span>
3363                     <span class="comment">%  pdf = 2/(pi*R^2) * sqrt(1-(y-m).^2);</span>
3364                     <span class="comment">%</span>
3365                     <span class="comment">%  Mean = m;</span>
3366                     <span class="comment">%  Variance = R^2/4;</span>
3367                     <span class="comment">%</span>
3368                     <span class="comment">%  PARAMETERS:</span>
3369                     <span class="comment">%    m - location;</span>
3370                     <span class="comment">%    R - semicircle radius; (R&gt;0)</span>
3371                     <span class="comment">%</span>
3372                     <span class="comment">%  SUPPORT:</span>
3373                     <span class="comment">%    y,  m-R &lt;= y &lt;= m+R</span>
3374                     <span class="comment">%</span>
3375                     <span class="comment">%  CLASS:</span>
3376                     <span class="comment">%    Continuous symmetric distributions</span>
3377                     <span class="comment">%</span>
3378                     <span class="comment">%  USAGE:</span>
3379                     <span class="comment">%   randraw('semicirc', [m, R], sampleSize) - generate sampleSize number</span>
3380                     <span class="comment">%         of variates from the Semicircle distribution on the interval [m-R, m+R];</span>
3381                     <span class="comment">%   randraw('semicirc') - help for the Semicircle distribution;</span>
3382                     <span class="comment">%</span>
3383                     <span class="comment">%  EXAMPLES:</span>
3384                     <span class="comment">%   1.   y = randraw('semicirc', [0, 1], [1 1e5]);</span>
3385                     <span class="comment">%   2.   y = randraw('semicirc', [-1.5, 5], 1, 1e5);</span>
3386                     <span class="comment">%   3.   y = randraw('semicirc', [2, 10], 1e5 );</span>
3387                     <span class="comment">%   4.   y = randraw('semicirc', [11, 1], [1e5 1] );</span>
3388                     <span class="comment">%   5.   randraw('semicirc');</span>
3389                     <span class="comment">% END semicirc HELP END semicircle HELP END wigner HELP</span>
3390 
3391                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Semicircle'</span>, <span class="string">'semicirc'</span>, distribParams, [2]);
3392                     m = distribParams(1);
3393                     R = distribParams(2);
3394                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Semicircle'</span>, <span class="string">'semicirc'</span>, <span class="string">'[m, R]'</span>, <span class="string">'R'</span>, R, {<span class="string">'&gt; 0'</span>});                                                  
3395                     
3396                     out = m + R*sqrt(rand(sampleSize)) .* cos( rand(sampleSize)*pi );
3397 
3398                <span class="keyword">case</span> {<span class="string">'skellam'</span>}
3399                     <span class="comment">% START skellam HELP</span>
3400                     <span class="comment">% THE SKELLAM DISTRIBUTION</span>
3401                     <span class="comment">%</span>
3402                     <span class="comment">%  The Skellam distribution is the probability distribution of the difference N1 - N2</span>
3403                     <span class="comment">%  of two uncorrelated random variables N1 and N2 having Poisson distributions</span>
3404                     <span class="comment">%  with different expected values lambda1 and lambda2.</span>
3405                     <span class="comment">%  The Skellam probability density function is:</span>
3406                     <span class="comment">%</span>
3407                     <span class="comment">%    pdf(n) = exp(-lambda1+lambda2)*(lambda1/lambda2)^(n/2)*besseli(n,2*sqrt(lambda1*lambda2));</span>
3408                     <span class="comment">%     where besseli is the modified Bessel function of the first kind.</span>
3409                     <span class="comment">%</span>
3410                     <span class="comment">%  Mean = lambda1 - lambda2;</span>
3411                     <span class="comment">%  Variance = lambda1 + lambda2;</span>
3412                     <span class="comment">%  Kurtosis = 1/(lambda1 + lambda2);</span>
3413                     <span class="comment">%  Skewness = (lambda1 - lambda2)/(lambda1 + lambda2)^(3/2);</span>
3414                     <span class="comment">%</span>
3415                     <span class="comment">% PARAMETERS:</span>
3416                     <span class="comment">%   lambda1 &gt;= 0;</span>
3417                     <span class="comment">%   lambda2 &gt;= 0;</span>
3418                     <span class="comment">%</span>
3419                     <span class="comment">% SUPPORT:</span>
3420                     <span class="comment">%   n = ..., -2, -1, 0, 1, 2, 3 ...</span>
3421                     <span class="comment">%</span>
3422                     <span class="comment">% CLASS:</span>
3423                     <span class="comment">%   Discrete distributions</span>
3424                     <span class="comment">%</span>
3425                     <span class="comment">% USAGE:</span>
3426                     <span class="comment">%   randraw('skellam', [lambda1, lambda2], sampleSize) - generate sampleSize number</span>
3427                     <span class="comment">%         of variates from the Skellam distribution with parameters</span>
3428                     <span class="comment">%         lambda1 and lambda2;</span>
3429                     <span class="comment">%   randraw('skellam') - help for the Skellam distribution;</span>
3430                     <span class="comment">%</span>
3431                     <span class="comment">% EXAMPLES:</span>
3432                     <span class="comment">%  1.   y = randraw('skellam', [1, 2], [1 1e5]);</span>
3433                     <span class="comment">%  2.   y = randraw('skellam', [3, 3], 1, 1e5);</span>
3434                     <span class="comment">%  3.   y = randraw('skellam', [5, 6], 1e5 );</span>
3435                     <span class="comment">%  4.   y = randraw('skellam', [1.5, 5.6], [1e5 1] );</span>
3436                     <span class="comment">%  5.   randraw('skellam');</span>
3437                     <span class="comment">%</span>
3438                     <span class="comment">% SEE ALSO:</span>
3439                     <span class="comment">%   Poisson Distribution ( randraw('po') );</span>
3440                     <span class="comment">% END skellam HELP</span>
3441 
3442 
3443                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Skellam'</span>, <span class="string">'skellam'</span>, distribParams, [2]);
3444                     lambda1 = distribParams(1);
3445                     lambda2 = distribParams(2);
3446                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Skellam'</span>, <span class="string">'skellam'</span>, <span class="string">'[lambda1, lambda2]'</span>, <span class="string">'lambda1'</span>, lambda1, {<span class="string">'&gt; 0'</span>});                                                  
3447                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Skellam'</span>, <span class="string">'skellam'</span>, <span class="string">'[lambda1, lambda2]'</span>, <span class="string">'lambda2'</span>, lambda2, {<span class="string">'&gt; 0'</span>});    
3448                     
3449                     poiss1 = feval(funcName,<span class="string">'poisson'</span>,lambda1, sampleSize);
3450                     out    = feval(funcName,<span class="string">'poisson'</span>,lambda2, sampleSize);
3451 
3452                     out = poiss1 - out;
3453 
3454                <span class="keyword">case</span> {<span class="string">'studentst'</span>, <span class="string">'t'</span>} 
3455                     <span class="comment">% START studentst HELP START t HELP</span>
3456                     <span class="comment">% THE STUDENT'S-T DISTRIBUTION</span>
3457                     <span class="comment">%    ( t-distribution )</span>
3458                     <span class="comment">%</span>
3459                     <span class="comment">%  Standard form of Student's-t distribution:</span>
3460                     <span class="comment">%</span>
3461                     <span class="comment">%   pdf = gamma((nu+1)/2)/(sqrt(nu*pi)*gamma(nu/2)) *(1+y.^2/nu)^(-(nu+1)/2);</span>
3462                     <span class="comment">%        or alternatively:</span>
3463                     <span class="comment">%   pdf = (1+y.^2/nu)^(-(nu+1)/2) / (sqrt(nu)*beta(1/2,nu/2));</span>
3464                     <span class="comment">%</span>
3465                     <span class="comment">%   cdf = 1/2 + ( -(y&lt;0) + (y&gt;=0) ) .* ...</span>
3466                     <span class="comment">%          1/2*betainc( y.^2./(nu+y.^2), 1/2, nu/2 );</span>
3467                     <span class="comment">%</span>
3468                     <span class="comment">%  Mean = 0;</span>
3469                     <span class="comment">%  Variance = nu/(nu-2);</span>
3470                     <span class="comment">%  Skewness = 0;</span>
3471                     <span class="comment">%  Kurtosis = 3*( (nu-2)^2*gamma(nu/2-2)/(4*gamma(nu/2)) - 1 );</span>
3472                     <span class="comment">%</span>
3473                     <span class="comment">%  General form of Student's-t distribution:</span>
3474                     <span class="comment">%</span>
3475                     <span class="comment">%   pdf = gamma((nu+1)/2)/(sqrt(nu*pi)*gamma(nu/2)) *(1+((y-chi)/eta).^2/nu)^(-(nu+1)/2);</span>
3476                     <span class="comment">%        or alternatively:</span>
3477                     <span class="comment">%   pdf = (1+((y-chi)/eta).^2/nu)^(-(nu+1)/2) / (sqrt(nu)*beta(1/2,nu/2));</span>
3478                     <span class="comment">%</span>
3479                     <span class="comment">%   cdf = 1/2 + ( -(y&lt;chi) + (y&gt;=chi) ) .* ...</span>
3480                     <span class="comment">%          1/2*betainc( ((y-chi)/eta).^2./(nu+((y-chi)/eta).^2), 1/2, nu/2 );</span>
3481                     <span class="comment">%</span>
3482                     <span class="comment">%  Mean = chi;</span>
3483                     <span class="comment">%  Variance = nu/(nu-2)*eta^2;  (nu&gt;2)</span>
3484                     <span class="comment">%  Skewness = 0;</span>
3485                     <span class="comment">%  Kurtosis = 3*( (nu-2)^2*gamma(nu/2-2)/(4*gamma(nu/2)) - 1 );</span>
3486                     <span class="comment">%</span>
3487                     <span class="comment">% PARAMETERS:</span>
3488                     <span class="comment">%   nu - degrees of freedom (nu = 1, 2, 3, ...)</span>
3489                     <span class="comment">%   chi - location parameter</span>
3490                     <span class="comment">%   eta - scale parameter ( eta &gt; 0 )</span>
3491                     <span class="comment">%</span>
3492                     <span class="comment">%  SUPPORT:</span>
3493                     <span class="comment">%   y , -Inf &lt; y &lt; Inf</span>
3494                     <span class="comment">%</span>
3495                     <span class="comment">%  CLASS:</span>
3496                     <span class="comment">%   Continuous symmetric distributions</span>
3497                     <span class="comment">%</span>
3498                     <span class="comment">% USAGE:</span>
3499                     <span class="comment">%   randraw('t', nu, sampleSize) - generate sampleSize number</span>
3500                     <span class="comment">%         of variates from the standard Student's t-distribution with degrees of</span>
3501                     <span class="comment">%         freedom 'nu'</span>
3502                     <span class="comment">%   randraw('t', [nu, chi, eta], sampleSize) - generate sampleSize number</span>
3503                     <span class="comment">%         of variates from the generalized Student's t-distribution with degrees of</span>
3504                     <span class="comment">%         freedom 'nu', location 'chi' and scale parameter 'eta'</span>
3505                     <span class="comment">%   randraw('t') - help for the Student's t-distribution;</span>
3506                     <span class="comment">%</span>
3507                     <span class="comment">% EXAMPLES:</span>
3508                     <span class="comment">%  1.   y = randraw('t', 3, [1 1e5]);</span>
3509                     <span class="comment">%  2.   y = randraw('t', [4, -10, 3], 1, 1e5);</span>
3510                     <span class="comment">%  3.   y = randraw('t', [5, 6.5, 10.5], 1e5 );</span>
3511                     <span class="comment">%  4.   y = randraw('t', [6, 7, 8], [1e5 1] );</span>
3512                     <span class="comment">%  5.   randraw('t');</span>
3513                     <span class="comment">% END studentst HELP END t HELP</span>
3514                     
3515                     <span class="comment">% Method:</span>
3516                     <span class="comment">%</span>
3517                     <span class="comment">% If nu&lt;=100 we utilize the following transformation:</span>
3518                     <span class="comment">%</span>
3519                     <span class="comment">% Y = X/sqrt(Z/nu) ~ Student's-t(nu),</span>
3520                     <span class="comment">% where X~Normal(0,1) and Z~Chi^2(nu);</span>
3521                     <span class="comment">%</span>
3522                     <span class="comment">% Else, we use Normal(0, 1) instead of Student's-t</span>
3523                     <span class="comment">%</span>
3524                     
3525                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Student''s'' t'</span>, <span class="string">'t'</span>, distribParams, [1 3]);
3526                     <span class="keyword">if</span> numel(distribParams)==3
3527                          nu = distribParams(1);
3528                          chi = distribParams(2);
3529                          eta = distribParams(3);
3530                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Student''s'' t'</span>, <span class="string">'t'</span>, <span class="string">'[nu, chi, eta]'</span>, <span class="string">'nu'</span>, nu, {<span class="string">'&gt; 0'</span>,<span class="string">'==integer'</span>});                                                  
3531                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Student''s'' t'</span>, <span class="string">'t'</span>, <span class="string">'[nu, chi, eta]'</span>, <span class="string">'eta'</span>, eta, {<span class="string">'&gt; 0'</span>});
3532                     <span class="keyword">else</span>
3533                          nu = distribParams(1);
3534                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Student''s'' t'</span>, <span class="string">'t'</span>, <span class="string">'nu'</span>, <span class="string">'nu'</span>, nu, {<span class="string">'&gt; 0'</span>,<span class="string">'==integer'</span>});                                                                           
3535                          chi = 0;
3536                          eta = 1;                         
3537                     <span class="keyword">end</span>
3538                     
3539 
3540                     <span class="keyword">if</span> nu &lt;= 100
3541                          chisq = feval(funcName, <span class="string">'chisq'</span>, nu, sampleSize);
3542                          out = chi + eta * sqrt(nu)*randn( sampleSize ) ./ sqrt( chisq );
3543                     <span class="keyword">else</span>
3544                          out = chi + eta * randn( sampleSize );
3545                     <span class="keyword">end</span>
3546 
3547                <span class="keyword">case</span> {<span class="string">'tri'</span>, <span class="string">'triangular'</span>}
3548                     <span class="comment">% START tri HELP START triangular HELP</span>
3549                     <span class="comment">% THE TRIANGULAR DISTRIBUTION</span>
3550                     <span class="comment">%</span>
3551                     <span class="comment">%  pdf  = (a &lt;= y &amp; y &lt;= c) .* ( 2*(y-a)/((b-a)*(c-a)) ) + ...</span>
3552                     <span class="comment">%           (c &lt;  y &amp; y &lt;= b) .* ( 2*(b-y)/((b-a)*(b-c)) ) + ...</span>
3553                     <span class="comment">%            (y &lt; a | y &gt; b) .* 0;</span>
3554                     <span class="comment">%</span>
3555                     <span class="comment">%  cdf =  ( y &lt; a ) .* 0 + ...</span>
3556                     <span class="comment">%           (a &lt;= y &amp; y &lt;= c) .* ( (y-a).^2/((b-a)*(c-a)) ) + ...</span>
3557                     <span class="comment">%           (c &lt;  y &amp; y &lt;= b) .* ( 1- (b-y).^2/((b-a)*(b-c)) ) + ...</span>
3558                     <span class="comment">%            (y &gt; b) .* 1;</span>
3559                     <span class="comment">%</span>
3560                     <span class="comment">%  Mean = 1/3*(a+b+c);</span>
3561                     <span class="comment">%  Variance = 1/18*(a^2+b^2+c^2-a*b-a*c-b*c);</span>
3562                     <span class="comment">%  Skewness = sqrt(2)*(a+b-2*c)*(2*a-b-c)*(a-2*b+c) / (5*(a^2+b^2+c^2-a*b-a*c-b*c)^(3/2));</span>
3563                     <span class="comment">%  Kurtosis = -3/5;</span>
3564                     <span class="comment">%</span>
3565                     <span class="comment">%  PARAMETERS:</span>
3566                     <span class="comment">%    a - lower bound</span>
3567                     <span class="comment">%    c - mode (c&gt;a)</span>
3568                     <span class="comment">%    b - upper bound (b&gt;c&gt;a)</span>
3569                     <span class="comment">%</span>
3570                     <span class="comment">%  SUPPORT:</span>
3571                     <span class="comment">%   y, a &lt;= y &lt;= c</span>
3572                     <span class="comment">%</span>
3573                     <span class="comment">%  CLASS:</span>
3574                     <span class="comment">%   Continuous skewed distributions</span>
3575                     <span class="comment">%</span>
3576                     <span class="comment">% USAGE:</span>
3577                     <span class="comment">%   randraw('tri', [a, c, b], sampleSize) - generate sampleSize number</span>
3578                     <span class="comment">%         of variates from the Triangular distribution with parameters</span>
3579                     <span class="comment">%         'a', 'c' and 'b';</span>
3580                     <span class="comment">%   randraw('tri') - help for the Triangular distribution;</span>
3581                     <span class="comment">%</span>
3582                     <span class="comment">% EXAMPLES:</span>
3583                     <span class="comment">%  1.   y = randraw('tri', [0, 1, 2], [1 1e5]);</span>
3584                     <span class="comment">%  2.   y = randraw('tri', [1, 10, 20], 1, 1e5);</span>
3585                     <span class="comment">%  3.   y = randraw('tri', [0.5, 5, 10.5], 1e5 );</span>
3586                     <span class="comment">%  4.   y = randraw('tri', [2.4, 3.4, 5.4], [1e5 1] );</span>
3587                     <span class="comment">%  5.   randraw('tri');</span>
3588                     <span class="comment">% END tri HELP END triangular HELP</span>
3589 
3590                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Triangular'</span>, <span class="string">'tri'</span>, distribParams, [3]);
3591                     a = distribParams(1);
3592                     c = distribParams(2);
3593                     b = distribParams(3);
3594                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Triangular'</span>, <span class="string">'tri'</span>, <span class="string">'[a, b, c]'</span>, <span class="string">'c-a'</span>, c-a, {<span class="string">'&gt; 0'</span>});
3595                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Triangular'</span>, <span class="string">'tri'</span>, <span class="string">'[a, b, c]'</span>, <span class="string">'b-c'</span>, b-c, {<span class="string">'&gt; 0'</span>});
3596                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Triangular'</span>, <span class="string">'tri'</span>, <span class="string">'[a, b, c]'</span>, <span class="string">'b-a'</span>, b-a, {<span class="string">'&gt; 0'</span>});
3597                     
3598                     t = (c-a) / (b-a);
3599                     u1 = rand( sampleSize );
3600                     out = a + (b-a) * <span class="keyword">...</span>
3601                          ((u1 &lt;= t) .* sqrt( t*u1 ) + (u1 &gt; t) .* ( 1 - sqrt((1-t)*(1-u1)) ));
3602 
3603                <span class="keyword">case</span> {<span class="string">'tukeylambda'</span>}
3604                     <span class="comment">% START tukeylambda HELP</span>
3605                     <span class="comment">% THE TUKEY-LAMBDA DISTRIBUTION</span>
3606                     <span class="comment">%</span>
3607                     <span class="comment">% The Tukey-Lambda Distribution with shape parameter lambda.</span>
3608                     <span class="comment">%</span>
3609                     <span class="comment">% The Tukey-Lambda distribution does not have a simple closed form</span>
3610                     <span class="comment">% for either the probability density function or the cumulative</span>
3611                     <span class="comment">% distribution function. The cumulative distribution function is</span>
3612                     <span class="comment">% calculated numerically. Some special cases are:</span>
3613                     <span class="comment">% lambda = -1 - approximately Cauchy;</span>
3614                     <span class="comment">% lambda = 0 - exactly logistic;</span>
3615                     <span class="comment">% lambda = 0.14 - approximately normal;</span>
3616                     <span class="comment">% lambda = 0.5 - U-shaped;</span>
3617                     <span class="comment">% lambda= 1 - exactly uniform.</span>
3618                     <span class="comment">%</span>
3619                     <span class="comment">% PARAMETERS:</span>
3620                     <span class="comment">%    lambda - shape parameter</span>
3621                     <span class="comment">%</span>
3622                     <span class="comment">% SUPPORT:</span>
3623                     <span class="comment">%    y,   -1/lambdal &lt;= y &lt;= 1/lambda</span>
3624                     <span class="comment">%</span>
3625                     <span class="comment">% CLASS:</span>
3626                     <span class="comment">%   Continuous symmetric distributions</span>
3627                     <span class="comment">%</span>
3628                     <span class="comment">% USAGE:</span>
3629                     <span class="comment">%   randraw('tukeylambda', lambda, sampleSize) - generate sampleSize number</span>
3630                     <span class="comment">%         of variates from the Tukey-Lambda distribution with shale parameter</span>
3631                     <span class="comment">%         'lambda';</span>
3632                     <span class="comment">%   randraw('tukeylambda') - help for the Tukey-Lambda distribution;</span>
3633                     <span class="comment">%</span>
3634                     <span class="comment">% EXAMPLES:</span>
3635                     <span class="comment">%  1.   y = randraw('tukeylambda', -1, [1 1e5]);</span>
3636                     <span class="comment">%  2.   y = randraw('tukeylambda', 0, 1, 1e5);</span>
3637                     <span class="comment">%  3.   y = randraw('tukeylambda', 0.14, 1e5 );</span>
3638                     <span class="comment">%  4.   y = randraw('tukeylambda', 0.5, [1e5 1] );</span>
3639                     <span class="comment">%  5.   randraw('tukeylambda');</span>
3640                     <span class="comment">% END tukeylambda HELP</span>
3641                     
3642                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Tukey-Lambda'</span>, <span class="string">'tukeylambda'</span>, distribParams, [1]);
3643                     lambda = distribParams(1);
3644                     <span class="keyword">if</span> lambda ~= 0
3645                          u = rand( sampleSize );
3646                          out = (u.^lambda - (1-u).^lambda) / lambda;
3647                     <span class="keyword">else</span>
3648                          out = feval(funcName,<span class="string">'logistic'</span>, [0 1], sampleSize);
3649                     <span class="keyword">end</span>
3650                     
3651                <span class="keyword">case</span> {<span class="string">'u'</span>, <span class="string">'ushape'</span>}
3652                     <span class="comment">% START u HELP  START ushape HELP</span>
3653                     <span class="comment">% THE U DISTRIBUTION</span>
3654                     <span class="comment">%   ( U-shape distribution )</span>
3655                     <span class="comment">%</span>
3656                     <span class="comment">% Standard form of the U distribution:</span>
3657                     <span class="comment">%</span>
3658                     <span class="comment">%   pdf(y) = 1./(pi*sqrt(1-y.^2)); -1&lt;=y&lt;=1;</span>
3659                     <span class="comment">%   cdf(y) = 1/2 + 1/pi*asin(y); -1&lt;=y&lt;=1;</span>
3660                     <span class="comment">%</span>
3661                     <span class="comment">%  Mean = 0;</span>
3662                     <span class="comment">%  Variance = 1/2;</span>
3663                     <span class="comment">%</span>
3664                     <span class="comment">% General form of the U distribution:</span>
3665                     <span class="comment">%</span>
3666                     <span class="comment">%   pdf(y) = 1./(pi*sqrt(s^2-(y-t).^2));  t-s&lt;=y&lt;=t+s; s&gt;0</span>
3667                     <span class="comment">%   cdf(y) = 1/2 + 1/pi*asin((y-t)/a); -1&lt;=y&lt;=1;</span>
3668                     <span class="comment">%</span>
3669                     <span class="comment">%  Mean = t;</span>
3670                     <span class="comment">%  Variance = s^2/2;</span>
3671                     <span class="comment">%</span>
3672                     <span class="comment">% PARAMETERS:</span>
3673                     <span class="comment">%   t - location</span>
3674                     <span class="comment">%   s -scale; s&gt;0</span>
3675                     <span class="comment">%</span>
3676                     <span class="comment">% SUPPORT:</span>
3677                     <span class="comment">%   y,   -1 &lt;= y &lt;= 1   - standard U distribution</span>
3678                     <span class="comment">%    or</span>
3679                     <span class="comment">%   y,   t-s &lt;= y &lt;= t+s  - generalized U distribution</span>
3680                     <span class="comment">%</span>
3681                     <span class="comment">% CLASS:</span>
3682                     <span class="comment">%   Continuous symmetric distributions</span>
3683                     <span class="comment">%</span>
3684                     <span class="comment">% USAGE:</span>
3685                     <span class="comment">%   randraw('u', [], sampleSize) - generate sampleSize number</span>
3686                     <span class="comment">%         of variates from standard U distribution;</span>
3687                     <span class="comment">%   randraw('u', [t, s], sampleSize) - generate sampleSize number</span>
3688                     <span class="comment">%         of variates from generalized U distribution</span>
3689                     <span class="comment">%         with location parameter 't' and scale parameter 's';</span>
3690                     <span class="comment">%   randraw('u') - help for U distribution;</span>
3691                     <span class="comment">%</span>
3692                     <span class="comment">% EXAMPLES:</span>
3693                     <span class="comment">%  1.   y = randraw('u', [], [1 1e5]);</span>
3694                     <span class="comment">%  2.   y = randraw('u', [], 1, 1e5);</span>
3695                     <span class="comment">%  3.   y = randraw('u', [], 1e5 );</span>
3696                     <span class="comment">%  4.   y = randraw('u', [10 3], [1e5 1] );</span>
3697                     <span class="comment">%  5.   randraw('u');</span>
3698                     <span class="comment">%</span>
3699                     <span class="comment">% SEE ALSO:</span>
3700                     <span class="comment">%    ARCSIN distribution</span>
3701                     <span class="comment">% END u HELP END ushape HELP</span>
3702                     
3703                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'U'</span>, <span class="string">'u'</span>, distribParams, [0, 2]);  
3704                     <span class="keyword">if</span> numel(distribParams)==2
3705                          t  = distribParams(1);
3706                          s  = distribParams(2);  
3707                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'U'</span>, <span class="string">'u'</span>, <span class="string">'[t, s]'</span>, <span class="string">'s'</span>, s, {<span class="string">'&gt; 0'</span>});
3708                     <span class="keyword">else</span>
3709                          t = 0;
3710                          s = 1;                        
3711                     <span class="keyword">end</span>   
3712                     
3713                     out = t + s * sin(pi*(rand(sampleSize)-0.5));
3714                     
3715                <span class="keyword">case</span> {<span class="string">'uniform'</span>, <span class="string">'unif'</span>}
3716                     <span class="comment">% START uniform HELP START unif HELP</span>
3717                     <span class="comment">% THE UNIFORM DISTRIBUTION</span>
3718                     <span class="comment">%</span>
3719                     <span class="comment">% pdf = 1/(b-a);</span>
3720                     <span class="comment">% cdf = (y-a)/(b-a);</span>
3721                     <span class="comment">%</span>
3722                     <span class="comment">%  Mean = (a+b)/2;</span>
3723                     <span class="comment">%  Variance = (b-a)^2/12;</span>
3724                     <span class="comment">%</span>
3725                     <span class="comment">% PARAMETERS:</span>
3726                     <span class="comment">%   a is location of y (lower bound);</span>
3727                     <span class="comment">%   b is scale of y (upper bound)  (b &gt; a);</span>
3728                     <span class="comment">%</span>
3729                     <span class="comment">% SUPPORT:</span>
3730                     <span class="comment">%   y,  a &lt; y &lt; b</span>
3731                     <span class="comment">%</span>
3732                     <span class="comment">% CLASS:</span>
3733                     <span class="comment">%  Continuous symmetric distributions</span>
3734                     <span class="comment">%</span>
3735                     <span class="comment">% USAGE:</span>
3736                     <span class="comment">%   randraw('uniform', [], sampleSize) - generate sampleSize number</span>
3737                     <span class="comment">%         of variates from standard Uniform distribution (a=0, b=1);</span>
3738                     <span class="comment">%   randraw('uniform', [a, b], sampleSize) - generate sampleSize number</span>
3739                     <span class="comment">%         of variates from the Uniform distribution</span>
3740                     <span class="comment">%         with parameters 'a' and 'b';</span>
3741                     <span class="comment">%   randraw('uniform') - help for the Uniform distribution;</span>
3742                     <span class="comment">%</span>
3743                     <span class="comment">% EXAMPLES:</span>
3744                     <span class="comment">%  1.   y = randraw('uniform', [], [1 1e5]);</span>
3745                     <span class="comment">%  2.   y = randraw('uniform', [2, 3], 1, 1e5);</span>
3746                     <span class="comment">%  3.   y = randraw('uniform', [5, 6], 1e5 );</span>
3747                     <span class="comment">%  4.   y = randraw('uniform', [10.5, 11.5], [1e5 1] );</span>
3748                     <span class="comment">%  5.   randraw('uniform');</span>
3749                     <span class="comment">% END uniform HELP END unif HELP</span>
3750                     
3751                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Uniform'</span>, <span class="string">'uniform'</span>, distribParams, [0, 2]);  
3752                     <span class="keyword">if</span> numel(distribParams)==2
3753                          a  = distribParams(1);
3754                          b  = distribParams(2);  
3755                          <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Uniform'</span>, <span class="string">'uniform'</span>, <span class="string">'[a, b]'</span>, <span class="string">'b-a'</span>, b-a, {<span class="string">'&gt; 0'</span>});
3756                     <span class="keyword">else</span>
3757                          a = 0;
3758                          b = 1;                        
3759                     <span class="keyword">end</span>   
3760                     
3761                     out = a + (b-a)*rand( sampleSize );
3762 
3763                <span class="keyword">case</span> {<span class="string">'vonmises'</span>}
3764                     <span class="comment">% START vonmises HELP</span>
3765                     <span class="comment">% THE VON MISES DISTRIBUTION</span>
3766                     <span class="comment">% A continuous distribution defined on the range [0, 2*pi)</span>
3767                     <span class="comment">% with probability density function:</span>
3768                     <span class="comment">%</span>
3769                     <span class="comment">%  pdf(y) = exp(k*cos(y-a)) ./ (2*pi*besseli(0,k));</span>
3770                     <span class="comment">%</span>
3771                     <span class="comment">%  where besseli(0,x) is a modified Bessel function of the</span>
3772                     <span class="comment">%  first kind of order 0.</span>
3773                     <span class="comment">%  Here,  'a' (a&gt;=0 and a&lt;2*pi) is the mean direction and k &gt; 0 is a</span>
3774                     <span class="comment">%  concentration parameter</span>
3775                     <span class="comment">%  The von Mises distribution is the circular analog of the normal</span>
3776                     <span class="comment">%  distribution on a line.</span>
3777                     <span class="comment">%</span>
3778                     <span class="comment">%  Mean = a;</span>
3779                     <span class="comment">%</span>
3780                     <span class="comment">%  PARAMETERS:</span>
3781                     <span class="comment">%    a - location parameter, (a&gt;=0 and a&lt;2*pi)</span>
3782                     <span class="comment">%    k - shape parameter,  (k&gt;0)</span>
3783                     <span class="comment">%</span>
3784                     <span class="comment">%  SUPPORT:</span>
3785                     <span class="comment">%    y,  -pi &lt; y &lt; pi</span>
3786                     <span class="comment">%</span>
3787                     <span class="comment">%  CLASS:</span>
3788                     <span class="comment">%     Continuous distribution</span>
3789                     <span class="comment">%</span>
3790                     <span class="comment">% USAGE:</span>
3791                     <span class="comment">%   randraw('vonmises', [a, k], sampleSize) - generate sampleSize number</span>
3792                     <span class="comment">%         of variates from the von Mises distribution with parameters 'a' and 'k';</span>
3793                     <span class="comment">%   randraw('vonmises') - help for the von Mises distribution;</span>
3794                     <span class="comment">%</span>
3795                     <span class="comment">% EXAMPLES:</span>
3796                     <span class="comment">%  1.   y = randraw('vonmises', [pi/2, 3], [1 1e5]);</span>
3797                     <span class="comment">%  2.   y = randraw('vonmises', [2*pi/3, 2], 1, 1e5);</span>
3798                     <span class="comment">%  3.   y = randraw('vonmises', [pi/4, 10], 1e5 );</span>
3799                     <span class="comment">%  4.   y = randraw('vonmises', [pi, 2.2], [1e5 1] );</span>
3800                     <span class="comment">%  5.   randraw('vonmises');</span>
3801                     <span class="comment">% END vonmises HELP</span>
3802                     
3803                     <span class="comment">%  Method:</span>
3804                     <span class="comment">%   1) For large k (say, k&gt;700) von Mises distribution tends</span>
3805                     <span class="comment">%      to a Normal Distribution with variance 1/?</span>
3806                     <span class="comment">%   2) For a small k we implement method suggested in:</span>
3807                     <span class="comment">%      L. Yuan and J.D. Kalbleisch, &quot;On the Bessel distribution and</span>
3808                     <span class="comment">%      related problems,&quot; Annals of the Institute of Statistical</span>
3809                     <span class="comment">%      Mathematics, vol. 52, pp. 438-447, 2000</span>
3810                     <span class="comment">%      and described in:</span>
3811                     <span class="comment">%      Luc Devroye, &quot;Simulating Bessel Random Variables,&quot;</span>
3812                     <span class="comment">%      Statistics and Probability Letters, vol. 57, pp. 249-257, 2002.</span>
3813                     <span class="comment">%</span>
3814 
3815 
3816                     a = distribParams(1);
3817                     k = distribParams(2);
3818 
3819                     <span class="keyword">if</span> k &gt; 700
3820                          <span class="comment">% for large k it tends to a Normal Distribution with variance 1/k</span>
3821                          out = a + sqrt(1/k)*randn( sampleSize );
3822                     <span class="keyword">else</span>
3823                          <span class="comment">% Generate X &lt;- Bessel(0,k)</span>
3824                          x = feval(funcName,<span class="string">'bessel'</span>, [0 k], sampleSize);
3825 
3826                          <span class="comment">% Generate B &lt;- beta(X+1/2, 1/2);</span>
3827                          u2 = rand( sampleSize );
3828                          l = (x&gt;0);
3829                          d1 = (cos(2*pi*u2(l))).^2;
3830                          d2 = (cos(pi*u2(~l))).^2;
3831                          clear(<span class="string">'u2'</span>);
3832                          t = 2./(2*(x(l)+0.5)-1);
3833                          clear(<span class="string">'x'</span>);
3834                          b = zeros( sampleSize );
3835                          u1 = rand(sum(l(:)),1);
3836                          b(l) = 1 - (1-u1.^t(:)) .* d1(:);
3837                          clear(<span class="string">'t'</span>);
3838                          b(~l) = d2;
3839                          clear(<span class="string">'d1'</span>);
3840                          clear(<span class="string">'d2'</span>);
3841 
3842                          <span class="comment">% if U &lt; 1/(1+exp(-2*k*sqrt(B))),</span>
3843                          <span class="comment">%       then return S*acos(sqrt(B))</span>
3844                          <span class="comment">%       else return S*acos(-sqrt(B))</span>
3845                          <span class="comment">%     where S is a random sign</span>
3846                          l = rand(sampleSize) &lt; 1./(1+exp(-2*k*sqrt(b)));
3847                          out = zeros( sampleSize );
3848                          out(l) = acos(sqrt(b(l)));
3849                          out(~l) = acos(-sqrt(b(~l)));
3850                          clear(<span class="string">'b'</span>);
3851                          clear(<span class="string">'l'</span>);
3852 
3853                          out = a + (2*round(rand(sampleSize))-1) .* out;
3854                     <span class="keyword">end</span>
3855 
3856                <span class="keyword">case</span> {<span class="string">'wald'</span>}
3857                     <span class="comment">% START wald HELP</span>
3858                     <span class="comment">% THE WALD DISTRIBUTION</span>
3859                     <span class="comment">%</span>
3860                     <span class="comment">% The Wald distribution is as special case of the Inverse Gaussian Distribution</span>
3861                     <span class="comment">% where the mean is a constant with the value one.</span>
3862                     <span class="comment">%</span>
3863                     <span class="comment">% pdf = sqrt(chi/(2*pi*y^3)) * exp(-chi./(2*y).*(y-1).^2);</span>
3864                     <span class="comment">%</span>
3865                     <span class="comment">% Mean     = 1;</span>
3866                     <span class="comment">% Variance = 1/chi;</span>
3867                     <span class="comment">% Skewness = sqrt(9/chi);</span>
3868                     <span class="comment">% Kurtosis = 3+ 15/scale;</span>
3869                     <span class="comment">%</span>
3870                     <span class="comment">% PARAMETERS:</span>
3871                     <span class="comment">%  chi - scale parameter; (chi&gt;0)</span>
3872                     <span class="comment">%</span>
3873                     <span class="comment">% SUPPORT:</span>
3874                     <span class="comment">%  y,  y&gt;0</span>
3875                     <span class="comment">%</span>
3876                     <span class="comment">% CLASS:</span>
3877                     <span class="comment">%   Continuous skewed distributions</span>
3878                     <span class="comment">%</span>
3879                     <span class="comment">% USAGE:</span>
3880                     <span class="comment">%   randraw('wald', chi, sampleSize) - generate sampleSize number</span>
3881                     <span class="comment">%         of variates from the Wald distribution with scale parameter 'chi';</span>
3882                     <span class="comment">%   randraw('wald') - help for the Wald distribution;</span>
3883                     <span class="comment">%</span>
3884                     <span class="comment">% EXAMPLES:</span>
3885                     <span class="comment">%  1.   y = randraw('wald', 0.5, [1 1e5]);</span>
3886                     <span class="comment">%  2.   y = randraw('wald', 1, 1, 1e5);</span>
3887                     <span class="comment">%  3.   y = randraw('wald', 1.5, 1e5 );</span>
3888                     <span class="comment">%  4.   y = randraw('wald', 2, [1e5 1] );</span>
3889                     <span class="comment">%  5.   randraw('wald');</span>
3890                     <span class="comment">% END wald HELP</span>
3891                                         
3892                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Wald'</span>, <span class="string">'wald'</span>, distribParams, [1]);
3893                     chi = distribParams(1);
3894                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Wald'</span>, <span class="string">'wald'</span>, <span class="string">'chi'</span>, <span class="string">'chi'</span>, chi, {<span class="string">'&gt; 0'</span>});
3895                     
3896                     out = feval(funcName, <span class="string">'ig'</span>, [1 chi], sampleSize);
3897 
3898                <span class="keyword">case</span> {<span class="string">'weibull'</span>, <span class="string">'frechet'</span>, <span class="string">'wbl'</span>} 
3899                     <span class="comment">% START weibull HELP START frechet HELP START wbl HELP</span>
3900                     <span class="comment">%  THE WEIBULL DISTRIBUTION</span>
3901                     <span class="comment">%  ( sometimes: Frechet distribution )</span>
3902                     <span class="comment">%</span>
3903                     <span class="comment">%  cdf = 1 - exp(-((y-theta)/beta).^alpha)</span>
3904                     <span class="comment">%  pdf = alpha / beta * ((y-theta)/beta).^(alpha-1) .* exp(-((y-theta)/beta).^alpha);</span>
3905                     <span class="comment">%</span>
3906                     <span class="comment">%  Mean = theta + beta*gamma((alpha+1)/alpha);</span>
3907                     <span class="comment">%  Variance = beta^2 * ( gamma((alpha+2)/alpha) - gamma((alpha+1)/alpha)^2 );</span>
3908                     <span class="comment">%       where gamma is the gamma function</span>
3909                     <span class="comment">%</span>
3910                     <span class="comment">% PARAMETERS:</span>
3911                     <span class="comment">%   theta - location parameter;</span>
3912                     <span class="comment">%   alpha - shape parameter ( alpha&gt;0 );</span>
3913                     <span class="comment">%   beta  - scale parameter ( beta&gt;0 );</span>
3914                     <span class="comment">%</span>
3915                     <span class="comment">% SUPPORT:</span>
3916                     <span class="comment">%   y,  y &gt; theta</span>
3917                     <span class="comment">%</span>
3918                     <span class="comment">% CLASS:</span>
3919                     <span class="comment">%   Continuous skewed distributions</span>
3920                     <span class="comment">%</span>
3921                     <span class="comment">% NOTES:</span>
3922                     <span class="comment">%   If alpha=1 , it is the exponential distribution</span>
3923                     <span class="comment">%   If beta=1; alpha=2, theta=0; it is the standard Rayleigh distribution (sigma=1)</span>
3924                     <span class="comment">%</span>
3925                     <span class="comment">% USAGE:</span>
3926                     <span class="comment">%   randraw('weibull', [theta, alpha, beta], sampleSize) - generate sampleSize number</span>
3927                     <span class="comment">%         of variates from the Weibull distribution with location parameter 'theta',</span>
3928                     <span class="comment">%         shape parameter 'alpha' and scale parameter 'beta';</span>
3929                     <span class="comment">%   randraw('weibull') - help for the Weibull distribution;</span>
3930                     <span class="comment">%</span>
3931                     <span class="comment">% EXAMPLES:</span>
3932                     <span class="comment">%  1.   y = randraw('weibull', [-10, 2, 3], [1 1e5]);</span>
3933                     <span class="comment">%  2.   y = randraw('weibull', [0, 2, 1], 1, 1e5);</span>
3934                     <span class="comment">%  3.   y = randraw('weibull', [0, 1, 2], 1e5 );</span>
3935                     <span class="comment">%  4.   y = randraw('weibull', [2.1, 5.4, 10.2], [1e5 1] );</span>
3936                     <span class="comment">%  5.   randraw('weibull');</span>
3937                     <span class="comment">% END weibull HELP END frechet HELP END wbl HELP</span>
3938 
3939                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Weibull'</span>, <span class="string">'weibull'</span>, distribParams, [3]);
3940                     theta = distribParams(1);
3941                     alpha = distribParams(2);
3942                     beta  = distribParams(3);
3943                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Weibull'</span>, <span class="string">'weibull'</span>, <span class="string">'[theta, alpha, beta]'</span>, <span class="string">'alpha'</span>, alpha, {<span class="string">'&gt; 0'</span>});
3944                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Weibull'</span>, <span class="string">'weibull'</span>, <span class="string">'[theta, alpha, beta]'</span>, <span class="string">'beta'</span>, beta, {<span class="string">'&gt; 0'</span>});                    
3945                     
3946                     out = theta + beta * (-log(rand( sampleSize ))).^(1/alpha);
3947 
3948                <span class="keyword">case</span> {<span class="string">'yule'</span>, <span class="string">'yulesimon'</span>}
3949                     <span class="comment">% START yule HELP START yulesimon HELP</span>
3950                     <span class="comment">% THE YULE-SIMON DISTRIBUTION</span>
3951                     <span class="comment">%</span>
3952                     <span class="comment">%  pmf(y) = (p-1)*beta(y, p); p&gt;1; y = 1, 2, 3, 4, ...</span>
3953                     <span class="comment">%  cdf(y) = 1-(y+1).*beta(y+1,p);</span>
3954                     <span class="comment">%</span>
3955                     <span class="comment">%  Mean = (p-1)/(p-2); for p&gt;2;</span>
3956                     <span class="comment">%  Variance = (p-1)^2/((p-2)^2*(p-3)); for p&gt;3;</span>
3957                     <span class="comment">%</span>
3958                     <span class="comment">%  PARAMETERS:</span>
3959                     <span class="comment">%    p,  p&gt;1</span>
3960                     <span class="comment">%</span>
3961                     <span class="comment">%  SUPPORT:</span>
3962                     <span class="comment">%    y,  y = 1, 2, 3, 4, ...</span>
3963                     <span class="comment">%</span>
3964                     <span class="comment">%  CLASS:</span>
3965                     <span class="comment">%    Discrete distributions</span>
3966                     <span class="comment">%</span>
3967                     <span class="comment">%  NOTES:</span>
3968                     <span class="comment">%    1. It is named after George Udny Yule and Herbert Simon.</span>
3969                     <span class="comment">%       Simon originally called it the Yule distribution.</span>
3970                     <span class="comment">%    2. The probability mass function pmf(y) has the property that</span>
3971                     <span class="comment">%       for sufficiently large y we have</span>
3972                     <span class="comment">%        pmf(y) = (p-1)*gamma(p)./y.^p;</span>
3973                     <span class="comment">%       This means that the tail of the Yule-Simon distribution is a</span>
3974                     <span class="comment">%       realization of Zipf's law: pmf(y) can be used to model,</span>
3975                     <span class="comment">%       for example, the relative frequency of the y'th most frequent</span>
3976                     <span class="comment">%       word in a large collection of text, which according to Zipf's law</span>
3977                     <span class="comment">%       is inversely proportional to a (typically small) power of y.</span>
3978                     <span class="comment">%</span>
3979                     <span class="comment">% USAGE:</span>
3980                     <span class="comment">%   randraw('yule', p, sampleSize) - generate sampleSize number</span>
3981                     <span class="comment">%         of variates from the Yule-Simon distribution with parameter 'p';</span>
3982                     <span class="comment">%   randraw('yule') - help for the Yule-Simon distribution;</span>
3983                     <span class="comment">%</span>
3984                     <span class="comment">% EXAMPLES:</span>
3985                     <span class="comment">%  1.   y = randraw('yule', 2, [1 1e5]);</span>
3986                     <span class="comment">%  2.   y = randraw('yule', 3.2, 1, 1e5);</span>
3987                     <span class="comment">%  3.   y = randraw('yule', 100.5, 1e5 );</span>
3988                     <span class="comment">%  4.   y = randraw('yule', 33, [1e5 1] );</span>
3989                     <span class="comment">%  5.   randraw('yule');</span>
3990                     <span class="comment">% END yule HELP END yulesimon HELP</span>
3991                     
3992                     <span class="comment">% Rference:</span>
3993                     <span class="comment">%    Luc Devroye,</span>
3994                     <span class="comment">%    &quot;Non-Uniform Random Variate Generation,&quot;</span>
3995                     <span class="comment">%    Springer Verlag, 1986, pages 550-551.</span>
3996                     
3997                     <a href="#_sub1" class="code" title="subfunction checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)">checkParamsNum</a>(funcName, <span class="string">'Yule-Simon'</span>, <span class="string">'yule'</span>, distribParams, [1]);
3998                     p = distribParams(1);
3999                     <a href="#_sub2" class="code" title="subfunction validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)">validateParam</a>(funcName, <span class="string">'Yule-Simon'</span>, <span class="string">'yule'</span>, <span class="string">'p'</span>, <span class="string">'p'</span>, p, {<span class="string">'&gt; 1'</span>});
4000                                         
4001                     out = ceil( log(rand(sampleSize)) ./ log(1-exp(log(rand(sampleSize))/(p-1))) ); 
4002                     
4003                <span class="keyword">case</span> {<span class="string">'zeta'</span>, <span class="string">'zipf'</span>}
4004                     <span class="comment">% START zeta HELP  START zipf HELP</span>
4005                     <span class="comment">% ZETA DISTRIBUTION</span>
4006                     <span class="comment">%   (sometimes: Zipf distribution)</span>
4007                     <span class="comment">%</span>
4008                     <span class="comment">%  pmf(n) = 1. / (n^a * zeta(a)),</span>
4009                     <span class="comment">%    where zeta(s) is a Riemann Zeta function:</span>
4010                     <span class="comment">%         sum from i=1 to Inf of 1/i^a</span>
4011                     <span class="comment">%    a&gt;1</span>
4012                     <span class="comment">%</span>
4013                     <span class="comment">%  Mean = zeta(a-1)/zeta(a), for a&gt;2</span>
4014                     <span class="comment">%  Variance = zeta(a-2)/zeta(a) - (zeta(a-1)/zeta(a))^2;</span>
4015                     <span class="comment">%</span>
4016                     <span class="comment">% PARAMETERS:</span>
4017                     <span class="comment">%   a &gt; 1</span>
4018                     <span class="comment">%</span>
4019                     <span class="comment">% SUPPORT:</span>
4020                     <span class="comment">%   n = 1, 2, 3, ... (positive integers)</span>
4021                     <span class="comment">%</span>
4022                     <span class="comment">% CLASS:</span>
4023                     <span class="comment">%   Discrete distributions</span>
4024                     <span class="comment">%</span>
4025                     <span class="comment">% NOTES:</span>
4026                     <span class="comment">% The zeta distribution is a long-tailed distribution that is useful for</span>
4027                     <span class="comment">% size-frequency data. It is sometimes used in insurance as a model for</span>
4028                     <span class="comment">% the number of policies held by a single person in an insurance portfolio.</span>
4029                     <span class="comment">% It is also used for the analysis of the frequency of words in long</span>
4030                     <span class="comment">% sequences of text. When used in linguistics the zeta distribution is</span>
4031                     <span class="comment">% known as the Zipf distribution.</span>
4032                     <span class="comment">%</span>
4033                     <span class="comment">% USAGE:</span>
4034                     <span class="comment">%   randraw('zeta', a, sampleSize) - generate sampleSize number</span>
4035                     <span class="comment">%         of variates from standard Zeta distribution with parameter a;</span>
4036                     <span class="comment">%   randraw('zeta') - help for Zeta distribution;</span>
4037                     <span class="comment">%</span>
4038                     <span class="comment">% EXAMPLES:</span>
4039                     <span class="comment">%  1.   y = randraw('zeta', 2, [1 1e5]);</span>
4040                     <span class="comment">%  2.   y = randraw('zeta', 3.5, 1, 1e5);</span>
4041                     <span class="comment">%  3.   y = randraw('zeta', 10, 1e5 );</span>
4042                     <span class="comment">%  4.   y = randraw('zeta', 100, [1e5 1] );</span>
4043                     <span class="comment">%  5.   randraw('zeta');</span>
4044                     <span class="comment">% END zeta HELP  END zipf HELP</span>
4045                     
4046                     <span class="comment">%  Reference:</span>
4047                     <span class="comment">%    Luc Devroye,</span>
4048                     <span class="comment">%    &quot;Non-Uniform Random Variate Generation,&quot;</span>
4049                     <span class="comment">%    Springer Verlag, 1986, pages 550-551.</span>
4050 
4051                     a = distribParams(1);
4052 
4053                     b = 2^(a-1);
4054                     am1 = a - 1;
4055                     bm1 = b - 1;
4056 
4057                     u1 = rand( sampleSize );
4058                     out = floor( u1.^(-1/am1) );
4059                     clear(<span class="string">'u1'</span>);
4060                     u2 = rand( sampleSize );
4061                     t = ( 1 + 1./out ).^(a-1);
4062 
4063                     indxs = find( u2.*out.*(t-1)/bm1 &gt; t/b );
4064 
4065                     <span class="keyword">while</span> ~isempty(indxs)
4066                          indxsSize = size( indxs );
4067                          u1 = rand( indxsSize );
4068                          outNew = floor( u1.^(-1/am1) );
4069                          clear(<span class="string">'u1'</span>);
4070                          u2 = rand( indxsSize );
4071                          t = ( 1 + 1./outNew ).^(a-1);
4072 
4073                          l = u2.*outNew.*(t-1)/bm1 &lt;= t/b;
4074 
4075                          out( indxs(l) ) = outNew(l);
4076                          indxs = indxs(~l);
4077                     <span class="keyword">end</span>
4078 
4079                <span class="keyword">otherwise</span>
4080                     fprintf(<span class="string">'\n RANDRAW: Unknown distribution name: %s \n'</span>, distribName);
4081                     
4082           <span class="keyword">end</span> <span class="comment">% switch lower( distribNameInner )</span>
4083           
4084      <span class="keyword">end</span> <span class="comment">% if prod(sampleSize)&gt;0</span>
4085 
4086      varargout{1} = out;
4087 
4088      <span class="keyword">return</span>;
4089 
4090 <span class="keyword">end</span> <span class="comment">% if strcmp(runMode, 'genRun')</span>
4091 
4092 <span class="keyword">return</span>;
4093 
4094 
4095 <a name="_sub1" href="#_subfunctions" class="code">function checkParamsNum(funcName, distribName, runDistribName, distribParams, correctNum)</a>
4096 <span class="keyword">if</span> ~any( numel(distribParams) == correctNum )
4097      error(<span class="string">'%s Variates Generation:\n %s%s%s%s%s'</span>, <span class="keyword">...</span>
4098           distribName, <span class="keyword">...</span>
4099           <span class="string">'Wrong numebr of parameters (run '</span>,<span class="keyword">...</span>
4100           funcName, <span class="keyword">...</span>
4101           <span class="string">'('''</span>, <span class="keyword">...</span>
4102           runDistribName, <span class="keyword">...</span>
4103           <span class="string">''') for help) '</span>);
4104 <span class="keyword">end</span>
4105 <span class="keyword">return</span>;
4106 
4107 
4108 <a name="_sub2" href="#_subfunctions" class="code">function validateParam(funcName, distribName, runDistribName, distribParamsName, paramName, param, conditionStr)</a>
4109 condLogical = 1;
4110 eqCondStr = [];
4111 <span class="keyword">for</span> nn = 1:length(conditionStr)
4112      <span class="keyword">if</span> nn==1
4113           eqCondStr = [eqCondStr conditionStr{nn}];
4114      <span class="keyword">else</span>
4115           eqCondStr = [eqCondStr <span class="string">' and '</span> conditionStr{nn}];          
4116      <span class="keyword">end</span>
4117      eqCond = conditionStr{nn}(1:2);
4118      eqCond = eqCond(~isspace(eqCond));
4119      <span class="keyword">switch</span> eqCond
4120           <span class="keyword">case</span>{<span class="string">'&lt;'</span>}
4121                condLogical = condLogical &amp; (param&lt;str2num(conditionStr{nn}(3:end)));
4122           <span class="keyword">case</span>{<span class="string">'&lt;='</span>}
4123                condLogical = condLogical &amp; (param&lt;=str2num(conditionStr{nn}(3:end)));               
4124           <span class="keyword">case</span>{<span class="string">'&gt;'</span>}
4125                condLogical = condLogical &amp; (param&gt;str2num(conditionStr{nn}(3:end))); 
4126           <span class="keyword">case</span>{<span class="string">'&gt;='</span>}
4127                condLogical = condLogical &amp; (param&gt;=str2num(conditionStr{nn}(3:end)));
4128           <span class="keyword">case</span>{<span class="string">'~='</span>}
4129                condLogical = condLogical &amp; (param~=str2num(conditionStr{nn}(3:end)));
4130           <span class="keyword">case</span>{<span class="string">'=='</span>}
4131                <span class="keyword">if</span> strcmp(conditionStr{nn}(3:end),<span class="string">'integer'</span>)
4132                     condLogical = condLogical &amp; (param==floor(param));                    
4133                <span class="keyword">else</span>
4134                     condLogical = condLogical &amp; (param==str2num(conditionStr{nn}(3:end)));
4135                <span class="keyword">end</span>
4136      <span class="keyword">end</span>
4137 <span class="keyword">end</span>
4138 
4139 <span class="keyword">if</span> ~condLogical
4140      error(<span class="string">'%s Variates Generation: %s(''%s'',%s, SampleSize);\n Parameter %s should be %s\n (run %s(''%s'') for help)'</span>, <span class="keyword">...</span>
4141           distribName, <span class="keyword">...</span>
4142           funcName, <span class="keyword">...</span>
4143           runDistribName, <span class="keyword">...</span>
4144           distribParamsName, <span class="keyword">...</span>
4145           paramName, <span class="keyword">...</span>
4146           eqCondStr, <span class="keyword">...</span>
4147           funcName, <span class="keyword">...</span>
4148           runDistribName);
4149 <span class="keyword">end</span>
4150 <span class="keyword">return</span>;
4151 
4152 <a name="_sub3" href="#_subfunctions" class="code">function cdf = normcdf(y)</a>
4153 cdf = 0.5*(1+erf(y/sqrt(2)));
4154 <span class="keyword">return</span>;
4155 
4156 <a name="_sub4" href="#_subfunctions" class="code">function pdf = normpdf(y)</a>
4157 pdf = 1/sqrt(2*pi) * exp(-1/2*y.^2);
4158 <span class="keyword">return</span>;
4159 
4160 <a name="_sub5" href="#_subfunctions" class="code">function cdfinv = norminv(y)</a>
4161 cdfinv = sqrt(2) * erfinv(2*y - 1);
4162 <span class="keyword">return</span>;
4163 
4164 <a name="_sub6" href="#_subfunctions" class="code">function out = randFrom5Tbls( P, offset, sampleSize)</a>
4165 sizeP = length(P);
4166 
4167 <span class="keyword">if</span> sizeP == 0
4168      out = [];
4169      <span class="keyword">return</span>;
4170 <span class="keyword">end</span>
4171 
4172 a = mod(floor([0 P]/16777216), 64);
4173 na = cumsum( a );
4174 b = mod(floor([0 P]/262144), 64);
4175 nb = cumsum( b );
4176 c = mod(floor([0 P]/4096), 64);
4177 nc = cumsum( c );
4178 d = mod(floor([0 P]/64), 64);
4179 nd = cumsum( d );
4180 e =  mod([0 P], 64);
4181 ne = cumsum( e );
4182 
4183 AA = zeros(1, na(end));
4184 BB = zeros(1, nb(end));
4185 CC = zeros(1, nc(end));
4186 DD = zeros(1, nd(end));
4187 EE = zeros(1, ne(end));
4188 
4189 t1 = na(end)*16777216;
4190 t2 = t1 + nb(end)*262144;
4191 t3 = t2 + nc(end)*4096;
4192 t4 = t3 + nd(end)*64;
4193 
4194 k = (1:sizeP)+offset-1;
4195 <span class="keyword">for</span> ii = 1:sizeP
4196      AA(na(ii)+(0:a(ii+1))+1) = k(ii);
4197      BB(nb(ii)+(0:b(ii+1))+1) = k(ii);
4198      CC(nc(ii)+(0:c(ii+1))+1) = k(ii);
4199      DD(nd(ii)+(0:d(ii+1))+1) = k(ii);
4200      EE(ne(ii)+(0:e(ii+1))+1) = k(ii);
4201 <span class="keyword">end</span>
4202 
4203 <span class="comment">%jj = round(1073741823*rand(sampleSize));</span>
4204 jj = round(min(sum(P),1073741823) *rand(sampleSize));
4205 out = zeros(sampleSize);
4206 N = prod(sampleSize);
4207 <span class="keyword">for</span> ii = 1:N
4208      <span class="keyword">if</span> jj(ii) &lt; t1
4209           out(ii) = AA( floor(jj(ii)/16777216)+1 );
4210      <span class="keyword">elseif</span> jj(ii) &lt; t2
4211           out(ii) = BB(floor((jj(ii)-t1)/262144)+1);
4212      <span class="keyword">elseif</span> jj(ii) &lt; t3
4213           out(ii) = CC(floor((jj(ii)-t2)/4096)+1);
4214      <span class="keyword">elseif</span> jj(ii) &lt; t4
4215           out(ii) = DD(floor((jj(ii)-t3)/64)+1);
4216      <span class="keyword">else</span>
4217           out(ii) = EE(floor(jj(ii)-t4) + 1);
4218      <span class="keyword">end</span>
4219 <span class="keyword">end</span>
4220 
4221 <span class="keyword">return</span>;</pre></div>
<hr><address>Generated on Fri 01-Aug-2008 10:57:33 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>